
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> 
  <head>

<script type="text/javascript" src="/static/js/analytics.js" ></script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>




    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
    <title>
クリップボードへの転送
DouKaku? </title>

    <link rel="stylesheet" type="text/css"
	href="/web/20080820020346cs_/http://ja.doukaku.org/static/style/reset-fonts-grids.css" />
    <link rel="stylesheet" type="text/css"
	href="/web/20080820020346cs_/http://ja.doukaku.org/static/style/style.css?20071211?20071207" />
	
    <link rel="stylesheet" type="text/css"
	href="/web/20080820020346cs_/http://ja.doukaku.org/static/style/pygments.css" />


	
    <!--<script src="/web/20080820020346/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->


<!--<script src="/web/20080820020346/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->
<script src="/web/20080820020346js_/http://ja.doukaku.org/static/js/jquery-1.1.3.1.js" type="text/javascript"></script>
<script src="/web/20080820020346js_/http://ja.doukaku.org/static/js/rating.js" type="text/javascript"></script>
<script src="/web/20080820020346js_/http://ja.doukaku.org/static/js/addtag.js?20071129" type="text/javascript"></script>

<script type="text/javascript">
is_key_navigation_enable = true;
</script>
<script src="/web/20080820020346js_/http://ja.doukaku.org/static/js/utils.js?~~~" type="text/javascript"></script>

</head>


<body id="doukaku_org">
<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script> if (window.archive_analytics) { window.archive_analytics.values['server_name']="wwwb-app15.us.archive.org";}; </script>

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/ja.doukaku.org\/188\/nested\/";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "20";
var displayMonth = "Aug";
var displayYear = "2008";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" lang="en" class="__wb_banner_div" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px">


<div id="wm-ipp-inside" class="__wb_banner_div" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://ja.doukaku.org/188/nested/" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20080820020346" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;width: inherit !important" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Jul
                       
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 2:03:46 Aug 20, 2008">AUG</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Sep
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" />
                       
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 2:03:46 Aug 20, 2008">20</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2007
                       
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 2:03:46 Aug 20, 2008">2008</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2009
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20080820020346*/http://ja.doukaku.org/188/nested/" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>1 captures</strong></a>
           <div class="__wb_banner_div" style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">20 Aug 08 - 20 Aug 08</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div class="__wb_banner_div" id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:7:000000010000_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->


<div id="page_head" class="compact">
  <h1 class="compact">
    <a href="/web/20080820020346/http://ja.doukaku.org/">DouKaku?</a><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/beta.png" alt="beta">
  </h1>
</div>

<div id="page_body" class="compact">
<div id="content" class="compact">




<h2 class="compact">
<img src='/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png' alt=challenge>
<a href="/web/20080820020346/http://ja.doukaku.org/188/">クリップボードへの転送</a>
</h2>

    





<div class="comment" id="comment6644">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/833/" target="_top">mattsan</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6644/">#6644</a>(<script language="JavaScript">print_time(new Date("2008/07/02 19:11 GMT"));</script><noscript>2008/07/02 19:11 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #9fff7f;">6/8=0.75</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  
<p>クリップボード(や同等の機能)へテキストを転送するプログラムをお願いします。
   また可能でしたらクリップボードのデータを取り出すプログラムもお願いします。
</p>
<p>システムに依存する内容ですが、応用範囲が広いと思いましたので出題させてもらいました。
</p>



	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6644/addtag/" class="addtag" id="addtag_6644">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #9fff7f;"
  >6/8=0.75</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6644"
  >-</span><span
  class="button yellow"
  id="rating_z_6644"
  >0</span><span 
  class="button green"
  id="rating_p_6644"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6644/">
  reply
  </a>]
  </div>
</div>
</div>




  



<div class="indent">
<a href="/web/20080820020346/http://ja.doukaku.org/188/post_comment/">
post comment
</a>
</div>


<h2>Posted feedbacks - Nested</h2>
<a href="/web/20080820020346/http://ja.doukaku.org/188/flatten/">Flatten</a> 
<a href="/web/20080820020346/http://ja.doukaku.org/188/">Hidden</a> 


  

  
    





<div class="comment" id="comment6680">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/232/" target="_top">kkobayashi</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6680/">#6680</a>(<script language="JavaScript">print_time(new Date("2008/07/06 10:21 GMT"));</script><noscript>2008/07/06 10:21 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/r/">
	  R
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>Rでは、ファイル名に&quot;clipboard&quot;を指定するとクリップボードへの入出力が可能です。（Windows限定かもしれません）</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4</pre></td><td class="code"><div class="highlight"><pre>&gt; readLines(&quot;clipboard&quot;)
[1] &quot;クリップボード(や同等の機能)へテキストを転送するプログラムをお願いします。 また可能でしたらクリップボードのデータを取り出すプログラムもお願いします。 &quot;
[2] &quot;&quot;
[3] &quot;システムに依存する内容ですが、応用範囲が広いと思いましたので出題させてもらいました。 &quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6680/addtag/" class="addtag" id="addtag_6680">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/r/">
		R
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6680/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6680/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6680"
  >-</span><span
  class="button yellow"
  id="rating_z_6680"
  >0</span><span 
  class="button green"
  id="rating_p_6680"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20080820020346/http://ja.doukaku.org/comment/6680/">
    1
    reply
  </a>

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6680/">
  reply
  </a>]
  </div>
</div>
</div>




  
    <div class="indent compact" style="position: relative;">
      <img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/1x1dark_green.png" width=10 style="position: absolute;top:-10px;margin-left:8px;">
      





<div class="comment" id="comment6699">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/654/" target="_top">ika</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/">#6699</a>(<script language="JavaScript">print_time(new Date("2008/07/07 12:52 GMT"));</script><noscript>2008/07/07 12:52 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/d/">
	  D
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>生憎、今のところそのような便利ライブラリはなさそうなので生のWin32APIを使わざるを得ません。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72</pre></td><td class="code"><div class="highlight"><pre><span class="k">module</span> <span class="n">win32</span>.<span class="n">clipboard</span>;
<span class="k">private</span> <span class="k">import</span> <span class="n">std</span>.<span class="n">c</span>.<span class="n">windows</span>.<span class="n">windows</span>;
<span class="k">private</span> <span class="k">import</span> <span class="n">std</span>.<span class="n">contracts</span>, <span class="n">std</span>.<span class="n">conv</span>;

<span class="k">export</span> <span class="k">extern</span>(<span class="n">Windows</span>) {
    <span class="n">HGLOBAL</span> <span class="n">GlobalAlloc</span>(<span class="n">UINT</span> <span class="n">uFlags</span>, <span class="n">DWORD</span> <span class="n">dwBytes</span>);
    <span class="n">HGLOBAL</span> <span class="n">GlobalFree</span>(<span class="n">HGLOBAL</span> <span class="n">hMem</span>);
    <span class="n">LPVOID</span> <span class="n">GlobalLock</span>(<span class="n">HGLOBAL</span> <span class="n">hMem</span>);
    <span class="n">BOOL</span> <span class="n">GlobalUnlock</span>(<span class="n">HGLOBAL</span> <span class="n">hMem</span>);
    <span class="k">enum</span> <span class="n">UINT</span> <span class="n">GMEM_MOVEABLE</span> = <span class="mi">2</span>;
    
    <span class="n">BOOL</span> <span class="n">CloseClipboard</span>();
    <span class="n">BOOL</span> <span class="n">EmptyClipboard</span>();
    <span class="n">UINT</span> <span class="n">EnumClipboardFormats</span>(<span class="n">UINT</span> <span class="n">format</span>);
    <span class="n">HANDLE</span> <span class="n">GetClipboardData</span>(<span class="n">UINT</span> <span class="n">uFormat</span>);
    <span class="n">BOOL</span> <span class="n">OpenClipboard</span>(<span class="n">HWND</span> <span class="n">hWndNewOwner</span>);
    <span class="n">HANDLE</span> <span class="n">SetClipboardData</span>(<span class="n">UINT</span> <span class="n">uFormat</span>, <span class="n">HANDLE</span> <span class="n">hMem</span>);
    
    <span class="k">enum</span> <span class="n">UINT</span> <span class="n">CF_UNICODETEXT</span> = <span class="mi">13</span>;
}

<span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="n">Clipboard</span> {    
    <span class="k">static</span> <span class="kt">void</span> <span class="n">setText</span>(<span class="n">string</span> <span class="n">text</span>) {
        <span class="n">enforce</span>(<span class="n">OpenClipboard</span>(<span class="kc">null</span>));
        <span class="k">scope</span>(<span class="n">exit</span>) <span class="n">CloseClipboard</span>();
        
        <span class="k">auto</span> <span class="n">wtext</span> = <span class="n">to</span>!(<span class="n">wstring</span>)(<span class="n">text</span>);
        <span class="k">auto</span> <span class="n">data</span> = <span class="n">enforce</span>(<span class="n">GlobalAlloc</span>(<span class="n">GMEM_MOVEABLE</span>, <span class="kt">wchar</span>.<span class="n">sizeof</span> * (<span class="n">wtext</span>.<span class="n">length</span> + <span class="mi">1</span>)));
        <span class="k">scope</span>(<span class="n">failure</span>) <span class="n">GlobalFree</span>(<span class="n">data</span>);
        
        {
            <span class="k">auto</span> <span class="n">pdata</span> = <span class="k">cast</span>(<span class="kt">wchar</span>*)<span class="n">GlobalLock</span>(<span class="n">data</span>);
            <span class="k">scope</span>(<span class="n">exit</span>) <span class="n">GlobalUnlock</span>(<span class="n">data</span>);
            
            <span class="n">pdata</span>[<span class="mf">0.</span>.<span class="n">wtext</span>.<span class="n">length</span>] = <span class="n">wtext</span>;
            <span class="n">pdata</span>[<span class="n">wtext</span>.<span class="n">length</span>] = <span class="sc">&#39;\0&#39;</span>;
        }
        
        <span class="n">enforce</span>(<span class="n">EmptyClipboard</span>());
        <span class="n">enforce</span>(<span class="n">SetClipboardData</span>(<span class="n">CF_UNICODETEXT</span>, <span class="n">data</span>));
    }
    
    <span class="k">static</span> <span class="n">string</span> <span class="n">getText</span>() {
        <span class="n">enforce</span>(<span class="n">OpenClipboard</span>(<span class="kc">null</span>));
        <span class="k">scope</span>(<span class="n">exit</span>) <span class="n">CloseClipboard</span>();
        
        <span class="k">auto</span> <span class="n">data</span> = <span class="n">GetClipboardData</span>(<span class="n">CF_UNICODETEXT</span>);
        <span class="k">if</span>(!<span class="n">data</span>) <span class="k">return</span> <span class="kc">null</span>;
        
        <span class="k">auto</span> <span class="n">pdata</span> = <span class="k">cast</span>(<span class="k">const</span>(<span class="kt">wchar</span>)*)<span class="n">GlobalLock</span>(<span class="n">data</span>);
        <span class="k">auto</span> <span class="n">wtext</span> = <span class="n">pdata</span>[<span class="mf">0.</span>.<span class="n">strlen</span>(<span class="n">pdata</span>)];
        <span class="n">GlobalUnlock</span>(<span class="n">data</span>);
        
        <span class="k">return</span> <span class="n">to</span>!(<span class="n">string</span>)(<span class="n">wtext</span>);
    }
}

<span class="k">private</span> <span class="kt">uint</span> <span class="n">strlen</span>(<span class="k">const</span>(<span class="kt">wchar</span>)* <span class="n">s</span>) {
    <span class="kt">uint</span> <span class="n">len</span>;
    <span class="k">while</span>(*<span class="n">s</span>++) <span class="n">len</span>++;
    <span class="k">return</span> <span class="n">len</span>;
}

<span class="k">debug</span>(<span class="n">Clipboard</span>) {
<span class="k">import</span> <span class="n">std</span>.<span class="n">stdio</span>;

<span class="kt">void</span> <span class="n">main</span>() {
    <span class="n">Clipboard</span>.<span class="n">setText</span>(<span class="s">&quot;test テスト&quot;</span>);
    <span class="n">writeln</span>(<span class="n">Clipboard</span>.<span class="n">getText</span>);
}

}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/addtag/" class="addtag" id="addtag_6699">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/Windows/">Windows</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/d/">
		D
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6699"
  >-</span><span
  class="button yellow"
  id="rating_z_6699"
  >0</span><span 
  class="button green"
  id="rating_p_6699"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/6680/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/root/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/">
    1
    reply
  </a>

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6699/">
  reply
  </a>]
  </div>
</div>
</div>




  
    <div class="indent compact" style="position: relative;">
      <img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/1x1dark_green.png" width=10 style="position: absolute;top:-10px;margin-left:8px;">
      





<div class="comment" id="comment6700">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/654/" target="_top">ika</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6700/">#6700</a>(<script language="JavaScript">print_time(new Date("2008/07/07 12:55 GMT"));</script><noscript>2008/07/07 12:55 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>すみません。
不注意で関係のないところへぶら下げてしまいました。</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6700/addtag/" class="addtag" id="addtag_6700">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6700"
  >-</span><span
  class="button yellow"
  id="rating_z_6700"
  >0</span><span 
  class="button green"
  id="rating_p_6700"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/6699/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/6700/root/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6700/">
  reply
  </a>]
  </div>
</div>
</div>




  


    </div>
  


    </div>
  


  

  
    





<div class="comment" id="comment6681">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/177/" target="_top">ocean</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6681/">#6681</a>(<script language="JavaScript">print_time(new Date("2008/07/06 11:35 GMT"));</script><noscript>2008/07/06 11:35 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  私が使ってるライブラリそのものですが。私はこのコードを&nbsp;ocean/clipboard.py&nbsp;として保存してるので、<br/><br/>import&nbsp;ocean.clipboard&nbsp;as&nbsp;c<br/>c.get()&nbsp;#&nbsp;クリップボードの中身を取得<br/>c.set("hoge")&nbsp;#&nbsp;クリップボードに設定<br/>c.clear()&nbsp;#&nbsp;クリップボードを空にする<br/><br/>として使います。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">with_statement</span>
<span class="k">from</span> <span class="nn">contextlib</span> <span class="k">import</span> <span class="n">contextmanager</span>
<span class="k">import</span> <span class="nn">ctypes</span>

<span class="n">GMEM_DDESHARE</span> <span class="o">=</span> <span class="mh">0x2000</span>
<span class="n">GMEM_MOVEABLE</span> <span class="o">=</span> <span class="mh">0x0002</span>
<span class="n">CF_TEXT</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">user32</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span>
<span class="n">kernel32</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span>

<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">_GlobalLock</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">GlobalLock</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WindowsError</span><span class="p">(</span><span class="s">&quot;GlobalLock() failed&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">kernel32</span><span class="o">.</span><span class="n">GlobalUnlock</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">_Clipboard</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user32</span><span class="o">.</span><span class="n">OpenClipboard</span><span class="p">(</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">WindowsError</span><span class="p">(</span><span class="s">&quot;OpenClipboard() failed&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">user32</span><span class="o">.</span><span class="n">CloseClipboard</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;mbcs&quot;</span><span class="p">)</span>
    <span class="c"># memory block</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">GlobalAlloc</span><span class="p">(</span><span class="n">GMEM_DDESHARE</span> <span class="o">|</span> <span class="n">GMEM_MOVEABLE</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WindowsError</span><span class="p">(</span><span class="s">&quot;GlobalAlloc() failed&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">_GlobalLock</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_char</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">from_address</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\0</span><span class="s">&quot;</span><span class="p">):</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="c"># clipboard</span>
        <span class="k">with</span> <span class="n">_Clipboard</span><span class="p">():</span>
            <span class="n">user32</span><span class="o">.</span><span class="n">EmptyClipboard</span><span class="p">()</span>
            <span class="n">user32</span><span class="o">.</span><span class="n">SetClipboardData</span><span class="p">(</span><span class="n">CF_TEXT</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">kernel32</span><span class="o">.</span><span class="n">GlobalFree</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">get</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">_Clipboard</span><span class="p">():</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">user32</span><span class="o">.</span><span class="n">GetClipboardData</span><span class="p">(</span><span class="n">CF_TEXT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">h</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">_GlobalLock</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;mbcs&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">clear</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">_Clipboard</span><span class="p">():</span>
        <span class="n">user32</span><span class="o">.</span><span class="n">EmptyClipboard</span><span class="p">()</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6681/addtag/" class="addtag" id="addtag_6681">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/Python2.5/">Python2.5</a>
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/Windows/">Windows</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6681/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6681/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6681"
  >-</span><span
  class="button yellow"
  id="rating_z_6681"
  >0</span><span 
  class="button green"
  id="rating_p_6681"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20080820020346/http://ja.doukaku.org/comment/6681/">
    1
    reply
  </a>

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6681/">
  reply
  </a>]
  </div>
</div>
</div>




  
    <div class="indent compact" style="position: relative;">
      <img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/1x1dark_green.png" width=10 style="position: absolute;top:-10px;margin-left:8px;">
      





<div class="comment" id="comment6683">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/177/" target="_top">ocean</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6683/">#6683</a>(<script language="JavaScript">print_time(new Date("2008/07/06 12:55 GMT"));</script><noscript>2008/07/06 12:55 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/diff/">
	  diff
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>ちょっと簡略化。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td class="code"><div class="highlight"><pre><span class="gd">--- clipboard.py    Mon Feb 11 19:47:02 2008</span>
<span class="gi">+++ clipboard.py    Mon Jul  7 02:51:50 2008</span>
<span class="gu">@@ -37,9 +37,7 @@</span>
         raise WindowsError(&quot;GlobalAlloc() failed&quot;)
     try:
         with _GlobalLock(h) as p:
<span class="gd">-            p = (ctypes.c_char * (len(s) + 1)).from_address(p)</span>
<span class="gd">-            for i, c in enumerate(s + &quot;\0&quot;):</span>
<span class="gd">-                p[i] = c</span>
<span class="gi">+            (ctypes.c_char * (len(s) + 1)).from_address(p).value = s</span>
         # clipboard
         with _Clipboard():
             user32.EmptyClipboard()
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6683/addtag/" class="addtag" id="addtag_6683">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/diff/">
		diff
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6683/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6683/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6683"
  >-</span><span
  class="button yellow"
  id="rating_z_6683"
  >0</span><span 
  class="button green"
  id="rating_p_6683"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/6681/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/6683/root/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6683/">
  reply
  </a>]
  </div>
</div>
</div>




  


    </div>
  


  

  
    





<div class="comment" id="comment6682">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/760/" target="_top">turugina</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6682/">#6682</a>(<script language="JavaScript">print_time(new Date("2008/07/06 11:46 GMT"));</script><noscript>2008/07/06 11:46 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/perl/">
	  Perl
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  そのものずばりのCPANモジュール Clipboardを使って。
	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://search.cpan.org/~king/Clipboard-0.09/lib/Clipboard.pm">Clipboard</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">Clipboard</span><span class="p">;</span>
<span class="c1"># クリップボードに転送</span>
<span class="n">Clipboard</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">);</span>
<span class="c1"># クリップボードから取り出し</span>
<span class="k">print</span> <span class="n">Clipboard</span><span class="o">-&gt;</span><span class="n">paste</span><span class="p">;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6682/addtag/" class="addtag" id="addtag_6682">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/CPAN/">CPAN</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/perl/">
		Perl
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6682/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6682/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6682"
  >-</span><span
  class="button yellow"
  id="rating_z_6682"
  >0</span><span 
  class="button green"
  id="rating_p_6682"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6682/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  

  
    





<div class="comment" id="comment6684">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/607/" target="_top">しらたま</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6684/">#6684</a>(<script language="JavaScript">print_time(new Date("2008/07/06 13:15 GMT"));</script><noscript>2008/07/06 13:15 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/nadesico/">
	  なでしこ
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <div class="section">
<p>なでしこでは、変数「クリップボード」でクリップボードの読み書きが出来ます。</p>
<p>また、命令としても、クリップボードからの取り出しには「クリップボード取得」、転送には「コピー」が使用できます。</p>
</div>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5</pre></td><td class="code"><div class="highlight"><pre>クリップボードは「変数経由」
クリップボード取得して表示

「命令経由」をコピー
クリップボードを表示
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6684/addtag/" class="addtag" id="addtag_6684">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/nadesico/">
		なでしこ
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6684/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6684/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6684"
  >-</span><span
  class="button yellow"
  id="rating_z_6684"
  >0</span><span 
  class="button green"
  id="rating_p_6684"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6684/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6685">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/766/" target="_top">syat</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6685/">#6685</a>(<script language="JavaScript">print_time(new Date("2008/07/06 17:00 GMT"));</script><noscript>2008/07/06 17:00 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  サクラエディタはJScriptやVBScriptで書いたマクロを使えるんだぜ、というアピール。<br/>"hoge.js"&nbsp;などの名前で保存し、「ツール」の「キーマクロの読み込み」でキーマクロに設定したのち、Ctrl&nbsp;+&nbsp;Shift&nbsp;+&nbsp;L&nbsp;で実行します。
	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://www.geocities.jp/maru3128/SakuraMacro/">サクラエディタマクロ</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre>Editor.SelectAll();
Editor.Copy();
for (var i=0; i&lt;3; i++) {
  Editor.GoFileEnd();
  Editor.Paste();
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6685/addtag/" class="addtag" id="addtag_6685">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/%E3%82%B5%E3%82%AF%E3%83%A9%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E3%83%9E%E3%82%AF%E3%83%AD/">サクラエディタマクロ</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6685/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6685/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6685"
  >-</span><span
  class="button yellow"
  id="rating_z_6685"
  >0</span><span 
  class="button green"
  id="rating_p_6685"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6685/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6686">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/170/" target="_top">anekos</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6686/">#6686</a>(<script language="JavaScript">print_time(new Date("2008/07/06 18:11 GMT"));</script><noscript>2008/07/06 18:11 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>標準入力或いは、指定のファイルからクリップボードに転送します。
'-show' をつけるとクリップボードのテキストを表示</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;win32/clipboard&#39;</span>
<span class="kp">include</span> <span class="no">Win32</span>

<span class="k">if</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="s1">&#39;-show&#39;</span><span class="p">)</span>
  <span class="nb">print</span> <span class="no">Clipboard</span><span class="o">.</span><span class="n">get_data</span>
<span class="k">else</span>
  <span class="no">Clipboard</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="no">ARGF</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6686/addtag/" class="addtag" id="addtag_6686">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/Windows/">Windows</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6686/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6686/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6686"
  >-</span><span
  class="button yellow"
  id="rating_z_6686"
  >0</span><span 
  class="button green"
  id="rating_p_6686"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6686/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6687">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/170/" target="_top">anekos</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6687/">#6687</a>(<script language="JavaScript">print_time(new Date("2008/07/06 18:30 GMT"));</script><noscript>2008/07/06 18:30 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/javascript/">
	  JavaScript
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>&quot;hogehoge&quot; をクリップボードに転送。
Firefox3で確認。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></td><td class="code"><div class="highlight"><pre><span class="k">function</span> <span class="nx">copyToClipboard</span> <span class="p">(</span><span class="nx">copytext</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">const</span> <span class="nx">supstr</span> <span class="o">=</span> <span class="nx">Components</span><span class="p">.</span><span class="nx">classes</span><span class="p">[</span><span class="s2">&quot;@mozilla.org/supports-string;1&quot;</span><span class="p">].</span>
                   <span class="nx">createInstance</span><span class="p">(</span><span class="nx">Components</span><span class="p">.</span><span class="nx">interfaces</span><span class="p">.</span><span class="nx">nsISupportsString</span><span class="p">);</span>
  <span class="k">const</span> <span class="nx">transferable</span> <span class="o">=</span> <span class="nx">Components</span><span class="p">.</span><span class="nx">classes</span><span class="p">[</span><span class="s2">&quot;@mozilla.org/widget/transferable;1&quot;</span><span class="p">].</span>
                  <span class="nx">createInstance</span><span class="p">(</span><span class="nx">Components</span><span class="p">.</span><span class="nx">interfaces</span><span class="p">.</span><span class="nx">nsITransferable</span><span class="p">);</span>
  <span class="k">const</span> <span class="nx">iClipboard</span> <span class="o">=</span> <span class="nx">Components</span><span class="p">.</span><span class="nx">interfaces</span><span class="p">.</span><span class="nx">nsIClipboard</span><span class="o">;</span>
  <span class="k">const</span> <span class="nx">clipboard</span> <span class="o">=</span> <span class="nx">Components</span><span class="p">.</span><span class="nx">classes</span><span class="p">[</span><span class="s2">&quot;@mozilla.org/widget/clipboard;1&quot;</span><span class="p">].</span><span class="nx">getService</span><span class="p">(</span><span class="nx">iClipboard</span><span class="p">);</span>

  <span class="nx">supstr</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">copytext</span><span class="o">;</span>

  <span class="nx">transferable</span><span class="p">.</span><span class="nx">addDataFlavor</span><span class="p">(</span><span class="s2">&quot;text/unicode&quot;</span><span class="p">);</span>
  <span class="nx">transferable</span><span class="p">.</span><span class="nx">setTransferData</span><span class="p">(</span><span class="s2">&quot;text/unicode&quot;</span><span class="o">,</span> <span class="nx">supstr</span><span class="o">,</span> <span class="nx">copytext</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">clipboard</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="nx">transferable</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="nx">iClipboard</span><span class="p">.</span><span class="nx">kGlobalClipboard</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">copyToClipboard</span><span class="p">(</span><span class="s1">&#39;hogehoge&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6687/addtag/" class="addtag" id="addtag_6687">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/XPCOM/">XPCOM</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/javascript/">
		JavaScript
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6687/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6687/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6687"
  >-</span><span
  class="button yellow"
  id="rating_z_6687"
  >0</span><span 
  class="button green"
  id="rating_p_6687"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6687/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6688">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/570/" target="_top">horiuchi</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6688/">#6688</a>(<script language="JavaScript">print_time(new Date("2008/07/06 19:57 GMT"));</script><noscript>2008/07/06 19:57 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/java/">
	  Java
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>とりあえず、文字列の場合は以下の通り。
その他、画像やJavaのシリアライズしたオブジェクトなど、さまざまなデータを送れます。</p>

	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://java.sun.com/javase/ja/6/docs/ja/api/java/awt/datatransfer/DataFlavor.html">クリップボード経由でやりとりできる型の詳細</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">java.awt.Toolkit</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.awt.datatransfer.Clipboard</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.awt.datatransfer.DataFlavor</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.awt.datatransfer.StringSelection</span><span class="o">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Sample188</span> <span class="o">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Clipboard</span> <span class="n">clipboard</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">getDefaultToolkit</span><span class="o">().</span><span class="na">getSystemClipboard</span><span class="o">();</span>

        <span class="c">// クリップボードにデータを設定</span>
        <span class="n">StringSelection</span> <span class="n">setData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringSelection</span><span class="o">(</span><span class="s">&quot;クリップボードにコピーされる。&quot;</span><span class="o">);</span>
        <span class="n">clipboard</span><span class="o">.</span><span class="na">setContents</span><span class="o">(</span><span class="n">setData</span><span class="o">,</span> <span class="n">setData</span><span class="o">);</span>

        <span class="c">// クリップボードからデータを取得</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">clipboard</span><span class="o">.</span><span class="na">getData</span><span class="o">(</span><span class="n">DataFlavor</span><span class="o">.</span><span class="na">stringFlavor</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6688/addtag/" class="addtag" id="addtag_6688">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/Java1.5/">Java1.5</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/java/">
		Java
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6688/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6688/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6688"
  >-</span><span
  class="button yellow"
  id="rating_z_6688"
  >0</span><span 
  class="button green"
  id="rating_p_6688"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6688/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6690">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/88/" target="_top">sumim</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6690/">#6690</a>(<script language="JavaScript">print_time(new Date("2008/07/06 21:45 GMT"));</script><noscript>2008/07/06 21:45 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/smalltalk/">
	  Smalltalk
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>Squeak Smalltalk で。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2</pre></td><td class="code"><div class="highlight"><pre>Clipboard clipboardText: &#39;クリップボードへ&#39;.
Clipboard clipboardText  &quot;クリップボードから&quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6690/addtag/" class="addtag" id="addtag_6690">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/Squeak_Smalltalk/">Squeak_Smalltalk</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/smalltalk/">
		Smalltalk
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6690/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6690/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6690"
  >-</span><span
  class="button yellow"
  id="rating_z_6690"
  >0</span><span 
  class="button green"
  id="rating_p_6690"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6690/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6692">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/793/" target="_top">genzou</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6692/">#6692</a>(<script language="JavaScript">print_time(new Date("2008/07/06 22:49 GMT"));</script><noscript>2008/07/06 22:49 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/groovy/">
	  Groovy
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <pre class='compact'>クラス化してみました。

【使い方】
clip = new ClipBoard()
// 中身を表示
println clip.text
// セット
clip.text = "新しい内容"</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></td><td class="code"><div class="highlight"><pre>import java.awt.Toolkit
import java.awt.datatransfer.Clipboard
import java.awt.datatransfer.DataFlavor
import java.awt.datatransfer.StringSelection
import java.awt.datatransfer.Transferable

public class ClipBoard {
    def clipboard = Toolkit.getDefaultToolkit().getSystemClipboard()
    
    public void setText(sendStr) {

        def ss = new StringSelection(sendStr)
        clipboard.setContents(ss, ss)
    }

    public getText() {

        Transferable recive = clipboard.getContents(null)

        def recieveStr = null

        try {
            recieveStr = (String) recive.getTransferData(DataFlavor.stringFlavor)
        } catch (Exception e) {
            recieveStr = &quot;&quot;
        }
        return recieveStr
    }
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6692/addtag/" class="addtag" id="addtag_6692">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/groovy/">groovy</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/groovy/">
		Groovy
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6692/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6692/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6692"
  >-</span><span
  class="button yellow"
  id="rating_z_6692"
  >0</span><span 
  class="button green"
  id="rating_p_6692"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6692/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6694">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/827/" target="_top">baal</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_bronze.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6694/">#6694</a>(<script language="JavaScript">print_time(new Date("2008/07/06 23:56 GMT"));</script><noscript>2008/07/06 23:56 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <pre class='compact'>MIT/GNU Scheme で書きました。
残念ながら Scheme 処理系に共通したクリップボード読み書きの方法はありません。
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4</pre></td><td class="code"><div class="highlight"><pre><span class="c1">;; クリップボードへ書き込み (※ str は文字列)</span>
<span class="p">(</span><span class="nf">win32-clipboard-write-text</span> <span class="nv">str</span><span class="p">)</span>
<span class="c1">;; クリップボードから読み込み</span>
<span class="p">(</span><span class="nf">win32-clipboard-read-text</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6694/addtag/" class="addtag" id="addtag_6694">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/MIT/GNU-Scheme/">MIT/GNU-Scheme</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6694/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6694/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6694"
  >-</span><span
  class="button yellow"
  id="rating_z_6694"
  >0</span><span 
  class="button green"
  id="rating_p_6694"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6694/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6695">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/405/" target="_top">mc</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6695/">#6695</a>(<script language="JavaScript">print_time(new Date("2008/07/07 06:28 GMT"));</script><noscript>2008/07/07 06:28 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/commonlisp/">
	  Common Lisp
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  X&nbsp;window上でMacOSXのpbpaste/pbcopyのような動作を実現できるxclipを使ってみました。<br/>今回の例では、中ボタンでのペーストではなくCTR+V系にしました。<br/>コマンド呼び出しのライブラリには、KMRCLを利用しています。<br/>ちなみに、日本語の文字化け問題には対応していません…。<br/><br/>動作:<br/>(pbcopy&nbsp;"foo")<br/>;&nbsp;クリップボードへ<br/><br/>(pbpaste)&nbsp;<br/>;=&gt;&nbsp;foo
	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://kyanny.nowa.jp/entry/6097dc5aa7">xclip を使って pbcopy/pbpaste っぽいコマンドを再現する</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8
9</pre></td><td class="code"><div class="highlight"><pre>(defun pbcopy (string)
  (declare (string string))
  (kmrcl:run-shell-command
   &quot;echo ~A|xclip -selection clipboard&quot; string))

(defun pbpaste ()
  (values
   (kmrcl:command-output
    &quot;~A&quot; &quot;xclip -selection clipboard -o&quot;)))
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6695/addtag/" class="addtag" id="addtag_6695">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/kmrcl/">kmrcl</a>
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/unix/">unix</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/commonlisp/">
		Common Lisp
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6695/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6695/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6695"
  >-</span><span
  class="button yellow"
  id="rating_z_6695"
  >0</span><span 
  class="button green"
  id="rating_p_6695"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6695/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6696">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/479/" target="_top">tsuwabuki</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6696/">#6696</a>(<script language="JavaScript">print_time(new Date("2008/07/07 11:03 GMT"));</script><noscript>2008/07/07 11:03 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>Windows用です。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></td><td class="code"><div class="highlight"><pre><span class="kr">import</span> <span class="n">Graphics</span><span class="o">.</span><span class="n">Win32</span><span class="o">.</span><span class="n">GDI</span><span class="o">.</span><span class="n">Clip</span>
<span class="kr">import</span> <span class="n">Foreign</span><span class="o">.</span><span class="n">Ptr</span>
<span class="kr">import</span> <span class="n">Foreign</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">String</span>

<span class="nv">main</span> <span class="o">=</span> <span class="kr">do</span> <span class="p">{</span> <span class="nv">openClipboard</span> <span class="nv">nullPtr</span>
          <span class="p">;</span> <span class="nv">b</span> <span class="o">&lt;-</span> <span class="nv">isClipboardFormatAvailable</span> <span class="nv">cF_TEXT</span>
          <span class="p">;</span> <span class="kr">if</span> <span class="nv">b</span>
            <span class="kr">then</span> <span class="kr">do</span> <span class="p">{</span> <span class="nv">p</span> <span class="o">&lt;-</span> <span class="nv">getClipboardData</span> <span class="nv">cF_TEXT</span>
                    <span class="p">;</span> <span class="nv">s</span> <span class="o">&lt;-</span> <span class="nv">peekCString</span> <span class="p">(</span><span class="nv">castPtr</span> <span class="nv">p</span><span class="p">)</span>
                    <span class="p">;</span> <span class="nv">putStrLn</span> <span class="nv">s</span>
                    <span class="p">}</span>
            <span class="kr">else</span> <span class="nv">return</span> <span class="p">()</span>
          <span class="p">;</span> <span class="nv">closeClipboard</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6696/addtag/" class="addtag" id="addtag_6696">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6696/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6696/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6696"
  >-</span><span
  class="button yellow"
  id="rating_z_6696"
  >0</span><span 
  class="button green"
  id="rating_p_6696"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6696/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  

  

  
    





<div class="comment" id="comment6701">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/504/" target="_top">あにす</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6701/">#6701</a>(<script language="JavaScript">print_time(new Date("2008/07/07 18:46 GMT"));</script><noscript>2008/07/07 18:46 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/csharp/">
	  C#
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></td><td class="code"><div class="highlight"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span> <span class="k">{</span>
<span class="na">    [STAThread]</span><span class="c">//クリップボードを利用する場合に必須の属性です。</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="k">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&quot;クリップボードのセットする文字列を入力して下さい。:&quot;</span><span class="p">);</span>
        <span class="kt">string</span> <span class="n">setStr</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">();</span><span class="c">//セットする文字列を入力</span>

        <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Clipboard</span><span class="p">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">setStr</span><span class="p">);</span><span class="c">//クリップボードにセット</span>

        <span class="kt">string</span> <span class="n">getStr</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Clipboard</span><span class="p">.</span><span class="n">GetText</span><span class="p">();</span><span class="c">//クリップボードから文字列を取得</span>

        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;クリップボードの内容は\n\n{0}\n\nです。&quot;</span><span class="p">,</span> <span class="n">getStr</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">();</span>
    <span class="k">}</span>
<span class="k">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6701/addtag/" class="addtag" id="addtag_6701">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/csharp/">
		C#
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6701/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6701/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6701"
  >-</span><span
  class="button yellow"
  id="rating_z_6701"
  >0</span><span 
  class="button green"
  id="rating_p_6701"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6701/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6705">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/497/" target="_top">Otter</a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6705/">#6705</a>(<script language="JavaScript">print_time(new Date("2008/07/08 01:57 GMT"));</script><noscript>2008/07/08 01:57 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>こちらは、クリップボードへテキストを乗っけるコードです…標準入力とファイルに対応しています…</p>
<p>System.Win32.Mem.globalUnlockってエラーハンドリングにバグがあるようなのでc_GlobalUnlockを使っています…</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></td><td class="code"><div class="highlight"><pre><span class="kr">module</span> <span class="n">Main</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="n">Control</span><span class="o">.</span><span class="n">Monad</span>
<span class="kr">import</span> <span class="n">Foreign</span><span class="o">.</span><span class="n">Ptr</span>
<span class="kr">import</span> <span class="n">Foreign</span><span class="o">.</span><span class="n">Storable</span>
<span class="kr">import</span> <span class="n">Graphics</span><span class="o">.</span><span class="n">Win32</span><span class="o">.</span><span class="n">GDI</span><span class="o">.</span><span class="n">Types</span>
<span class="kr">import</span> <span class="n">Graphics</span><span class="o">.</span><span class="n">Win32</span><span class="o">.</span><span class="n">GDI</span><span class="o">.</span><span class="n">Clip</span>
<span class="kr">import</span> <span class="n">Data</span><span class="o">.</span><span class="n">Word</span>
<span class="kr">import</span> <span class="n">System</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">IO</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Win32</span><span class="o">.</span><span class="n">Types</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Win32</span><span class="o">.</span><span class="n">Mem</span>

<span class="nv">when_</span> <span class="nv">f</span> <span class="nv">m</span> <span class="o">=</span> <span class="nv">when</span> <span class="nv">f</span> <span class="p">(</span><span class="nv">m</span> <span class="o">&gt;&gt;</span> <span class="nv">return</span> <span class="p">())</span>

<span class="nv">withGlobalAlloc</span> <span class="o">::</span> <span class="n">GlobalAllocFlags</span> <span class="o">-&gt;</span> <span class="n">DWORD</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">HGLOBAL</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="p">(</span><span class="n">HGLOBAL</span><span class="p">,</span> <span class="nv">a</span><span class="p">)</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="nv">a</span>
<span class="nv">withGlobalAlloc</span> <span class="nv">fl</span> <span class="nv">cb</span> <span class="nv">f</span> <span class="o">=</span> <span class="kr">do</span>
    <span class="nv">h</span> <span class="o">&lt;-</span> <span class="nv">globalAlloc</span> <span class="nv">fl</span> <span class="nv">cb</span>
    <span class="p">(</span><span class="nv">h&#39;</span><span class="p">,</span> <span class="nv">ret</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nv">f</span> <span class="nv">h</span>
    <span class="nv">when_</span> <span class="p">(</span><span class="nv">h&#39;</span> <span class="o">/=</span> <span class="nv">nullHANDLE</span><span class="p">)</span> <span class="o">$</span> <span class="nv">globalFree</span> <span class="nv">h</span>
    <span class="nv">return</span> <span class="nv">ret</span>
    
<span class="nv">withGlobalLock</span> <span class="o">::</span> <span class="n">HGLOBAL</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">Addr</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="nv">a</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="nv">a</span>
<span class="nv">withGlobalLock</span> <span class="nv">h</span> <span class="nv">f</span> <span class="o">=</span> <span class="kr">do</span>
    <span class="nv">addr</span> <span class="o">&lt;-</span> <span class="nv">globalLock</span> <span class="nv">h</span>
    <span class="nv">ret</span> <span class="o">&lt;-</span> <span class="nv">f</span> <span class="nv">addr</span>
    <span class="nv">c_GlobalUnlock</span> <span class="nv">h</span>
    <span class="nv">return</span> <span class="nv">ret</span>
    
<span class="nv">withClipboard</span> <span class="o">::</span> <span class="n">HWND</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">IO</span> <span class="nv">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="nv">b</span>
<span class="nv">withClipboard</span> <span class="nv">hwnd</span> <span class="nv">fn</span> <span class="o">=</span> <span class="kr">do</span>
    <span class="nv">openClipboard</span> <span class="nv">hwnd</span>
    <span class="nv">ret</span> <span class="o">&lt;-</span> <span class="nv">fn</span>
    <span class="nv">closeClipboard</span>
    <span class="nv">return</span> <span class="nv">ret</span>
    
<span class="nv">publishToClipboard</span> <span class="o">::</span> <span class="n">HGLOBAL</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="p">(</span><span class="n">HGLOBAL</span><span class="p">,</span> <span class="p">())</span>
<span class="nv">publishToClipboard</span> <span class="nv">h</span> <span class="o">=</span> <span class="nv">withClipboard</span> <span class="nv">nullHANDLE</span> <span class="p">(</span><span class="nv">setData</span> <span class="nv">h</span><span class="p">)</span>
    <span class="kr">where</span>
        <span class="nv">setData</span> <span class="nv">h</span> <span class="o">=</span> <span class="kr">do</span>
            <span class="nv">h&#39;</span> <span class="o">&lt;-</span> <span class="nv">catch</span> <span class="p">(</span><span class="nv">c_SetClipboardData</span> <span class="nv">cF_TEXT</span> <span class="nv">h</span><span class="p">)</span> <span class="p">(</span><span class="o">\</span><span class="kr">_</span> <span class="o">-&gt;</span> <span class="nv">return</span> <span class="nv">nullHANDLE</span><span class="p">)</span>
            <span class="nv">return</span> <span class="p">(</span><span class="kr">if</span> <span class="nv">h&#39;</span> <span class="o">==</span> <span class="nv">nullHANDLE</span> <span class="kr">then</span> <span class="nv">h</span> <span class="kr">else</span> <span class="nv">nullHANDLE</span><span class="p">,</span> <span class="p">())</span>
            
<span class="nv">copyStr</span> <span class="o">::</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">Addr</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">copyStr</span> <span class="nv">str</span> <span class="nv">pv</span> <span class="o">=</span> <span class="nv">zipWithM_</span> <span class="p">(</span><span class="nv">pokeByteOff</span> <span class="nv">pch</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">]</span> <span class="o">$</span> <span class="nv">str</span>
    <span class="kr">where</span>
        <span class="nv">pch</span> <span class="o">=</span> <span class="nv">castPtr</span> <span class="nv">pv</span> <span class="o">::</span> <span class="n">Ptr</span> <span class="n">Word8</span>

<span class="nv">setTextToClipboard</span> <span class="nv">str</span> <span class="o">=</span>  <span class="nv">withGlobalAlloc</span> <span class="nv">gMEM_MOVEABLE</span> <span class="p">(</span><span class="nv">fromIntegral</span> <span class="o">$</span> <span class="nv">length</span> <span class="nv">str</span><span class="p">)</span> <span class="o">$</span> <span class="nv">_setTextToClipboard</span> <span class="nv">str</span>
    <span class="kr">where</span>
        <span class="nv">_setTextToClipboard</span> <span class="o">::</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">HGLOBAL</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="p">(</span><span class="n">HGLOBAL</span><span class="p">,</span> <span class="p">())</span>
        <span class="nv">_setTextToClipboard</span> <span class="nv">str</span> <span class="nv">h</span> <span class="o">=</span> <span class="kr">do</span>
            <span class="nv">withGlobalLock</span> <span class="nv">h</span> <span class="p">(</span><span class="nv">copyStr</span> <span class="nv">str</span><span class="p">)</span>
            <span class="nv">publishToClipboard</span> <span class="nv">h</span>

<span class="nv">main</span> <span class="o">=</span> <span class="kr">do</span>
    <span class="nv">args</span> <span class="o">&lt;-</span> <span class="nv">liftM</span> <span class="p">(</span><span class="nv">take</span> <span class="mi">1</span><span class="p">)</span> <span class="o">$</span> <span class="nv">getArgs</span> <span class="o">&gt;&gt;=</span> <span class="nv">mapM</span> <span class="p">(</span><span class="o">\</span><span class="nv">path</span> <span class="o">-&gt;</span> <span class="nv">openFile</span> <span class="nv">path</span> <span class="n">ReadMode</span><span class="p">)</span>
    <span class="nv">str</span> <span class="o">&lt;-</span> <span class="nv">hGetContents</span> <span class="o">$</span> <span class="nv">head</span> <span class="o">$</span> <span class="nv">args</span> <span class="o">++</span> <span class="p">[</span><span class="nv">stdin</span><span class="p">]</span>
    <span class="nv">setTextToClipboard</span> <span class="nv">str</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6705/addtag/" class="addtag" id="addtag_6705">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6705/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6705/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6705"
  >-</span><span
  class="button yellow"
  id="rating_z_6705"
  >0</span><span 
  class="button green"
  id="rating_p_6705"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6705/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6710">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/591/" target="_top">99yen</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6710/">#6710</a>(<script language="JavaScript">print_time(new Date("2008/07/09 04:16 GMT"));</script><noscript>2008/07/09 04:16 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/nadesico/">
	  なでしこ
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  なでしこでは「コピー」でクリップボードにコピー、「クリップボード取得」でクリップボードを取得できます。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4</pre></td><td class="code"><div class="highlight"><pre># クリップボードにコピー
「Hello World」をコピー
# クリップボードから取得
クリップボード取得して表示
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6710/addtag/" class="addtag" id="addtag_6710">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/nadesico/">
		なでしこ
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6710/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6710/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6710"
  >-</span><span
  class="button yellow"
  id="rating_z_6710"
  >0</span><span 
  class="button green"
  id="rating_p_6710"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6710/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6711">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6711/">#6711</a>(<script language="JavaScript">print_time(new Date("2008/07/09 09:59 GMT"));</script><noscript>2008/07/09 09:59 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/tcl/">
	  Tcl
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>Tkのclipboardコマンドで実現できます。</p>

	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://tcl.tk/man/tcl8.5/TkCmd/clipboard.htm">clipboard manual page - Tk Built-In Commands</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5</pre></td><td class="code"><div class="highlight"><pre>package require Tk
clipboard clear
clipboard append &quot;テキスト&quot;; # 転送
clipboard get; # 取得
#=&gt; テキスト
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6711/addtag/" class="addtag" id="addtag_6711">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/clipboard/">clipboard</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/tcl/">
		Tcl
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6711/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6711/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6711"
  >-</span><span
  class="button yellow"
  id="rating_z_6711"
  >0</span><span 
  class="button green"
  id="rating_p_6711"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6711/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6721">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/606/" target="_top">pooq</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_bronze.png" border=0/></a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6721/">#6721</a>(<script language="JavaScript">print_time(new Date("2008/07/11 23:19 GMT"));</script><noscript>2008/07/11 23:19 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/j/">
	  J
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <pre class='compact'>windows用のGUI版の場合です。コンソール版では
「wd」が再定義されていてうまくいきません。

   clipcopy 'test test test'
   clippaste ''
test test test
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre>clipcopy=:3 :0
  wd &#39;clipcopy &quot;&#39;,y,&#39;&quot;&#39;
)
clippaste=:3 :0
  wd &#39;clippaste&#39;
)
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6721/addtag/" class="addtag" id="addtag_6721">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/j/">
		J
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6721/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6721/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6721"
  >-</span><span
  class="button yellow"
  id="rating_z_6721"
  >0</span><span 
  class="button green"
  id="rating_p_6721"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6721/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6723">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/343/" target="_top">shimakuma</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6723/">#6723</a>(<script language="JavaScript">print_time(new Date("2008/07/12 13:35 GMT"));</script><noscript>2008/07/12 13:35 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/commonlisp/">
	  Common Lisp
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  clisp扱いでいいのかな？
	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://xyzzy.s53.xrea.com/wiki/">xyzzy wiki</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2</pre></td><td class="code"><div class="highlight"><pre>(copy-to-clipboard &quot;hoge&quot;) ;転送
(get-clipboard-data) ;取得
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6723/addtag/" class="addtag" id="addtag_6723">Tags</a>:
	
    
    <a href="/web/20080820020346/http://ja.doukaku.org/tag/xyzzy/">xyzzy</a>
    
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/commonlisp/">
		Common Lisp
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6723/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6723/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6723"
  >-</span><span
  class="button yellow"
  id="rating_z_6723"
  >0</span><span 
  class="button green"
  id="rating_p_6723"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6723/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6724">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/59/" target="_top">nori</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6724/">#6724</a>(<script language="JavaScript">print_time(new Date("2008/07/13 10:48 GMT"));</script><noscript>2008/07/13 10:48 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <pre class='compact'>wxPythonのClipboard機能を試してみました。
プラットフォームに依存しないのがウリです。
windows xp, Centos5.1 gnome, Mac OS X Leopardで動作を確認しました。

らくちんすぎます。

コメント:
コードは、リンク先にあるwxpython.orgのコードを動くようにしただけです。

解説:
実行するとロードが跳ね上がります。
idle eventをhandleしてそこでTheClipboardの
内容をtext ctrlに貼り付けるだけ。
次のidle eventが処理されるので一瞬に
して消えます。
</pre>
	</div>
	
	<p class="link">
	  see: <a href="/web/20080820020346/http://wiki.wxpython.org/ClipBoard"></a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">wx</span>

<span class="k">class</span> <span class="nc">MyFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_MULTILINE</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">HSCROLL</span><span class="p">)</span>
    <span class="n">wx</span><span class="o">.</span><span class="n">EVT_IDLE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Paste</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">Paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
    <span class="n">do</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextDataObject</span><span class="p">()</span>
    <span class="n">success</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">do</span><span class="o">.</span><span class="n">GetText</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;There is no data in the clipboard in the required format&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyApp</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">OnInit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">MyFrame</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Hello from wxPython&quot;</span><span class="p">)</span>
    <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SetTopWindow</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">MyApp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6724/addtag/" class="addtag" id="addtag_6724">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6724/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6724/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6724"
  >-</span><span
  class="button yellow"
  id="rating_z_6724"
  >0</span><span 
  class="button green"
  id="rating_p_6724"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6724/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment6785">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/833/" target="_top">mattsan</a><a href="/web/20080820020346/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6785/">#6785</a>(<script language="JavaScript">print_time(new Date("2008/07/21 20:04 GMT"));</script><noscript>2008/07/21 20:04 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/delphi/">
	  Delphi
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>クリップボードの扱いを最初に覚えたDelphiで。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></td><td class="code"><div class="highlight"><pre><span class="k">program</span> <span class="n">doukaku188</span><span class="o">;</span>

<span class="cm">{$APPTYPE CONSOLE}</span>

<span class="k">uses</span>
  <span class="n">ClipBrd</span><span class="o">;</span>

<span class="k">var</span>
  <span class="n">S</span><span class="o">:</span> <span class="k">String</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">Clipboard</span><span class="o">.</span><span class="n">AsText</span> <span class="o">:=</span> <span class="s">&#39;テキスト&#39;</span><span class="o">;</span> <span class="cm">{ copy  }</span>
  <span class="n">S</span> <span class="o">:=</span> <span class="n">Clipboard</span><span class="o">.</span><span class="n">AsText</span><span class="o">;</span>          <span class="cm">{ paste }</span>
  <span class="nb">WriteLn</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">;</span>
<span class="k">end</span><span class="o">.</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/6785/addtag/" class="addtag" id="addtag_6785">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/delphi/">
		Delphi
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6785/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/6785/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6785"
  >-</span><span
  class="button yellow"
  id="rating_z_6785"
  >0</span><span 
  class="button green"
  id="rating_p_6785"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/6785/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment7065">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/813/" target="_top">lunlumo</a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7065/">#7065</a>(<script language="JavaScript">print_time(new Date("2008/08/08 11:54 GMT"));</script><noscript>2008/08/08 11:54 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/scala/">
	  Scala
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <div class="section">
<p>Javaと同じ処理になりますが...。</p>
</div>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></td><td class="code"><div class="highlight"><pre>import    java.awt.BorderLayout
import    java.awt.Container
import    java.awt.Dimension
import    java.awt.FlowLayout
import    java.awt.Toolkit
import    java.awt.datatransfer.Clipboard
import    java.awt.datatransfer.DataFlavor
import    java.awt.datatransfer.StringSelection
import    java.awt.event.ActionEvent
import    java.awt.event.ActionListener
import    javax.swing.JButton
import    javax.swing.JFrame
import    javax.swing.JMenu
import    javax.swing.JMenuBar
import    javax.swing.JMenuItem
import    javax.swing.JPanel
import    javax.swing.JTextArea

class SButton(l:String,c:ActionEvent=&gt;Unit) extends JButton with ActionListener {
    
    setText(l)
    addActionListener(this)
    
    override def actionPerformed(e:ActionEvent) = c(e)
}

class SMenuItem(l:String,c:ActionEvent=&gt;Unit) extends JMenuItem with ActionListener {
    
    setText(l)
    addActionListener(this)
    
    override def actionPerformed(e:ActionEvent) = c(e)
}

class ClipboardFrame(title:String) extends JFrame {
    
    val    mb:JMenuBar = new JMenuBar
    val    fm:JMenu = new JMenu(&quot;file&quot;)
    val    em:JMenu = new JMenu(&quot;edit&quot;)
    val    c:Container = getContentPane
    val    t:JTextArea = new JTextArea(20,40);
    val    p:JPanel = new JPanel;
    val    clipboard:Clipboard = Toolkit.getDefaultToolkit.getSystemClipboard;
    
    c.setLayout(new BorderLayout)
    c.add(t,BorderLayout.CENTER)
    
    p.setLayout(new FlowLayout)
    p.add(new SButton(&quot;copy&quot;,copy))
    p.add(new SButton(&quot;paste&quot;,paste))
    c.add(p,BorderLayout.SOUTH)
    
    fm.add(new SMenuItem(&quot;quit&quot;,quit))
    mb.add(fm)
    em.add(new SMenuItem(&quot;copy&quot;,copy))
    em.add(new SMenuItem(&quot;paste&quot;,paste))
    mb.add(em)
    setJMenuBar(mb)
    
    setResizable(false)
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)
    setTitle(title)
    
    pack
    
    def this() = this(&quot;clipboad&quot;)
    
    def quit(e:ActionEvent):Unit = {
        System.exit(0)
    }
    
    def copy(e:ActionEvent):Unit = {
        val    s:StringSelection = new StringSelection(t.getSelectedText);
        clipboard.setContents(s,s);
    }
    
    def paste(e:ActionEvent):Unit = {
        t.replaceSelection(clipboard.getData(DataFlavor.stringFlavor).asInstanceOf[String])
    }
}

object Main extends Application {
    (new ClipboardFrame).setVisible(true)
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7065/addtag/" class="addtag" id="addtag_7065">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/scala/">
		Scala
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/7065/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/7065/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_7065"
  >-</span><span
  class="button yellow"
  id="rating_z_7065"
  >0</span><span 
  class="button green"
  id="rating_p_7065"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/7065/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment7133">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/882/" target="_top">りんごちゃん</a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7133/">#7133</a>(<script language="JavaScript">print_time(new Date("2008/08/16 06:32 GMT"));</script><noscript>2008/08/16 06:32 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>Mac OS Xには
pbcopy, pbpasteの名前でシェルから
クリップポードを操作するコマンドが
存在します。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre>#!/usr/bin/env ruby -wKU

if (ARGV.length != 1)
  print &quot;Usage: handle_pb [-show] text\n&quot;
end

if ARGV.include?(&#39;-show&#39;) 
  
  print %x{ pbpaste }
else
  ENV[&#39;PB_COPY_TEXT&#39;] = ARGV[0]
  
  # デフォルトではpbcopyは日本語の場合Shift-JISしか扱えない
  %x{ echo $PB_COPY_TEXT | nkf -s | pbcopy } 
end
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7133/addtag/" class="addtag" id="addtag_7133">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/7133/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/7133/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_7133"
  >-</span><span
  class="button yellow"
  id="rating_z_7133"
  >0</span><span 
  class="button green"
  id="rating_p_7133"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/7133/">
  reply
  </a>]
  </div>
</div>
</div>




  


  

  
    





<div class="comment" id="comment7134">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/882/" target="_top">りんごちゃん</a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/">#7134</a>(<script language="JavaScript">print_time(new Date("2008/08/16 11:58 GMT"));</script><noscript>2008/08/16 11:58 GMT</noscript>)
	
	
	
	[<a href="/web/20080820020346/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>Mac OS Xには pbcopy, pbpasteの名前でシェルからクリップポードを操作するコマンドが存在します。（デフォルトではpbcopy,pbpasteは日本語の場合Shift-JISしか扱えないそうです）</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre><span class="c1">#!/usr/bin/env ruby -wKU</span>

<span class="k">if</span> <span class="p">(</span><span class="no">ARGV</span><span class="o">.</span><span class="n">length</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
  <span class="nb">print</span> <span class="s2">&quot;Usage: handle_pb [-show] text</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="k">end</span>

<span class="k">if</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;-show&#39;</span>
  
  <span class="nb">print</span> <span class="sx">%x{ pbpaste | nkf -w }</span>
<span class="k">else</span>
  <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;PB_COPY_TEXT&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
  
  <span class="c1"># デフォルトではpbcopyは日本語の場合Shift-JISしか扱えない</span>
  <span class="sx">%x{ echo $PB_COPY_TEXT | nkf -s | pbcopy }</span> 
<span class="k">end</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/addtag/" class="addtag" id="addtag_7134">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20080820020346/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/download/">
		download code
      </a>]
	  [<a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_7134"
  >-</span><span
  class="button yellow"
  id="rating_z_7134"
  >0</span><span 
  class="button green"
  id="rating_p_7134"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/">
    2
    replies
  </a>

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/7134/">
  reply
  </a>]
  </div>
</div>
</div>




  
    <div class="indent compact" style="position: relative;">
      <img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/1x1dark_green.png" width=10 style="position: absolute;top:-10px;margin-left:8px;">
      





<div class="comment" id="comment7136">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/882/" target="_top">りんごちゃん</a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7136/">#7136</a>(<script language="JavaScript">print_time(new Date("2008/08/16 13:58 GMT"));</script><noscript>2008/08/16 13:58 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>#!/usr/bin/ruby -wKSでnkfは取り除けました。
勘違いです。すいません。</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7136/addtag/" class="addtag" id="addtag_7136">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_7136"
  >-</span><span
  class="button yellow"
  id="rating_z_7136"
  >0</span><span 
  class="button green"
  id="rating_p_7136"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/7136/root/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/7136/">
  reply
  </a>]
  </div>
</div>
</div>




  


    </div>
  
    <div class="indent compact" style="position: relative;">
      <img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/1x1dark_green.png" width=10 style="position: absolute;top:-10px;margin-left:8px;">
      





<div class="comment" id="comment7137">
  <p class="banner"><a href="/web/20080820020346/http://ja.doukaku.org/user/882/" target="_top">りんごちゃん</a>

	
	&nbsp;
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7137/">#7137</a>(<script language="JavaScript">print_time(new Date("2008/08/16 08:58 GMT"));</script><noscript>2008/08/16 08:58 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>#!/usr/bin/ruby -wKSでnkfは取り除けました。
勘違いです。すいません。</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20080820020346/http://ja.doukaku.org/comment/7137/addtag/" class="addtag" id="addtag_7137">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_7137"
  >-</span><span
  class="button yellow"
  id="rating_z_7137"
  >0</span><span 
  class="button green"
  id="rating_p_7137"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/7134/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20080820020346/http://ja.doukaku.org/comment/7137/root/"><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20080820020346/http://ja.doukaku.org/188/reply_to/7137/">
  reply
  </a>]
  </div>
</div>
</div>




  


    </div>
  


  

  

  







</div>

<div id="side_menu" class="compact">

<iframe src="/web/20080820020346if_/http://ja.doukaku.org/login_info/" frameborder=0 width=100% id="login_info">
iframe required
</iframe>

<h4 class="semi_compact">Index</h4>

<ul>
<!--<li><a href="/web/20080820020346/http://ja.doukaku.org/user/">Users</a>-->
<li><a href="/web/20080820020346/http://ja.doukaku.org/lang/">Languages</a>
<li><a href="/web/20080820020346/http://ja.doukaku.org/challenge/">Challenges</a>
<li><a href="/web/20080820020346/http://ja.doukaku.org/topic/">Topics</a>
<li><a href="/web/20080820020346/http://ja.doukaku.org/comment/">Comments</a>
<li><a href="/web/20080820020346/http://ja.doukaku.org/good_comments/">Good comments</a>
<li><a href="/web/20080820020346/http://ja.doukaku.org/tag/">Tags</a>
</ul>

<h4 class="compact">Feed</h4>
<ul>
<li><a href="/web/20080820020346/http://ja.doukaku.org/feeds/challenges/">Latest challenges</a><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20080820020346/http://ja.doukaku.org/feeds/topics/">Latest topics</a><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20080820020346/http://ja.doukaku.org/feeds/comments/">Latest comments</a><img src="/web/20080820020346im_/http://ja.doukaku.org/static/image/feed_icon.png">
</ul>







<h4 class="compact">Other</h4>
<ul>
<li><a href="/web/20080820020346/http://ja.doukaku.org/qa/">Q&A</a>
<li><a href="/web/20080820020346/http://ja.doukaku.org/feedback/">Feedback</a>
<!--<li><a href="/web/20080820020346/http://ja.doukaku.org/terms">Terms</a>-->
</ul>


<h4 class="compact">Link</h4>
<ul>
<li><a href="/web/20080820020346/http://www.lingr.com/room/doukaku_ja">Chatroom in Lingr</a>
<li><a href="/web/20080820020346/http://labs.cybozu.co.jp/">Cybozu Labs.</a>
<li><a href="/web/20080820020346/http://www.djangoproject.com/">Django</a>
</ul>

<h4 id="pathtraq" class="compact"><a href="/web/20080820020346/http://pathtraq.com/analytics?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&m=popular">Pathtraq</a></h4>
<div class="indent">
<span id="pathtraq_sentinel">loading...</span>
</div>


</div>
</div>


<div id="page_foot" class="bordered">

<a rel="license" href="/web/20080820020346/http://creativecommons.org/licenses/by/2.1/jp/">
<img alt="Creative Commons License" style="border-width:0" src="/web/20080820020346im_/http://i.creativecommons.org/l/by/2.1/jp/88x31.png" /></a>
このサイトの内容は、
<a rel="license" href="/web/20080820020346/http://creativecommons.org/licenses/by/2.1/jp/">クリエイティブ・コモンズ・ライセンス</a>の下でライセンスされています。
<a href="/web/20080820020346/http://ja.doukaku.org/qa/#licence">[詳細]</a>

</div>

</body>




<script type="text/javascript">
$(document).ready(function(){$("#doukaku_org").after("<script src='/web/20080820020346/http://api.pathtraq.com/pages?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&api=json&callback=addPathtraq'><" + "/script>")});
</script>

<script src="/web/20080820020346js_/http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2136157-1";
urchinTracker();
</script>




</html>





<!--
     FILE ARCHIVED ON 2:03:46 Aug 20, 2008 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 14:40:37 Nov 16, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
