
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> 
  <head>

<script type="text/javascript" src="/static/js/analytics.js" ></script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>




    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
    <title>
コメントの削除
DouKaku? </title>

    <link rel="stylesheet" type="text/css"
	href="/web/20081121142336cs_/http://ja.doukaku.org/static/style/reset-fonts-grids.css" />
    <link rel="stylesheet" type="text/css"
	href="/web/20081121142336cs_/http://ja.doukaku.org/static/style/style.css?20071211?20071207" />
	
    <link rel="stylesheet" type="text/css"
	href="/web/20081121142336cs_/http://ja.doukaku.org/static/style/pygments.css" />


	
<meta name="robots" content="noindex,nofollow">

    <!--<script src="/web/20081121142336/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->


<!--<script src="/web/20081121142336/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->
<script src="/web/20081121142336js_/http://ja.doukaku.org/static/js/jquery-1.1.3.1.js" type="text/javascript"></script>
<script src="/web/20081121142336js_/http://ja.doukaku.org/static/js/rating.js" type="text/javascript"></script>
<script src="/web/20081121142336js_/http://ja.doukaku.org/static/js/addtag.js?20071129" type="text/javascript"></script>

<script type="text/javascript">
is_key_navigation_enable = true;
</script>
<script src="/web/20081121142336js_/http://ja.doukaku.org/static/js/utils.js?~~~" type="text/javascript"></script>

</head>


<body id="doukaku_org">
<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script> if (window.archive_analytics) { window.archive_analytics.values['server_name']="wwwb-app1.us.archive.org";}; </script>

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/ja.doukaku.org\/185\/flatten\/";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "21";
var displayMonth = "Nov";
var displayYear = "2008";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" lang="en" class="__wb_banner_div" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px">


<div id="wm-ipp-inside" class="__wb_banner_div" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://ja.doukaku.org/185/flatten/" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20081121142336" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;width: inherit !important" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Oct
                       
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 14:23:36 Nov 21, 2008">NOV</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Dec
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" />
                       
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 14:23:36 Nov 21, 2008">21</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2007
                       
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 14:23:36 Nov 21, 2008">2008</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2009
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20081121142336*/http://ja.doukaku.org/185/flatten/" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>1 captures</strong></a>
           <div class="__wb_banner_div" style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">21 Nov 08 - 21 Nov 08</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div class="__wb_banner_div" id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:10:000000000010_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->


<div id="page_head" class="compact">
  <h1 class="compact">
    <a href="/web/20081121142336/http://ja.doukaku.org/">DouKaku?</a><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/beta.png" alt="beta">
  </h1>
</div>

<div id="page_body" class="compact">
<div id="content" class="compact">




<h2 class="compact">
<img src='/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png' alt=challenge>
<a href="/web/20081121142336/http://ja.doukaku.org/185/">コメントの削除</a>
</h2>

    





<div class="comment" id="comment6534">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/98/" target="_top">nobsun</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6534/">#6534</a>(<script language="JavaScript">print_time(new Date("2008/06/18 01:56 GMT"));</script><noscript>2008/06/18 01:56 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffefaf;">-1/5=-0.20</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <pre class='compact'>ソースコードからコメント部分を削除するプログラム decomment を書いてください．
すくなくとも，decomment を記述したのと同じ言語で書かれているソースコードが
扱えるようにしてください．



</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6534/addtag/" class="addtag" id="addtag_6534">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #ffefaf;"
  >-1/5=-0.20</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6534"
  >-</span><span
  class="button yellow"
  id="rating_z_6534"
  >0</span><span 
  class="button green"
  id="rating_p_6534"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6534/">
  reply
  </a>]
  </div>
</div>
</div>




  



<div class="indent">
<a href="/web/20081121142336/http://ja.doukaku.org/185/post_comment/">
post comment
</a>
</div>


<h2>Posted feedbacks - Flatten</h2>
<a href="/web/20081121142336/http://ja.doukaku.org/185/nested/">Nested</a>
<a href="/web/20081121142336/http://ja.doukaku.org/185/">Hidden</a> 


  
  <br/>

  
  




<div class="comment" id="comment6544">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6544/">#6544</a>(<script language="JavaScript">print_time(new Date("2008/06/21 20:06 GMT"));</script><noscript>2008/06/21 20:06 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/java/">
	  Java
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>一番のりを狙って書きました。起動パラメータに与えられたJavaのソースファイルからコメントを削除し、&quot;.out&quot; 拡張子つきのファイルに書き込みます。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Decomment</span> <span class="o">{</span>

    <span class="k">static</span> <span class="k">final</span> <span class="n">Pattern</span> <span class="n">COMMENT1</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">&quot;/\\*.*?\\*/&quot;</span><span class="o">,</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">DOTALL</span><span class="o">);</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">Pattern</span> <span class="n">COMMENT2</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">&quot;//.*&quot;</span><span class="o">);</span>
    
    <span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="k">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">name</span><span class="o">));</span>
            <span class="n">FileWriter</span> <span class="n">w</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;.out&quot;</span><span class="o">);</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;line.separator&quot;</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">COMMENT1</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">sb</span><span class="o">).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">COMMENT2</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">s1</span><span class="o">).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>
            <span class="n">w</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
            <span class="n">w</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6544/addtag/" class="addtag" id="addtag_6544">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/java/">
		Java
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6544/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6544/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6544"
  >-</span><span
  class="button yellow"
  id="rating_z_6544"
  >0</span><span 
  class="button green"
  id="rating_p_6544"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20081121142336/http://ja.doukaku.org/comment/6544/">
    1
    reply
  </a>

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6544/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6545">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/685/" target="_top">Nemo</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6545/">#6545</a>(<script language="JavaScript">print_time(new Date("2008/06/21 20:26 GMT"));</script><noscript>2008/06/21 20:26 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/postscript/">
	  PostScript
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffefef;">-1/1=-1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>言語仕様的には PostScript では%以降がコメントになります。
ただしプリンタや処理系によってはコメント中の情報を用いて処理をする場合があります...</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></td><td class="code"><div class="highlight"><pre>%!PS

/Decomment { % (filename) Decomment -
    true exch
    (r) file
    {
        % outputflag file
        dup read
        not { exit } if
        dup 37 eq {
            3 -1 roll pop false 3 1 roll
        } if
        dup dup 10 eq exch 13 eq or {
            3 -1 roll pop true 3 1 roll
        } if
        2 index {
            ( ) dup 0 4 -1 roll put
            print
        } {
            pop
        } ifelse
    } loop
    pop pop
} bind def

%---- Test Code ----
(decomment.ps) Decomment
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6545/addtag/" class="addtag" id="addtag_6545">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/postscript/">
		PostScript
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6545/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6545/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffefef;"
  >-1/1=-1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6545"
  >-</span><span
  class="button yellow"
  id="rating_z_6545"
  >0</span><span 
  class="button green"
  id="rating_p_6545"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20081121142336/http://ja.doukaku.org/comment/6545/">
    1
    reply
  </a>

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6545/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6547">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6547/">#6547</a>(<script language="JavaScript">print_time(new Date("2008/06/21 21:33 GMT"));</script><noscript>2008/06/21 21:33 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>文字列リテラルに対応していませんでした。あわてると駄目ですね。</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6547/addtag/" class="addtag" id="addtag_6547">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6547"
  >-</span><span
  class="button yellow"
  id="rating_z_6547"
  >0</span><span 
  class="button green"
  id="rating_p_6547"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6544/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6547/root/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20081121142336/http://ja.doukaku.org/comment/6547/">
    1
    reply
  </a>

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6547/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6548">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6548/">#6548</a>(<script language="JavaScript">print_time(new Date("2008/06/21 22:14 GMT"));</script><noscript>2008/06/21 22:14 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/java/">
	  Java
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>文字列リテラル対応版です。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Decomment</span> <span class="o">{</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">String</span> <span class="n">LITERAL</span> <span class="o">=</span> <span class="s">&quot;\&quot;(?:\\\\.|[^\&quot;])*\&quot;&quot;</span><span class="o">;</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">String</span> <span class="n">COMMENT1</span> <span class="o">=</span> <span class="s">&quot;(?s:/\\*.*?\\*/)&quot;</span><span class="o">;</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">String</span> <span class="n">COMMENT2</span> <span class="o">=</span> <span class="s">&quot;//.*&quot;</span><span class="o">;</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">Pattern</span> <span class="n">DECOM_PAT</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">LITERAL</span> <span class="o">+</span> <span class="s">&quot;)|&quot;</span> <span class="o">+</span> 
            <span class="n">COMMENT1</span> <span class="o">+</span> <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="n">COMMENT2</span><span class="o">);</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">String</span> <span class="n">LINE_SEPARATOR</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&quot;line.separator&quot;</span><span class="o">);</span>
    
    <span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="k">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">r</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">name</span><span class="o">));</span>
            <span class="n">FileWriter</span> <span class="n">w</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileWriter</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;.out&quot;</span><span class="o">);</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">LINE_SEPARATOR</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">DECOM_PAT</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">sb</span><span class="o">).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&quot;$1&quot;</span><span class="o">);</span>
            <span class="n">w</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
            <span class="n">w</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6548/addtag/" class="addtag" id="addtag_6548">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/java/">
		Java
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6548/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6548/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6548"
  >-</span><span
  class="button yellow"
  id="rating_z_6548"
  >0</span><span 
  class="button green"
  id="rating_p_6548"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6547/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6548/root/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6548/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6549">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/88/" target="_top">sumim</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6549/">#6549</a>(<script language="JavaScript">print_time(new Date("2008/06/21 23:36 GMT"));</script><noscript>2008/06/21 23:36 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/smalltalk/">
	  Smalltalk
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>Squeak Smalltalk で。</p>
<p>与えられた Smalltalk コードを抽象構文木に落とし、それに含まれるコメントノードを削除してから文字列に戻して出力しました（実際は、抽象構文木の初回出力時にそこからコメントノードが削除される副作用を流用）。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></td><td class="code"><div class="highlight"><pre>| decomment |
decomment := [:sourceStr |
    | dummySel tree |
    dummySel := &#39;dummy &#39;.
    tree := Parser new
        parse: (dummySel, sourceStr) readStream
        class: UndefinedObject
        noPattern: false
        context: nil
        notifying: nil
        ifFail: [^nil]. 
    (tree printString; printString) allButFirst: dummySel size].

^decomment value: &#39;&quot;comment1&quot; ^ self &quot;comment2&quot;&#39;   &quot;=&gt; &#39;    ^ self&#39; &quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6549/addtag/" class="addtag" id="addtag_6549">Tags</a>:
	
    
    <a href="/web/20081121142336/http://ja.doukaku.org/tag/Squeak_Smalltalk/">Squeak_Smalltalk</a>
    
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/smalltalk/">
		Smalltalk
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6549/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6549/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6549"
  >-</span><span
  class="button yellow"
  id="rating_z_6549"
  >0</span><span 
  class="button green"
  id="rating_p_6549"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6549/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6550">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/766/" target="_top">syat</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6550/">#6550</a>(<script language="JavaScript">print_time(new Date("2008/06/22 02:47 GMT"));</script><noscript>2008/06/22 02:47 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/brainfuck/">
	  Brainf*ck
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>Brainf*ckで。入力された文字のうち、コメント（実行可能な８文字以外全部）を削除します。終了せず、ひたすら入力を待ち続けるので適当に止めてください。</p>
<p>Brainfuck Developerで実行する場合は複数行の入力ができませんが、[Extras] - [Set Input File ...] から入力ファイルを指定できます。すばらしいツールです。あとは言語が良けりゃぁ言うことなし。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></td><td class="code"><div class="highlight"><pre>+[&gt;
  ,                      # {1} = input char
  &gt;+&lt;                    # {2} = 1
  [-&gt;&gt;+&gt;+&lt;&lt;&lt;]            # {3:4} = !{1}
  &gt;&gt;&gt;
  &gt;++++++[-&lt;-------&gt;]&lt;-  # {4} = {4} minus 43
  [                      # if {4} not 43 (plus)
    -[                   # if {4} not 44 (comma)
      -[                 # if {4} not 45 (minus)
        -[               # if {4} not 46 (dot)
          &gt;++++[-&lt;----&gt;]&lt;++
          [              # if {4} not 60 (lt)
            --[          # if {4} not 62 (gt)
              &gt;+++++[-&lt;------&gt;]&lt;+
              [          # if {4} not 91 (open)
                --[      # if {4} not 93 (close)
                  &lt;&lt;-&gt;&gt;  #   then {2} = 0
                  [-]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  ]
  &lt;&lt;
  [&gt;.&lt;-]                 # if {2} then print {3}
  &gt;[-]&lt;&lt;
&lt;]
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6550/addtag/" class="addtag" id="addtag_6550">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/brainfuck/">
		Brainf*ck
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6550/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6550/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6550"
  >-</span><span
  class="button yellow"
  id="rating_z_6550"
  >0</span><span 
  class="button green"
  id="rating_p_6550"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6550/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6551">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/827/" target="_top">baal</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6551/">#6551</a>(<script language="JavaScript">print_time(new Date("2008/06/22 04:08 GMT"));</script><noscript>2008/06/22 04:08 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  Scheme で書きました。
read で読み込んで write で書き出せばコメントを消すことができます。
但し、タブや改行まで消えてしまいます。
これ以外の方法で実装しようとするとパーサを書き直すことになり大変ですので、この方法に Pretty Printer を組み合わせるのが現実的な回答だと思います。

	</div>
	
	<p class="link">
	  see: <a href="/web/20081121142336/http://practical-scheme.net/wiliki/wiliki.cgi?Gauche%3APrettyPrint">Gauche:PrettyPrint</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">decomment</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
  <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">s</span> <span class="p">(</span><span class="nf">read</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">eof-object? </span><span class="nv">s</span><span class="p">))</span>
      <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="nb">write </span><span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">newline</span><span class="p">)</span> <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nf">read</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">main</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">args</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">decomment</span><span class="p">)</span>
  <span class="mi">0</span><span class="p">))</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6551/addtag/" class="addtag" id="addtag_6551">Tags</a>:
	
    
    <a href="/web/20081121142336/http://ja.doukaku.org/tag/Scheme/">Scheme</a>
    
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6551/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6551/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6551"
  >-</span><span
  class="button yellow"
  id="rating_z_6551"
  >0</span><span 
  class="button green"
  id="rating_p_6551"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6551/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6552">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/685/" target="_top">Nemo</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6552/">#6552</a>(<script language="JavaScript">print_time(new Date("2008/06/22 05:25 GMT"));</script><noscript>2008/06/22 05:25 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/postscript/">
	  PostScript
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>修正版... 文字列中に%を書けたとは...</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></td><td class="code"><div class="highlight"><pre>%!PS

/Decomment { % (filename) Decomment -
    true exch
    0 exch
    (r) file
    {
        % outputflag file
        dup read
        not { exit } if
        dup 40 eq {
            3 -1 roll 1 add 3 1 roll
        } if
        dup 41 eq {
            3 -1 roll 1 sub 3 1 roll
        } if
        dup 37 eq {
            2 index 0 eq {
                4 -1 roll pop false 4 1 roll
            } if
        } if
        dup dup 10 eq exch 13 eq or {
            4 -2 roll pop pop true 0 4 2 roll
        } if
        3 index {
            ( ) dup 0 4 -1 roll put
            print
        } {
            pop
        } ifelse 
    } loop
    pop pop pop
} bind def

%---- Test Code ----
(====%===) pop % ==
(decomment.ps) Decomment
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6552/addtag/" class="addtag" id="addtag_6552">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/postscript/">
		PostScript
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6552/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6552/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6552"
  >-</span><span
  class="button yellow"
  id="rating_z_6552"
  >0</span><span 
  class="button green"
  id="rating_p_6552"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6545/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6552/root/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6552/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6553">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/232/" target="_top">kkobayashi</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6553/">#6553</a>(<script language="JavaScript">print_time(new Date("2008/06/22 20:46 GMT"));</script><noscript>2008/06/22 20:46 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/r/">
	  R
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>doukaku.185.R:
------------------------------------------------------------------------
# Rのコメントは一行なので、大抵の場合はgrep("^[^#]", &lt;文字列&gt;, value=TRUE)で問題なさそうですが。

a &lt;- 10  # 文頭以外のコメント
b &lt;- "文字列中の#"

if(0){
    ここに書くコメントはRの文法上のコメントではないので削除されません
}


実行結果:
------------------------------------------------------------------------
&gt; decomment("doukaku.185.R")
expression(a &lt;- 10, b &lt;- "文字列中の#", if(0){
    ここに書くコメントはRの文法上のコメントではないので削除されません
})
attr(,"srcfile")
doukaku.185.R</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1</pre></td><td class="code"><div class="highlight"><pre>decomment &lt;- parse
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6553/addtag/" class="addtag" id="addtag_6553">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/r/">
		R
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6553/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6553/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6553"
  >-</span><span
  class="button yellow"
  id="rating_z_6553"
  >0</span><span 
  class="button green"
  id="rating_p_6553"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6553/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6554">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/760/" target="_top">turugina</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6554/">#6554</a>(<script language="JavaScript">print_time(new Date("2008/06/23 00:17 GMT"));</script><noscript>2008/06/23 00:17 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/cpp/">
	  C++
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>C++で書いてみました。
が、C++を書いた気にならない...

ちなみに、#if 0 ～ #endif は「コメント」ではないと思っているので対応していません。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>

<span class="c">/* g++ -o decomment decomment.cpp */</span>

<span class="c">// decomment</span>
<span class="kt">void</span> <span class="n">decomment</span><span class="p">(</span>
    <span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">os</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">is</span>
    <span class="p">)</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="n">blc</span><span class="p">,</span> <span class="n">olc</span><span class="p">;</span> <span class="c">/* in block/one-line comment */</span>
  <span class="kt">bool</span> <span class="n">str</span><span class="p">,</span> <span class="n">chr</span><span class="p">;</span> <span class="c">/* in string/char literal */</span>

  <span class="n">blc</span><span class="o">=</span><span class="n">olc</span><span class="o">=</span><span class="n">str</span><span class="o">=</span><span class="n">chr</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>

  <span class="kt">char</span> <span class="n">c</span><span class="p">,</span><span class="n">pc</span><span class="o">=</span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">is</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c">// escape</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\\&#39;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="p">)</span>
          <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
        <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">is</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="p">)</span>
        <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c">// end of one-line comment</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\r&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">olc</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
      <span class="n">pc</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c">// end of block comment</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">blc</span> <span class="o">&amp;&amp;</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">blc</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="n">pc</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c">// start of one-line comment</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">chr</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">olc</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="n">pc</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c">// start of block comment</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">chr</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">olc</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">blc</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="n">pc</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c">// start/end of char literal</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">chr</span> <span class="o">=</span> <span class="o">!</span><span class="n">chr</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="p">)</span>
        <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
      <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c">// start/end of string literal</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\&quot;&#39;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">str</span> <span class="o">=</span> <span class="o">!</span><span class="n">str</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="p">)</span>
        <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
      <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">pc</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="p">)</span>
        <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;/&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">olc</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">blc</span> <span class="p">)</span>
        <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="p">{</span>
  <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;//\</span>
<span class="s">                      &quot;</span> <span class="s">&quot;/*&quot;</span> <span class="s">&quot;hoge&quot;</span> <span class="s">&quot;*/&quot;</span>
                      <span class="c">/* / * /* // */</span> <span class="s">&quot;hige&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
  <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">test</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;usage: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &lt;C++ source file&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">std</span><span class="o">::</span><span class="n">ifstream</span> <span class="n">ifs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">ifs</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;failed to open &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">decomment</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span> <span class="n">ifs</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6554/addtag/" class="addtag" id="addtag_6554">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/cpp/">
		C++
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6554/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6554/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6554"
  >-</span><span
  class="button yellow"
  id="rating_z_6554"
  >0</span><span 
  class="button green"
  id="rating_p_6554"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6554/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6555">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/760/" target="_top">turugina</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6555/">#6555</a>(<script language="JavaScript">print_time(new Date("2008/06/23 00:43 GMT"));</script><noscript>2008/06/23 00:43 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/perl/">
	  Perl
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>CPANモジュール PPI を利用して。
# SYNOPSISにまんまコメント削除の例が載ってたし</pre>
	</div>
	
	<p class="link">
	  see: <a href="/web/20081121142336/http://search.cpan.org/~adamk/PPI-1.203/lib/PPI.pm">PPI</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="n">PPI</span><span class="p">;</span>

<span class="cm">=head1 NAME</span>

<span class="cm">decomment - strip comments/pods from code</span>

<span class="cm">=head1 SYNOPSIS</span>

<span class="cm">  decomment.pl &lt;some.pl&gt;</span>

<span class="cm">=head1 SEE ALSO</span>

<span class="cm">L&lt;http://ja.doukaku.org/185/&gt;</span>

<span class="cm">PPI L&lt;http://search.cpan.org/~adamk/PPI-1.203/lib/PPI.pm&gt;</span>

<span class="cm">=cut</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">print</span> <span class="s">&quot;usage: $0 &lt;some.pl&gt;\n&quot;</span><span class="p">;</span>
  <span class="nb">exit</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1"># test data</span>
<span class="k">my</span> <span class="nv">$testdata</span> <span class="o">=</span> <span class="s">&quot;string with # :)&quot;</span><span class="p">;</span> <span class="c1"># this is a comment;</span>

<span class="c1"># use PPI to strip comment from code</span>
<span class="k">my</span> <span class="nv">$doc</span> <span class="o">=</span> <span class="nn">PPI::</span><span class="n">Document</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span><span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="nv">$doc</span><span class="o">-&gt;</span><span class="n">prune</span><span class="p">(</span><span class="n">q</span><span class="sr">/PPI::Token::Pod/</span><span class="p">);</span>
<span class="nv">$doc</span><span class="o">-&gt;</span><span class="n">prune</span><span class="p">(</span><span class="n">q</span><span class="sr">/PPI::Token::Comment/</span><span class="p">);</span>
<span class="k">print</span> <span class="nv">$doc</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">;</span>

<span class="cp">__END__</span>
<span class="cp">this section is not a comment.</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6555/addtag/" class="addtag" id="addtag_6555">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/perl/">
		Perl
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6555/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6555/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6555"
  >-</span><span
  class="button yellow"
  id="rating_z_6555"
  >0</span><span 
  class="button green"
  id="rating_p_6555"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6555/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6556">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/830/" target="_top">honconn</a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6556/">#6556</a>(<script language="JavaScript">print_time(new Date("2008/06/23 01:36 GMT"));</script><noscript>2008/06/23 01:36 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffefef;">-1/1=-1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>やっつけです</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="n">FILE</span> <span class="o">*</span><span class="n">f</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">flg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>

  <span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="s">&quot;r&quot;</span><span class="p">);</span>

  <span class="k">while</span><span class="p">((</span><span class="n">c</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;*&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">((</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)){</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flg</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">flg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_SUCCESS</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6556/addtag/" class="addtag" id="addtag_6556">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6556/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6556/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffefef;"
  >-1/1=-1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6556"
  >-</span><span
  class="button yellow"
  id="rating_z_6556"
  >0</span><span 
  class="button green"
  id="rating_p_6556"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6556/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6557">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6557/">#6557</a>(<script language="JavaScript">print_time(new Date("2008/06/23 02:47 GMT"));</script><noscript>2008/06/23 02:47 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/cpp/">
	  C++
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>ストリームを使っているだけで実質Cですね…。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">decomment</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">in</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">in</span><span class="p">.</span><span class="n">unsetf</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">skipws</span><span class="p">);</span>

    <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
            <span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">do</span>
                <span class="p">{</span>
                    <span class="k">while</span><span class="p">((</span><span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;*&#39;</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">while</span><span class="p">((</span><span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;/&#39;</span><span class="p">));</span>

                <span class="n">c</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">while</span><span class="p">((</span><span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\n&#39;</span><span class="p">))</span>
                    <span class="p">;</span> <span class="c">// NOP</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="n">prev</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;&quot;&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">prev</span> <span class="o">!=</span> <span class="sc">&#39;\\&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">prev</span> <span class="o">!=</span> <span class="sc">&#39;\&#39;&#39;</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">do</span>
            <span class="p">{</span>
                <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\\&#39;</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
                    <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">while</span><span class="p">((</span><span class="n">in</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;&quot;&#39;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">decomment</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6557/addtag/" class="addtag" id="addtag_6557">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/cpp/">
		C++
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6557/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6557/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6557"
  >-</span><span
  class="button yellow"
  id="rating_z_6557"
  >0</span><span 
  class="button green"
  id="rating_p_6557"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6557/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6560">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6560/">#6560</a>(<script language="JavaScript">print_time(new Date("2008/06/23 15:45 GMT"));</script><noscript>2008/06/23 15:45 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/emacslisp/">
	  Emacs Lisp
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>comment-kill がやるようです。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre>(defun decomment (buffer)
  &quot;バッファ内のコメント文を削除します&quot;
  (interactive &quot;bdecomment &quot;)
  (with-current-buffer buffer
    (save-excursion
      (goto-char (point-min))
      (comment-kill (point-max)))))
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6560/addtag/" class="addtag" id="addtag_6560">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/emacslisp/">
		Emacs Lisp
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6560/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6560/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6560"
  >-</span><span
  class="button yellow"
  id="rating_z_6560"
  >0</span><span 
  class="button green"
  id="rating_p_6560"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6560/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6563">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/497/" target="_top">Otter</a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6563/">#6563</a>(<script language="JavaScript">print_time(new Date("2008/06/23 18:32 GMT"));</script><noscript>2008/06/23 18:32 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>α置換の時に使ったパーサーがコメントを読み落としてしまうことを利用しました。もっと単純に文字列のパースでもできるはずですが、既存のソースに手を加えればできるということで…</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre><span class="kr">module</span> <span class="n">Main</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="n">Language</span><span class="o">.</span><span class="n">Haskell</span><span class="o">.</span><span class="n">Syntax</span>
<span class="kr">import</span> <span class="n">Language</span><span class="o">.</span><span class="n">Haskell</span><span class="o">.</span><span class="n">Parser</span>
<span class="kr">import</span> <span class="n">Language</span><span class="o">.</span><span class="n">Haskell</span><span class="o">.</span><span class="n">Pretty</span>
<span class="kr">import</span> <span class="n">Data</span><span class="o">.</span><span class="n">Generics</span>

<span class="nv">pp</span> <span class="o">::</span> <span class="n">ParseResult</span> <span class="n">HsModule</span> <span class="o">-&gt;</span> <span class="n">String</span>
<span class="nv">pp</span> <span class="p">(</span><span class="n">ParseOk</span> <span class="nv">hsm</span><span class="p">)</span> <span class="o">=</span> <span class="nv">prettyPrint</span> <span class="nv">hsm</span>
<span class="nv">pp</span> <span class="kr">_</span> <span class="o">=</span> <span class="s">&quot;parse failed&quot;</span>

<span class="nv">main</span> <span class="o">::</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">main</span> 
  <span class="o">=</span> <span class="kr">do</span> <span class="nv">mod</span> <span class="o">&lt;-</span> <span class="nv">getContents</span>
       <span class="nv">putStr</span> <span class="o">$</span> <span class="nv">pp</span> <span class="o">$</span> <span class="nv">parseModule</span> <span class="nv">mod</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6563/addtag/" class="addtag" id="addtag_6563">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6563/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6563/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6563"
  >-</span><span
  class="button yellow"
  id="rating_z_6563"
  >0</span><span 
  class="button green"
  id="rating_p_6563"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20081121142336/http://ja.doukaku.org/comment/6563/">
    1
    reply
  </a>

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6563/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6565">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/831/" target="_top">a2c</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6565/">#6565</a>(<script language="JavaScript">print_time(new Date("2008/06/23 21:58 GMT"));</script><noscript>2008/06/23 21:58 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>初投稿
泥です。
初めてre使った</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">sys</span>

<span class="k">try</span> <span class="p">:</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">raw_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;file read error&quot;</span>

<span class="n">sharpe</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;.*#.*&quot;</span><span class="p">)</span>
<span class="n">s_quote</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;&#39;&#39;&#39;&quot;</span><span class="p">)</span>
<span class="n">d_quote</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;&quot;&quot;&quot;&#39;</span><span class="p">)</span>

<span class="n">de_sharpe_str</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">raw_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
    <span class="n">de_sharpe_str</span> <span class="o">+=</span> <span class="n">sharpe</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">s_quote</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">de_sharpe_str</span><span class="p">)[</span><span class="n">x</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_quote</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">de_sharpe_str</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_quote</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">de_sharpe_str</span><span class="p">)[</span><span class="n">x</span><span class="p">]</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span><span class="p">)]</span>

<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6565/addtag/" class="addtag" id="addtag_6565">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6565/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6565/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6565"
  >-</span><span
  class="button yellow"
  id="rating_z_6565"
  >0</span><span 
  class="button green"
  id="rating_p_6565"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20081121142336/http://ja.doukaku.org/comment/6565/">
    1
    reply
  </a>

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6565/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6566">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/497/" target="_top">Otter</a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6566/">#6566</a>(<script language="JavaScript">print_time(new Date("2008/06/23 23:38 GMT"));</script><noscript>2008/06/23 23:38 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>これはパーサーの実装に依存したハックですね…</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6566/addtag/" class="addtag" id="addtag_6566">Tags</a>:
	
	No tags
	&nbsp;

	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6566"
  >-</span><span
  class="button yellow"
  id="rating_z_6566"
  >0</span><span 
  class="button green"
  id="rating_p_6566"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6563/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6566/root/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6566/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6573">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/832/" target="_top">柿</a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6573/">#6573</a>(<script language="JavaScript">print_time(new Date("2008/06/24 15:51 GMT"));</script><noscript>2008/06/24 15:51 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  同じく，タブや改行は消えてしまいます．<br/>writeだと，#0=(1&nbsp;.&nbsp;#0#)で終わらないのでwirte/ssを使いました．
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="nf">port-for-each</span> <span class="nv">write/ss</span> <span class="nv">read</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6573/addtag/" class="addtag" id="addtag_6573">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6573/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6573/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6573"
  >-</span><span
  class="button yellow"
  id="rating_z_6573"
  >0</span><span 
  class="button green"
  id="rating_p_6573"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20081121142336/http://ja.doukaku.org/comment/6573/">
    1
    reply
  </a>

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6573/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6574">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/832/" target="_top">柿</a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6574/">#6574</a>(<script language="JavaScript">print_time(new Date("2008/06/24 16:01 GMT"));</script><noscript>2008/06/24 16:01 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  すいません，訂正です．<br/>#6573のでは，トップレベルに直接変数が書いてあった時に，くっ付いてしまいますね．
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="nf">port-for-each</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">write/ss</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">newline</span><span class="p">))</span> <span class="nv">read</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6574/addtag/" class="addtag" id="addtag_6574">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6574/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6574/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6574"
  >-</span><span
  class="button yellow"
  id="rating_z_6574"
  >0</span><span 
  class="button green"
  id="rating_p_6574"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6573/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20081121142336/http://ja.doukaku.org/comment/6574/root/"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6574/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6579">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/361/" target="_top">masa.edw</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6579/">#6579</a>(<script language="JavaScript">print_time(new Date("2008/06/24 14:38 GMT"));</script><noscript>2008/06/24 14:38 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>相互再帰風に書いてみました</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="k">typedef</span> <span class="kt">void</span><span class="o">*</span> <span class="p">(</span><span class="o">*</span><span class="n">filter</span><span class="p">)(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">drive</span><span class="p">(</span><span class="n">filter</span> <span class="n">f</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">in</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">c</span><span class="p">;</span>

    <span class="k">do</span> <span class="p">{</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span><span class="n">in</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">)</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">)));</span>
<span class="p">}</span>

<span class="cp">#define CALL(func)                              \</span>
<span class="cp">    do { return func; } while(0)</span>

<span class="cp">#define FINISH()                                \</span>
<span class="cp">    do { return NULL; } while(0)</span>


<span class="kt">void</span><span class="o">*</span> <span class="n">normal_code</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">next_of_slash_in_normal_code</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">string</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">next_of_backslash_in_string</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">single_quote</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">next_of_backslash_in_single_quote</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">comment</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">next_of_star_in_comment</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">oneline_comment</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span><span class="p">);</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">normal_code</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">&#39;/&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">next_of_slash_in_normal_code</span><span class="p">);</span>

    <span class="k">case</span> <span class="sc">&#39;&quot;&#39;</span><span class="o">:</span>
        <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>

    <span class="k">case</span> <span class="sc">&#39;\&#39;&#39;</span><span class="o">:</span>
        <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">single_quote</span><span class="p">);</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">normal_code</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">next_of_slash_in_normal_code</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">&#39;*&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">comment</span><span class="p">);</span>
        
    <span class="k">case</span> <span class="sc">&#39;/&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">oneline_comment</span><span class="p">);</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="n">fputc</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
        <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">normal_code</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">string</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">&#39;\\&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">next_of_backslash_in_string</span><span class="p">);</span>

    <span class="k">case</span> <span class="sc">&#39;&quot;&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">normal_code</span><span class="p">);</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">next_of_backslash_in_string</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
    <span class="n">CALL</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">single_quote</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">&#39;\\&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">next_of_backslash_in_single_quote</span><span class="p">);</span>

    <span class="k">case</span> <span class="sc">&#39;\&#39;&#39;</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">normal_code</span><span class="p">);</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">single_quote</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">next_of_backslash_in_single_quote</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">fputc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
    <span class="n">CALL</span><span class="p">(</span><span class="n">single_quote</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">comment</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="p">)</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">next_of_star_in_comment</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">comment</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">next_of_star_in_comment</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">normal_code</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">comment</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">oneline_comment</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">)</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">normal_code</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">CALL</span><span class="p">(</span><span class="n">oneline_comment</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">decomment</span><span class="p">(</span><span class="n">FILE</span><span class="o">*</span> <span class="n">in</span><span class="p">,</span> <span class="n">FILE</span><span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">drive</span><span class="p">(</span><span class="n">normal_code</span><span class="p">,</span> <span class="n">in</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">decomment</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6579/addtag/" class="addtag" id="addtag_6579">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6579/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6579/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6579"
  >-</span><span
  class="button yellow"
  id="rating_z_6579"
  >0</span><span 
  class="button green"
  id="rating_p_6579"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6579/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6580">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6580/">#6580</a>(<script language="JavaScript">print_time(new Date("2008/06/24 20:54 GMT"));</script><noscript>2008/06/24 20:54 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>おもいっきりベタな実装してみました。もしかすると抜けている部分があるかもしれません…。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><div class="highlight"><pre><span class="nv">decomment</span> <span class="o">::</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">String</span>
<span class="nv">decomment</span> <span class="nv">s</span> <span class="o">=</span> <span class="nv">decommentNormal</span> <span class="nv">s</span>
  <span class="kr">where</span>
    <span class="nv">decommentNormal</span>         <span class="p">[]</span>                      <span class="o">=</span> <span class="p">[]</span>
    <span class="nv">decommentNormal</span>         <span class="p">(</span><span class="sc">&#39;\&#39;&#39;:&#39;</span><span class="s">&quot;&#39;:&#39;\&#39;&#39;:cs)      = &#39;\&#39;&#39;:&#39;&quot;</span><span class="sc">&#39;:&#39;</span><span class="o">\</span><span class="sc">&#39;&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentNormal</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentNormal</span>         <span class="p">(</span><span class="sc">&#39;\&#39;&#39;:&#39;</span><span class="o">\\</span><span class="sc">&#39;:&#39;</span><span class="s">&quot;&#39;:&#39;\&#39;&#39;:cs) = &#39;\&#39;&#39;:&#39;\\&#39;:&#39;&quot;</span><span class="sc">&#39;:&#39;</span><span class="o">\</span><span class="sc">&#39;&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentNormal</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentNormal</span>         <span class="p">(</span><span class="sc">&#39;&quot;&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>                <span class="o">=</span> <span class="sc">&#39;&quot;&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentQuote</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentNormal</span>         <span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="o">:</span><span class="sc">&#39;-&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>            <span class="o">=</span> <span class="nv">decommentCommentLine</span> <span class="nv">cs</span>
    <span class="nv">decommentNormal</span>         <span class="p">(</span><span class="sc">&#39;{&#39;</span><span class="o">:</span><span class="sc">&#39;-&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>            <span class="o">=</span> <span class="nv">decommentCommentBlock</span> <span class="mi">0</span> <span class="nv">cs</span>
    <span class="nv">decommentNormal</span>         <span class="p">(</span><span class="nv">c</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>                  <span class="o">=</span> <span class="nv">c</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentNormal</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentQuote</span>          <span class="p">(</span><span class="sc">&#39;&quot;&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>                <span class="o">=</span> <span class="sc">&#39;&quot;&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentNormal</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentQuote</span>          <span class="p">(</span><span class="sc">&#39;\\&#39;</span><span class="o">:</span><span class="sc">&#39;&quot;&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>           <span class="o">=</span> <span class="sc">&#39;\\&#39;</span><span class="o">:</span><span class="sc">&#39;&quot;&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentQuote</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentQuote</span>          <span class="p">(</span><span class="nv">c</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>                  <span class="o">=</span> <span class="nv">c</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentQuote</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentCommentLine</span>    <span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>               <span class="o">=</span> <span class="sc">&#39;\n&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentNormal</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentCommentLine</span>    <span class="p">(</span><span class="kr">_</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>                  <span class="o">=</span> <span class="nv">decommentCommentLine</span> <span class="nv">cs</span>
    <span class="nv">decommentCommentBlock</span> <span class="mi">0</span> <span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="o">:</span><span class="sc">&#39;}&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>            <span class="o">=</span> <span class="sc">&#39;\n&#39;</span><span class="o">:</span><span class="p">(</span><span class="nv">decommentNormal</span> <span class="nv">cs</span><span class="p">)</span>
    <span class="nv">decommentCommentBlock</span> <span class="nv">n</span> <span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="o">:</span><span class="sc">&#39;}&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>            <span class="o">=</span> <span class="nv">decommentCommentBlock</span> <span class="p">(</span><span class="nv">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nv">cs</span>
    <span class="nv">decommentCommentBlock</span> <span class="nv">n</span> <span class="p">(</span><span class="sc">&#39;{&#39;</span><span class="o">:</span><span class="sc">&#39;-&#39;</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>            <span class="o">=</span> <span class="nv">decommentCommentBlock</span> <span class="p">(</span><span class="nv">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="nv">cs</span>
    <span class="nv">decommentCommentBlock</span> <span class="nv">n</span> <span class="p">(</span><span class="nv">c</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>                  <span class="o">=</span> <span class="nv">decommentCommentBlock</span> <span class="nv">n</span>     <span class="nv">cs</span>

<span class="nv">main</span> <span class="o">=</span> <span class="nv">getContents</span> <span class="o">&gt;&gt;=</span> <span class="nv">putStrLn</span><span class="o">.</span><span class="nv">decomment</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6580/addtag/" class="addtag" id="addtag_6580">Tags</a>:
	
	No tags
	&nbsp;

	
      [<a href="/web/20081121142336/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6580/download/">
		download code
      </a>]
	  [<a href="/web/20081121142336/http://ja.doukaku.org/comment/6580/download_html/">
		get code as html
      </a>]<p>
	

  
  <span class="rating">
  Rating<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6580"
  >-</span><span
  class="button yellow"
  id="rating_z_6580"
  >0</span><span 
  class="button green"
  id="rating_p_6580"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20081121142336/http://ja.doukaku.org/185/reply_to/6580/">
  reply
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6586">
  <p class="banner"><a href="/web/20081121142336/http://ja.doukaku.org/user/98/" target="_top">nobsun</a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20081121142336/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20081121142336im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20081121142336/http://ja.doukaku.org/comment/6586/">#6586</a>(<script language="JavaScript">print_time(new Date("2008/06/25 02:45 GMT"));</script><noscript>2008/06/25 02:45 GMT</noscript>)
	
	
	
	[<a href="/web/20081121142336/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;

<span class="rating">Rating<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <div class="section">
<p>ちょっと長いけど，Haskell, C, C++ 対応のつもり，</p>
<p></p>
<p>CommentStyleクラスとQuoteStyleクラスを使って，いろいろな言語に対応できるように工夫してみた．</p>
<ul>
<li>
 commentLeadings メソッドは一行コメントの開始マーク(複数可)文字列を返すメソッド
</li>
<li>
 commentOpenings メソッドはブロックコメントの開始マーク(複数可)文字列を返すメソッド
</li>
<li>
 commentClosing  メソッドは与えられたブロックコメントの開始マークに対応する修了マークを返すメソッド
</li>
<li> commentNestable はブロックコメントがネスト可能かどうかを返すメソッド</li>
</ul>
<p>など．</p>
<p></p>
<ul>
<li>
 文字列リテラル
</li>
<li> ブロックコメントのネスト</li>
</ul>
<p></p>
<p>に対応する．厳密にやるには，その言語のパーザを読んで結果の構文木データを，プリティプリンタ(自作することになる)に食わせるのかな．めんどうだけど．．.</p>
</div>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118</pre></td><td class="code"><div class="highlight"><pre><span class="cm">{-# LANGUAGE EmptyDataDecls #-}</span>
<span class="kr">module</span> <span class="n">Main</span> <span class="p">(</span><span class="nv">main</span><span class="p">)</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="n">Control</span><span class="o">.</span><span class="n">Arrow</span>
<span class="kr">import</span> <span class="n">Data</span><span class="o">.</span><span class="n">Char</span>
<span class="kr">import</span> <span class="n">Data</span><span class="o">.</span><span class="n">List</span>
<span class="kr">import</span> <span class="n">Data</span><span class="o">.</span><span class="n">Maybe</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Environment</span>

<span class="nv">main</span> <span class="o">::</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">main</span> <span class="o">=</span> <span class="nv">interact</span> <span class="o">.</span> <span class="nv">genDecomment</span> <span class="o">.</span> <span class="nv">listToMaybe</span> <span class="o">.</span> <span class="nv">map</span> <span class="p">(</span><span class="nv">map</span> <span class="nv">toLower</span><span class="p">)</span> <span class="o">=&lt;&lt;</span> <span class="nv">getArgs</span>
   
<span class="nv">genDecomment</span> <span class="o">::</span> <span class="n">Maybe</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">String</span>
<span class="nv">genDecomment</span> <span class="p">(</span><span class="n">Just</span> <span class="s">&quot;c&quot;</span><span class="p">)</span>    <span class="o">=</span> <span class="nv">decomment</span> <span class="nv">cstyle</span>
<span class="nv">genDecomment</span> <span class="p">(</span><span class="n">Just</span> <span class="s">&quot;c++&quot;</span><span class="p">)</span>  <span class="o">=</span> <span class="nv">decomment</span> <span class="nv">cppstyle</span>
<span class="nv">genDecomment</span> <span class="kr">_</span>             <span class="o">=</span> <span class="nv">decomment</span> <span class="nv">hstyle</span>

<span class="kr">class</span> <span class="n">CommentStyle</span> <span class="nv">c</span> <span class="kr">where</span>
  <span class="nv">commentLeadings</span>  <span class="o">::</span> <span class="nv">c</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">String</span><span class="p">]</span>
  <span class="nv">commentOpenings</span>  <span class="o">::</span> <span class="nv">c</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">String</span><span class="p">]</span>
  <span class="nv">commentClosing</span>   <span class="o">::</span> <span class="nv">c</span> <span class="o">-&gt;</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">String</span>
  <span class="nv">commentNestable</span>  <span class="o">::</span> <span class="nv">c</span> <span class="o">-&gt;</span> <span class="n">Bool</span>

<span class="kr">class</span> <span class="n">QuoteStyle</span> <span class="nv">q</span> <span class="kr">where</span>
  <span class="nv">quoteOpenings</span>  <span class="o">::</span> <span class="nv">q</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">Char</span><span class="p">]</span>
  <span class="nv">quoteClosing</span>   <span class="o">::</span> <span class="nv">q</span> <span class="o">-&gt;</span> <span class="n">Char</span> <span class="o">-&gt;</span> <span class="n">Char</span>
  <span class="nv">quoteEscape</span>    <span class="o">::</span> <span class="nv">q</span> <span class="o">-&gt;</span> <span class="n">Char</span>

<span class="nv">splitWithPrefix</span> <span class="o">::</span> <span class="n">Eq</span> <span class="nv">a</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nv">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nv">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="n">Maybe</span> <span class="p">([</span><span class="nv">a</span><span class="p">],[</span><span class="nv">a</span><span class="p">])</span>
<span class="nv">splitWithPrefix</span> <span class="p">[]</span> <span class="nv">xs</span> <span class="o">=</span> <span class="n">Just</span> <span class="p">([],</span><span class="nv">xs</span><span class="p">)</span>
<span class="nv">splitWithPrefix</span> <span class="p">(</span><span class="nv">p</span><span class="o">:</span><span class="nv">ps</span><span class="p">)</span> <span class="nv">xxs</span><span class="o">@</span><span class="p">(</span><span class="nv">x</span><span class="o">:</span><span class="nv">xs</span><span class="p">)</span>
  <span class="o">|</span> <span class="nv">p</span> <span class="o">==</span> <span class="nv">x</span>     <span class="o">=</span> <span class="nv">splitWithPrefix</span> <span class="nv">ps</span> <span class="nv">xs</span> <span class="o">&gt;&gt;=</span> <span class="nv">return</span> <span class="o">.</span> <span class="p">((</span><span class="nv">x</span><span class="o">:</span><span class="p">)</span> <span class="o">***</span> <span class="nv">id</span><span class="p">)</span>
  <span class="o">|</span> <span class="nv">otherwise</span>  <span class="o">=</span> <span class="n">Nothing</span>

<span class="nv">splitQuoted</span> <span class="o">::</span> <span class="n">Eq</span> <span class="nv">a</span> <span class="o">=&gt;</span> <span class="nv">a</span> <span class="o">-&gt;</span> <span class="nv">a</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nv">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">([</span><span class="nv">a</span><span class="p">],</span> <span class="p">[</span><span class="nv">a</span><span class="p">])</span>
<span class="nv">splitQuoted</span> <span class="nv">esc</span> <span class="nv">qm</span> <span class="p">[]</span>   <span class="o">=</span> <span class="p">([],[])</span>
<span class="nv">splitQuoted</span> <span class="nv">esc</span> <span class="nv">qm</span> <span class="p">(</span><span class="nv">c</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span>
           <span class="o">|</span> <span class="nv">c</span> <span class="o">==</span> <span class="nv">qm</span>    <span class="o">=</span> <span class="p">([],</span><span class="nv">cs</span><span class="p">)</span>    
           <span class="o">|</span> <span class="nv">c</span> <span class="o">==</span> <span class="nv">esc</span>   <span class="o">=</span> <span class="kr">case</span> <span class="nv">cs</span> <span class="kr">of</span> 
                            <span class="p">[]</span>     <span class="o">-&gt;</span> <span class="p">([</span><span class="nv">c</span><span class="p">],[])</span>
                            <span class="nv">c&#39;</span><span class="o">:</span><span class="nv">cs&#39;</span> <span class="o">-&gt;</span> <span class="p">((</span><span class="nv">c</span><span class="o">:</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">c&#39;</span><span class="o">:</span><span class="p">)</span> <span class="o">***</span> <span class="nv">id</span><span class="p">)</span> <span class="o">$</span> <span class="nv">splitQuoted</span> <span class="nv">esc</span> <span class="nv">qm</span> <span class="nv">cs&#39;</span>
           <span class="o">|</span> <span class="nv">otherwise</span>  <span class="o">=</span> <span class="p">((</span><span class="nv">c</span><span class="o">:</span><span class="p">)</span> <span class="o">***</span> <span class="nv">id</span><span class="p">)</span> <span class="o">$</span> <span class="nv">splitQuoted</span> <span class="nv">esc</span> <span class="nv">qm</span> <span class="nv">cs</span>

<span class="nv">decomment</span> <span class="o">::</span> <span class="p">(</span><span class="n">CommentStyle</span> <span class="nv">s</span><span class="p">,</span> <span class="n">QuoteStyle</span> <span class="nv">s</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nv">s</span> <span class="o">-&gt;</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">String</span>
<span class="nv">decomment</span> <span class="nv">s</span> <span class="s">&quot;&quot;</span>         <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="nv">decomment</span> <span class="nv">s</span> <span class="nv">ccs</span><span class="o">@</span><span class="p">(</span><span class="nv">c</span><span class="o">:</span><span class="nv">cs</span><span class="p">)</span> <span class="o">=</span> <span class="kr">case</span> <span class="nv">mapMaybe</span> <span class="p">(</span><span class="nv">flip</span> <span class="nv">splitWithPrefix</span> <span class="nv">ccs</span><span class="p">)</span> <span class="o">$</span> <span class="nv">commentLeadings</span> <span class="nv">s</span> <span class="kr">of</span>
  <span class="p">(</span><span class="kr">_</span><span class="p">,</span><span class="nv">xs</span><span class="p">)</span><span class="o">:</span><span class="kr">_</span> <span class="o">-&gt;</span> <span class="nv">decomment</span> <span class="nv">s</span> <span class="o">$</span> <span class="nv">snd</span> <span class="o">$</span> <span class="nv">break</span> <span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="o">==</span><span class="p">)</span> <span class="nv">xs</span>
  <span class="p">[]</span>       <span class="o">-&gt;</span> <span class="kr">case</span> <span class="nv">mapMaybe</span> <span class="p">(</span><span class="nv">flip</span> <span class="nv">splitWithPrefix</span> <span class="nv">ccs</span><span class="p">)</span> <span class="o">$</span> <span class="nv">commentOpenings</span> <span class="nv">s</span> <span class="kr">of</span>
                <span class="p">(</span><span class="nv">p</span><span class="p">,</span><span class="nv">xs</span><span class="p">)</span><span class="o">:</span><span class="kr">_</span> <span class="o">-&gt;</span> <span class="nv">decommentC</span> <span class="nv">s</span> <span class="p">[</span><span class="nv">p</span><span class="p">]</span> <span class="nv">xs</span>
                <span class="p">[]</span>       <span class="o">-&gt;</span> <span class="kr">if</span> <span class="nv">elem</span> <span class="nv">c</span> <span class="p">(</span><span class="nv">quoteOpenings</span> <span class="nv">s</span><span class="p">)</span> <span class="kr">then</span> <span class="nv">c</span><span class="o">:</span><span class="nv">decommentQ</span> <span class="nv">s</span> <span class="nv">c</span> <span class="nv">cs</span> 
                            <span class="kr">else</span> <span class="nv">c</span><span class>




<!--
     FILE ARCHIVED ON 14:23:36 Nov 21, 2008 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:04:25 Nov 16, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
