
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> 
  <head>

<script type="text/javascript" src="/static/js/analytics.js" ></script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>




    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
    <title>
指定コマンドを別プロセスで起動
どう書く？org </title>

    <link rel="stylesheet" type="text/css"
	href="/web/20100617095718cs_/http://ja.doukaku.org/static/style/reset-fonts-grids.css" />
    <link rel="stylesheet" type="text/css"
	href="/web/20100617095718cs_/http://ja.doukaku.org/static/style/style.css?20071211?20071207" />
	
    <link rel="stylesheet" type="text/css"
	href="/web/20100617095718cs_/http://ja.doukaku.org/static/style/pygments.css" />


	
<meta name="robots" content="noindex,nofollow">

    <!--<script src="/web/20100617095718/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->


<!--<script src="/web/20100617095718/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->
<script src="/web/20100617095718js_/http://ja.doukaku.org/static/js/jquery-1.1.3.1.js" type="text/javascript"></script>
<script src="/web/20100617095718js_/http://ja.doukaku.org/static/js/rating.js" type="text/javascript"></script>
<script src="/web/20100617095718js_/http://ja.doukaku.org/static/js/addtag.js?20071129" type="text/javascript"></script>

<script type="text/javascript">
is_key_navigation_enable = true;
</script>
<script src="/web/20100617095718js_/http://ja.doukaku.org/static/js/utils.js?~~~" type="text/javascript"></script>

</head>


<body id="doukaku_org">
<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script> if (window.archive_analytics) { window.archive_analytics.values['server_name']="wwwb-app13.us.archive.org";}; </script>

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/ja.doukaku.org\/127\/flatten\/";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "17";
var displayMonth = "Jun";
var displayYear = "2010";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" lang="en" class="__wb_banner_div" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px">


<div id="wm-ipp-inside" class="__wb_banner_div" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://ja.doukaku.org/127/flatten/" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20100617095718" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;width: inherit !important" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20100410055326/http://ja.doukaku.org/127/flatten/" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="10 Apr 2010"><strong>APR</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 9:57:18 Jun 17, 2010">JUN</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Jul
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20100410055326/http://ja.doukaku.org/127/flatten/" title="5:53:26 Apr 10, 2010" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 9:57:18 Jun 17, 2010">17</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20080418011415/http://ja.doukaku.org/127/flatten/" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="18 Apr 2008"><strong>2008</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 9:57:18 Jun 17, 2010">2010</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2011
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20100617095718*/http://ja.doukaku.org/127/flatten/" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>5 captures</strong></a>
           <div class="__wb_banner_div" style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">13 May 07 - 17 Jun 10</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div class="__wb_banner_div" id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000010000000_2008:-1:010100000000_2009:-1:000000000000_2010:5:000101000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->


<div id="page_head" class="compact">
  <h1 class="compact">
    <a href="/web/20100617095718/http://ja.doukaku.org/">どう書く？org</a><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/beta.png" alt="beta">
  </h1>
</div>

<div id="page_body" class="compact">
<div id="content" class="compact">




<h2 class="compact">
<img src='/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png' alt=お題(出題済み)>
<a href="/web/20100617095718/http://ja.doukaku.org/127/">指定コマンドを別プロセスで起動</a>
</h2>

    





<div class="comment" id="comment5353">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/550/" target="_top">todogzm</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5353/">#5353</a>(<script language="JavaScript">print_time(new Date("2008/01/16 08:03 GMT"));</script><noscript>2008/01/16 08:03 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #bfff7f;">4/8=0.50</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  <p>与えられた文字列のコマンドを、別プロセスで実行してください。
異なるPIDのプロセスが立ち上がり、指定したコマンドを実行することが条件です。</p>
<p>あわせて、実行結果のリターンコードと、別プロセスが出力した標準出力を受け取る方法も記載してください。</p>
<p>今回投稿する上で、別プロセスとして実行するコマンドの与え方は自由ですが、実行した結果、何らかの損害を与えるようなコマンドは埋め込まないようにお願いします。</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5353/addtag/" class="addtag" id="addtag_5353">タグ</a>:
	
	タグなし
	&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #bfff7f;"
  >4/8=0.50</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5353"
  >-</span><span
  class="button yellow"
  id="rating_z_5353"
  >0</span><span 
  class="button green"
  id="rating_p_5353"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5353/">
  返信
  </a>]
  </div>
</div>
</div>




  



<div class="indent">
<a href="/web/20100617095718/http://ja.doukaku.org/127/post_comment/">
投稿する
</a>
</div>


<h2>投稿されたコメント - フラット表示</h2>
<a href="/web/20100617095718/http://ja.doukaku.org/127/nested/">ネスト表示</a>
<a href="/web/20100617095718/http://ja.doukaku.org/127/">非表示</a> 


  
  <br/>

  
  




<div class="comment" id="comment5458">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/570/" target="_top">horiuchi</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5458/">#5458</a>(<script language="JavaScript">print_time(new Date("2008/01/26 06:51 GMT"));</script><noscript>2008/01/26 06:51 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/java/">
	  Java
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>Windowsで、『ipconfig /all』を実行しその結果を受け取ってみました。
実行結果のリターンコードは、Process#exitValue()で取得できます。Process#waitFor() では終了するのを待ってリターンコードを返します。
別プロセスが出力した標準出力を受け取る方法は、Process#getInputStream() で標準出力を受け取れます。Process#getErrorStream() で標準エラーを受け取れます。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><div class="highlight"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">Sample127</span> <span class="o">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">ProcessBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ProcessBuilder</span><span class="o">(</span><span class="s">&quot;ipconfig&quot;</span><span class="o">,</span> <span class="s">&quot;/all&quot;</span><span class="o">);</span>
            <span class="n">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

            <span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span> <span class="n">line</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span> <span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="k">continue</span><span class="o">;</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="na">waitFor</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;ExitValue=&quot;</span> <span class="o">+</span> <span class="n">ret</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5458/addtag/" class="addtag" id="addtag_5458">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/Java1.5/">Java1.5</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/java/">
		Java
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5458/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5458/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5458"
  >-</span><span
  class="button yellow"
  id="rating_z_5458"
  >0</span><span 
  class="button green"
  id="rating_p_5458"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5458/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5460">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/664/" target="_top">tenka</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5460/">#5460</a>(<script language="JavaScript">print_time(new Date("2008/01/26 07:25 GMT"));</script><noscript>2008/01/26 07:25 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/csharp/">
	  C#
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>こんな感じでしょうか？
&gt;ProcessStart
Error: ProcessStart &lt;Exe Name&gt;

&gt;ProcessStart HelloWorldProgram
Current PID : 2104
Process Start PID : 2360

別コンソール
HelloWorld.

&gt;ProcessStart HelloWorldProgram Hanako
Current PID : 2776
Process Start PID : 2600

別コンソール
HelloWorld.
Hanako

&gt;ProcessStart HelloWorldProgram Hanako Tarou
Current PID : 2880
Process Start PID : 2828

別コンソール
HelloWorld.
Hanako
Tarou

&gt;ProcessStart aaa
Error: Don't find Process</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></td><td class="code"><div class="highlight"><pre><span class="c">//ProceccStart.cs</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="k">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">Length</span> <span class="p">&lt;</span> <span class="m">1</span><span class="p">)</span>
        <span class="k">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Error: ProcessStart &lt;Exe Name&gt;&quot;</span><span class="p">);</span>
            <span class="n">Environment</span><span class="p">.</span><span class="n">Exit</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
        <span class="k">}</span>

        <span class="k">try</span>
        <span class="k">{</span>
            <span class="kt">string</span> <span class="n">exe</span> <span class="p">=</span> <span class="n">args</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
            <span class="kt">string</span> <span class="n">arg</span> <span class="p">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">args</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="k">{</span>
                <span class="n">arg</span> <span class="p">+=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">+</span> <span class="s">&quot; &quot;</span><span class="p">;</span>
            <span class="k">}</span>
            <span class="n">Process</span> <span class="n">ps</span> <span class="p">=</span> <span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Current PID : {0}&quot;</span><span class="p">,</span> <span class="n">Process</span><span class="p">.</span><span class="n">GetCurrentProcess</span><span class="p">().</span><span class="n">Id</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Process Start PID : {0}&quot;</span><span class="p">,</span> <span class="n">ps</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
        <span class="k">}</span>
        <span class="k">catch</span>
        <span class="k">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Error: Don&#39;t find Process&quot;</span><span class="p">);</span>
            <span class="n">Environment</span><span class="p">.</span><span class="n">Exit</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
        <span class="k">}</span>
    <span class="k">}</span>
<span class="k">}</span>

<span class="c">//HelloWorldProgram.cs</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">HelloWorldProgram</span>
<span class="k">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;HelloWorld.&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">arg</span> <span class="k">in</span> <span class="n">args</span><span class="p">)</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">arg</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">();</span>
    <span class="k">}</span>
<span class="k">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5460/addtag/" class="addtag" id="addtag_5460">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/csharp/">
		C#
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5460/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5460/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5460"
  >-</span><span
  class="button yellow"
  id="rating_z_5460"
  >0</span><span 
  class="button green"
  id="rating_p_5460"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20100617095718/http://ja.doukaku.org/comment/5460/">
    1
    reply
  </a>

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5460/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5462">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/405/" target="_top">g000001</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5462/">#5462</a>(<script language="JavaScript">print_time(new Date("2008/01/26 07:42 GMT"));</script><noscript>2008/01/26 07:42 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/commonlisp/">
	  Common Lisp
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  Common&nbsp;LispでUNIXの外部コマンドを実行する方法は実装依存になります。<br/>いくつか処理系の差異を吸収するラッパーがありますが、KMRCLの<br/>command-outputが今回のお題にはぴったりな気がするので紹介してみます。<br/><br/>この関数はコマンドを引数として、実行結果を多値で返します。<br/>内容は、(1)実行結果の標準出力、(2)エラーの場合、エラー出力、(3)リターンコード<br/>となっています。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><div class="highlight"><pre>(require :kmrcl)
;kmrcl:command-output実行例

;; 成功
(multiple-value-bind (out error code)
    (kmrcl:command-output &quot;~A&quot; &quot;date&quot;)
  (format t &quot;OUT:~A ~%ERROR: ~A~%STAT: ~D~%&quot; out error code))
;=&gt;
;OUT:2008年  1月 26日 土曜日 16:40:07 JST
; 
;ERROR: 
;STAT: 0

;; エラー
(multiple-value-bind (out error code)
    (kmrcl:command-output &quot;~A&quot; &quot;foo&quot;)
  (format t &quot;OUT:~A ~%ERROR: ~A~%STAT: ~D~%&quot; out error code))
;=&gt;
;OUT: 
;ERROR: /bin/sh: foo: not found
;
;STAT: 127
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5462/addtag/" class="addtag" id="addtag_5462">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/commonlisp/">
		Common Lisp
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5462/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5462/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5462"
  >-</span><span
  class="button yellow"
  id="rating_z_5462"
  >0</span><span 
  class="button green"
  id="rating_p_5462"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5462/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5463">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/428/" target="_top">Y</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5463/">#5463</a>(<script language="JavaScript">print_time(new Date("2008/01/26 08:29 GMT"));</script><noscript>2008/01/26 08:29 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/mathematica/">
	  Mathematica
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>Cygwinシェル上でmath.exeを実行した結果

In[1]:= Run["ps"]
      PID    PPID    PGID     WINPID  TTY  UID    STIME COMMAND
     4876       1    4876       4876  con 1003 15:38:24 /usr/bin/bash
     1348    4876    1348        736  con 1003 17:16:08 /cygdrive/c/Program Files/Wolfram Research/Mathematica/5.2/math
     2368       1    2368       2368  con 1003 17:16:16 /usr/bin/ps
Out[1]= 0

これではリターンコードは戻り値として取得できるが、出力は表示されるだけで再利用できない。

仕方なく、出力を一度ファイルに入れることにする（Windows以外ならもっと簡単なはず）。
結果リストの1番目がリターンコード、2番目が出力

In[3]:= exec@"ps"

Out[3]= {0, {      PID    PPID    PGID     WINPID  TTY  UID    STIME COMMAND,
&gt;          4876       1    4876       4876  con 1003 15:38:24 /usr/bin/bash,
&gt;          1348    4876    1348        736  con 1003 17:16:08\
&gt;      /cygdrive/c/Program Files/Wolfram Research/Mathematica/5.2/math,
&gt;          4768       1    4768       4768  con 1003 17:17:33 /usr/bin/ps}}
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre>exec[command_] := Module[{
    code,result,
    file = First@ReadList[&quot;!mktemp&quot;,String]
  },
  code = Run[command &lt;&gt; &quot; &gt; &quot; &lt;&gt; file];
  result = ReadList[file,String];
  Run[&quot;rm &quot;&lt;&gt;file];
  {code,result}]
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5463/addtag/" class="addtag" id="addtag_5463">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/mathematica/">
		Mathematica
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5463/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5463/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5463"
  >-</span><span
  class="button yellow"
  id="rating_z_5463"
  >0</span><span 
  class="button green"
  id="rating_p_5463"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5463/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5464">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/82/" target="_top">yuin</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_bronze.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5464/">#5464</a>(<script language="JavaScript">print_time(new Date("2008/01/26 08:30 GMT"));</script><noscript>2008/01/26 08:30 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>subprocessモジュールを使います。</p>
<p>Pythonでは</p>
<ul class="simple">
<li>os.system</li>
<li>os.spawn*</li>
<li>os.popen*</li>
<li>popen2.*</li>
<li>commands.*</li>
</ul>
<p>と外部コマンド関連のモジュールがたくさんありますが、subprocessモジュールは最も新しく、上記のような古いモジュールを置き換える目的で導入されています。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">subprocess</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">([</span><span class="s">&quot;ipconfig&quot;</span><span class="p">,</span> <span class="s">&quot;/all&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&quot;return code:</span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="n">p</span><span class="o">.</span><span class="n">returncode</span>
<span class="k">print</span> <span class="s">&quot;pid: </span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="n">p</span><span class="o">.</span><span class="n">pid</span>
<span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5464/addtag/" class="addtag" id="addtag_5464">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5464/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5464/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5464"
  >-</span><span
  class="button yellow"
  id="rating_z_5464"
  >0</span><span 
  class="button green"
  id="rating_p_5464"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5464/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5467">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/664/" target="_top">tenka</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5467/">#5467</a>(<script language="JavaScript">print_time(new Date("2008/01/26 11:18 GMT"));</script><noscript>2008/01/26 11:18 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/csharp/">
	  C#
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>上記の方法だとコンソールが2つに分かれるので、一つに統一しました。あと戻り値を持たせなきゃいけないみたいなので、関数で書き直しました。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre></td><td class="code"><div class="highlight"><pre><span class="c">//ProcessStart.cs</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="k">{</span>
    <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">CMD</span> <span class="p">=</span> <span class="s">@&quot;C:\WINDOWS\system32\cmd.exe&quot;</span><span class="p">;</span>

    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;ping&quot;</span><span class="p">,</span> <span class="s">&quot;127.0.0.1&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;HelloWorldProgram&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;HelloWorldProgram&quot;</span><span class="p">,</span> <span class="s">@&quot;Yamada&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;HelloWorldProgram&quot;</span><span class="p">,</span> <span class="s">@&quot;Yamada Hanako&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;dir&quot;</span><span class="p">,</span> <span class="s">@&quot;C:\Python25&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;aaa&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span>

    <span class="k">}</span>

    <span class="k">static</span> <span class="kt">bool</span> <span class="nf">Exec</span><span class="p">(</span><span class="kt">string</span> <span class="n">command</span><span class="p">,</span> <span class="kt">string</span> <span class="n">arg</span><span class="p">)</span>
    <span class="k">{</span>
        <span class="k">try</span>
        <span class="k">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">command</span> <span class="p">==</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="k">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Error</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;コマンド書いてないよ&quot;</span><span class="p">);</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="k">}</span>
            <span class="n">Process</span> <span class="n">ps</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Process</span><span class="p">();</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="n">CMD</span><span class="p">;</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">Arguments</span> <span class="p">=</span> <span class="s">&quot;/c &quot;</span> <span class="p">+</span> <span class="n">command</span> <span class="p">+</span> <span class="s">&quot; &quot;</span> <span class="p">+</span> <span class="n">arg</span><span class="p">;</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">UseShellExecute</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardOutput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardError</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">CreateNoWindow</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">WorkingDirectory</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">GetCurrentDirectory</span><span class="p">();</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
            <span class="n">ps</span><span class="p">.</span><span class="n">WaitForExit</span><span class="p">();</span>

            <span class="kt">string</span> <span class="n">output</span> <span class="p">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">StandardOutput</span><span class="p">.</span><span class="n">ReadToEnd</span><span class="p">().</span><span class="n">Replace</span><span class="p">(</span><span class="s">&quot;\r\r\n&quot;</span><span class="p">,</span> <span class="s">&quot;\r\n&quot;</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">error</span> <span class="p">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">StandardError</span><span class="p">.</span><span class="n">ReadToEnd</span><span class="p">().</span><span class="n">Replace</span><span class="p">(</span><span class="s">&quot;\r\r\n&quot;</span><span class="p">,</span> <span class="s">&quot;\r\n&quot;</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="k">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Error</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="k">}</span>

            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Current PID : {0}&quot;</span><span class="p">,</span> <span class="n">Process</span><span class="p">.</span><span class="n">GetCurrentProcess</span><span class="p">().</span><span class="n">Id</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Process Start PID : {0}&quot;</span><span class="p">,</span> <span class="n">ps</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="k">}</span>
        <span class="k">catch</span>
        <span class="k">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Error: Don&#39;t find Process&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">}</span>
    <span class="k">}</span>
<span class="k">}</span>

<span class="c">//HelloWorldProgram.cs</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">HelloWorldProgram</span>
<span class="k">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;HelloWorld.&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">arg</span> <span class="k">in</span> <span class="n">args</span><span class="p">)</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">arg</span><span class="p">);</span>
    <span class="k">}</span>
<span class="k">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5467/addtag/" class="addtag" id="addtag_5467">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/csharp/">
		C#
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5467/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5467/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5467"
  >-</span><span
  class="button yellow"
  id="rating_z_5467"
  >0</span><span 
  class="button green"
  id="rating_p_5467"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/5460/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/5467/root/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5467/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5468">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/28/" target="_top">minke</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5468/">#5468</a>(<script language="JavaScript">print_time(new Date("2008/01/26 11:20 GMT"));</script><noscript>2008/01/26 11:20 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <div class="section">
<p>System.Processモジュールの runInteractiveCommand を使用しています。</p>
<p>同モジュールの waitForProcess は System.Exit モジュールの ExitCode型のIOを返します。</p>
</div>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></td><td class="code"><div class="highlight"><pre><span class="kr">import</span> <span class="n">IO</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Process</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Exit</span>

<span class="nv">run</span> <span class="o">::</span> <span class="n">String</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">run</span> <span class="nv">cmd</span> <span class="o">=</span> <span class="kr">do</span> <span class="p">(</span><span class="nv">ih</span><span class="p">,</span> <span class="nv">oh</span><span class="p">,</span> <span class="nv">eh</span><span class="p">,</span> <span class="nv">ph</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nv">runInteractiveCommand</span> <span class="nv">cmd</span>
             <span class="nv">putStrLn</span> <span class="o">=&lt;&lt;</span> <span class="nv">hGetContents</span> <span class="nv">oh</span>
             <span class="nv">status</span> <span class="o">&lt;-</span> <span class="nv">waitForProcess</span> <span class="nv">ph</span>
             <span class="kr">case</span> <span class="nv">status</span> <span class="kr">of</span>
               <span class="n">ExitSuccess</span> <span class="o">-&gt;</span> <span class="nv">putStrLn</span> <span class="o">$</span> <span class="nv">cmd</span> <span class="o">++</span> <span class="s">&quot; ok&quot;</span>
               <span class="n">ExitFailure</span> <span class="nv">code</span> <span class="o">-&gt;</span> <span class="nv">putStr</span> <span class="s">&quot;error: &quot;</span> <span class="o">&gt;&gt;</span> <span class="nv">print</span> <span class="nv">code</span>

<span class="nv">main</span> <span class="o">::</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">main</span> <span class="o">=</span> <span class="nv">run</span> <span class="s">&quot;ls -la&quot;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5468/addtag/" class="addtag" id="addtag_5468">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5468/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5468/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5468"
  >-</span><span
  class="button yellow"
  id="rating_z_5468"
  >0</span><span 
  class="button green"
  id="rating_p_5468"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5468/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5469">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/679/" target="_top">muscovyduck</a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5469/">#5469</a>(<script language="JavaScript">print_time(new Date("2008/01/26 13:43 GMT"));</script><noscript>2008/01/26 13:43 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #dfffdf;">2/2=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>POpen4ライブラリを使うと、「別プロセスでコマンドを実行」「プロセスID、標準入出力、標準エラー出力の完全な掌握」「コマンド終了後のリターンコードを得る」がセットでできます。ライブラリ万歳。</p>

	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://popen4.rubyforge.org/">http://popen4.rubyforge.org/</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;open4&#39;</span>

<span class="n">status</span> <span class="o">=</span> <span class="no">Open4</span><span class="o">.</span><span class="n">popen4</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pid</span><span class="p">,</span> <span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="o">|</span>
  <span class="n">stdin</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;echo 42.out&#39;</span>
  <span class="n">stdin</span><span class="o">.</span><span class="n">puts</span> <span class="s1">&#39;echo 42.err 1&gt;&amp;2&#39;</span>
  <span class="n">stdin</span><span class="o">.</span><span class="n">close</span>

  <span class="nb">puts</span> <span class="s2">&quot;pid        : </span><span class="si">#{</span> <span class="n">pid</span> <span class="si">}</span><span class="s2">&quot;</span>
  <span class="nb">puts</span> <span class="s2">&quot;stdout     : </span><span class="si">#{</span> <span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">strip</span> <span class="si">}</span><span class="s2">&quot;</span>
  <span class="nb">puts</span> <span class="s2">&quot;stderr     : </span><span class="si">#{</span> <span class="n">stderr</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">strip</span> <span class="si">}</span><span class="s2">&quot;</span>
<span class="k">end</span>

<span class="nb">puts</span> <span class="s2">&quot;status     : </span><span class="si">#{</span> <span class="n">status</span><span class="o">.</span><span class="n">inspect</span> <span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">puts</span> <span class="s2">&quot;exitstatus : </span><span class="si">#{</span> <span class="n">status</span><span class="o">.</span><span class="n">exitstatus</span> <span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5469/addtag/" class="addtag" id="addtag_5469">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5469/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5469/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #dfffdf;"
  >2/2=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5469"
  >-</span><span
  class="button yellow"
  id="rating_z_5469"
  >0</span><span 
  class="button green"
  id="rating_p_5469"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5469/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5471">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/170/" target="_top">anekos</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5471/">#5471</a>(<script language="JavaScript">print_time(new Date("2008/01/26 16:26 GMT"));</script><noscript>2008/01/26 16:26 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/io/">
	  Io
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>ls -la を実行。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre>sc := SystemCall clone
sc command = &quot;ls&quot;
sc arguments = list(&quot;-la&quot;)
sc run
sc stdout readLines foreach (it, it println) # 標準出力
sc returnCode println # リターンコード
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5471/addtag/" class="addtag" id="addtag_5471">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/io/">
		Io
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5471/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5471/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5471"
  >-</span><span
  class="button yellow"
  id="rating_z_5471"
  >0</span><span 
  class="button green"
  id="rating_p_5471"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5471/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5472">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/448/" target="_top">naranja</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_bronze.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5472/">#5472</a>(<script language="JavaScript">print_time(new Date("2008/01/27 00:17 GMT"));</script><noscript>2008/01/27 00:17 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/d/">
	  D
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  Tango を使いました。参考ページにある tango.sys.Process のサンプルコードがまさにこの問題の丁寧な答えなんですね。
	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://www.dsource.org/projects/tango/docs/current/tango.sys.Process.html">tango.sys.Process</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="n">tango</span>.<span class="n">io</span>.<span class="n">Stdout</span>;
<span class="k">import</span> <span class="n">tango</span>.<span class="n">sys</span>.<span class="n">Process</span>;

<span class="kt">void</span> <span class="n">main</span>(<span class="kt">char</span>[][] <span class="n">args</span>){
    <span class="k">auto</span> <span class="n">process</span> = <span class="k">new</span> <span class="n">Process</span>(<span class="n">args</span>[<span class="mi">1</span>]);
    <span class="n">process</span>.<span class="n">execute</span>();
    <span class="k">auto</span> <span class="n">result</span> = <span class="n">process</span>.<span class="n">wait</span>();
    <span class="n">Stdout</span>(<span class="s">&quot;------&gt;&quot;</span>).<span class="n">newline</span>;
    <span class="n">Stdout</span>.<span class="n">copy</span>(<span class="n">process</span>.<span class="n">stdout</span>).<span class="n">flush</span>;
    <span class="n">Stdout</span>(<span class="s">&quot;&lt;------&quot;</span>).<span class="n">newline</span>;
    <span class="n">Stdout</span>(<span class="s">&quot;return code: &quot;</span>)(<span class="n">result</span>.<span class="n">status</span>).<span class="n">newline</span>;
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5472/addtag/" class="addtag" id="addtag_5472">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/d/">
		D
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5472/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5472/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5472"
  >-</span><span
  class="button yellow"
  id="rating_z_5472"
  >0</span><span 
  class="button green"
  id="rating_p_5472"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5472/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5473">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/88/" target="_top">sumim</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5473/">#5473</a>(<script language="JavaScript">print_time(new Date("2008/01/27 02:30 GMT"));</script><noscript>2008/01/27 02:30 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/smalltalk/">
	  Smalltalk
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>Squeak Smalltalk で。</p>
<p>UNIX 向け（あるいは、動作の確認はしていませんが Windows 向け）仮想マシンを使用し、仮想イメージ（Smalltalk 実行環境）に対しては事前に OSProcess および CommandShell というパッケージによる機能拡張が必要です。</p>

	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://wiki.squeak.org/squeak/708">Squeak Swiki - OSProcess</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5</pre></td><td class="code"><div class="highlight"><pre>| proc |
proc := (CommandShell pipeline: &#39;date&#39;) last.
proc output.   &quot;=&gt; &#39;Sun Jan 27 11:19:39 JST 2008&#39; &quot;
proc processProxy exitStatus.   &quot;=&gt; 0 &quot;
proc processProxy pid   &quot;=&gt; 5708 &quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5473/addtag/" class="addtag" id="addtag_5473">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/CommandShell/">CommandShell</a>
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/OSProcess/">OSProcess</a>
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/Squeak_Smalltalk/">Squeak_Smalltalk</a>
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/Unix_VM/">Unix_VM</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/smalltalk/">
		Smalltalk
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5473/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5473/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5473"
  >-</span><span
  class="button yellow"
  id="rating_z_5473"
  >0</span><span 
  class="button green"
  id="rating_p_5473"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5473/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5488">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/343/" target="_top">matyr</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5488/">#5488</a>(<script language="JavaScript">print_time(new Date("2008/01/27 15:20 GMT"));</script><noscript>2008/01/27 15:20 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/javascript/">
	  JavaScript
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  WSHで。&nbsp;
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre><span class="c">// usage: cscript 127.js &quot;dir&quot;</span>
<span class="k">with</span><span class="p">(</span><span class="nx">WSH</span><span class="p">)</span> <span class="k">with</span><span class="p">(</span><span class="nx">createObject</span><span class="p">(</span><span class="s2">&quot;WScript.Shell&quot;</span><span class="p">).</span><span class="nx">exec</span><span class="p">(</span><span class="nx">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">))){</span>
  <span class="nx">echo</span><span class="p">(</span><span class="s1">&#39;pid: &#39;</span><span class="o">+</span> <span class="nx">processID</span><span class="p">);</span>
  <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">status</span><span class="p">)</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
  <span class="nx">echo</span><span class="p">(</span><span class="s1">&#39;exit code: &#39;</span><span class="o">+</span> <span class="nx">exitCode</span><span class="p">);</span>
  <span class="nx">echo</span><span class="p">(</span><span class="s1">&#39;stdout:&#39;</span><span class="p">);</span>
  <span class="k">with</span><span class="p">(</span><span class="nx">stdOut</span><span class="p">)</span> <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">atEndOfStream</span><span class="p">)</span> <span class="nx">echo</span><span class="p">(</span><span class="nx">readLine</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5488/addtag/" class="addtag" id="addtag_5488">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/WSH/">WSH</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/javascript/">
		JavaScript
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5488/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5488/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5488"
  >-</span><span
  class="button yellow"
  id="rating_z_5488"
  >0</span><span 
  class="button green"
  id="rating_p_5488"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5488/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5503">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5503/">#5503</a>(<script language="JavaScript">print_time(new Date("2008/01/28 02:17 GMT"));</script><noscript>2008/01/28 02:17 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/vbnet/">
	  VB.net
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>VBScript です。
実行環境：Windows 。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8
9</pre></td><td class="code"><div class="highlight"><pre><span class="k">Dim</span> <span class="n">WSH</span><span class="p">,</span> <span class="n">ExecObj</span>
<span class="k">Set</span> <span class="n">WSH</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">ExecObj</span> <span class="o">=</span> <span class="n">WSH</span><span class="p">.</span><span class="n">Exec</span><span class="p">(</span><span class="s">&quot;hostname&quot;</span><span class="p">)</span>
<span class="n">WScript</span><span class="p">.</span><span class="n">Echo</span> <span class="s">&quot;pid:&quot;</span> <span class="o">&amp;</span> <span class="n">ExecObj</span><span class="p">.</span><span class="n">processID</span>
<span class="n">WScript</span><span class="p">.</span><span class="n">Echo</span> <span class="s">&quot;stdout: &quot;</span> <span class="o">&amp;</span> <span class="n">ExecObj</span><span class="p">.</span><span class="n">StdOut</span><span class="p">.</span><span class="n">ReadAll</span>
<span class="n">WScript</span><span class="p">.</span><span class="n">Echo</span> <span class="s">&quot;exit: &quot;</span> <span class="o">&amp;</span> <span class="n">ExecObj</span><span class="p">.</span><span class="n">exitCode</span>
<span class="n">WScript</span><span class="p">.</span><span class="n">Quit</span><span class="p">(</span><span class="n">ExecObj</span><span class="p">.</span><span class="n">exitCode</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">ExecObj</span> <span class="o">=</span> <span class="k">Nothing</span>
<span class="k">Set</span> <span class="n">WSH</span> <span class="o">=</span> <span class="k">Nothing</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5503/addtag/" class="addtag" id="addtag_5503">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/vbnet/">
		VB.net
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5503/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5503/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5503"
  >-</span><span
  class="button yellow"
  id="rating_z_5503"
  >0</span><span 
  class="button green"
  id="rating_p_5503"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5503/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5535">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/658/" target="_top">Jlake</a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5535/">#5535</a>(<script language="JavaScript">print_time(new Date("2008/01/29 01:17 GMT"));</script><noscript>2008/01/29 01:17 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/php/">
	  PHP
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?</span>
<span class="nf">exec</span><span class="p">(</span><span class="s2">&quot;hostname; echo $$&quot;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$return_cd</span><span class="p">);</span>
<span class="nv">$pid</span> <span class="o">=</span> <span class="nf">array_pop</span><span class="p">(</span><span class="nv">$output</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;pid: </span><span class="si">$pid</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">output: &quot;</span><span class="o">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">return code: </span><span class="si">$return_cd</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5535/addtag/" class="addtag" id="addtag_5535">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/php/">
		PHP
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5535/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5535/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5535"
  >-</span><span
  class="button yellow"
  id="rating_z_5535"
  >0</span><span 
  class="button green"
  id="rating_p_5535"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5535/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5545">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/26/" target="_top">dankogai</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5545/">#5545</a>(<script language="JavaScript">print_time(new Date("2008/01/29 05:35 GMT"));</script><noscript>2008/01/29 05:35 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/perl/">
	  Perl
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
<p>詳しくは
</p>
<p> <a href="/web/20100617095718/http://search.cpan.org/perldoc?perlipc">perldoc perlipc</a>
</p>
<p>にて。
</p>
<p>Dan the Perl Monger
</p>



	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">@cmd</span> <span class="o">=</span> <span class="n">qw</span><span class="sr">/ps ux/</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$pid</span> <span class="o">=</span> <span class="nb">open</span> <span class="k">my</span> <span class="nv">$rfh</span><span class="p">,</span> <span class="s">&#39;-|&#39;</span>
  <span class="ow">or</span> <span class="nb">exec</span> <span class="nv">@cmd</span>              <span class="c1"># pid = 0</span>
  <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;can&#39;t exec:$!&quot;</span>    <span class="c1"># $! knows how it failed;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="k">my</span> <span class="nv">$line</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nv">$rfh</span><span class="o">&gt;</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">&quot;[$pid] $line&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">warn</span> <span class="s">&quot;exit status:$?&quot;</span><span class="p">;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5545/addtag/" class="addtag" id="addtag_5545">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/perl/">
		Perl
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5545/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5545/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5545"
  >-</span><span
  class="button yellow"
  id="rating_z_5545"
  >0</span><span 
  class="button green"
  id="rating_p_5545"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5545/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5612">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/674/" target="_top">ryugate</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5612/">#5612</a>(<script language="JavaScript">print_time(new Date("2008/02/01 02:47 GMT"));</script><noscript>2008/02/01 02:47 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/scala/">
	  Scala
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
<p>初投稿です (^o^)
</p>
<p>標準出力と標準エラー出力はすべてを読みきる必要があります。
   その際、それぞれの出力の読み取りおよび、コマンドの終了を待つ部分は
   Actor(スレッド)としておかなくてはいけません。
</p>
<p>ffmpegはヘルプ表示時も標準出力と標準エラー出力の両方に書き出してきます。
   終了コードを表示する部分ですが、場合によってこの例ではヘルプ出力の間にまぎれてしまうかもしれません。(^^;
</p>



	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://www.lingr.com/room/scala-ja">Scala-jp at Lingr</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></td><td class="code"><div class="highlight"><pre>import java.io._
import scala.actors._
import scala.actors.Actor._

object exec_test extends Application {
  //------------------------------------
  val cmdline = &quot;ffmpeg&quot;

  //------------------------------------
  val process = Runtime.getRuntime.exec(cmdline)
  val br  = new BufferedReader(new InputStreamReader(process.getInputStream))
  val ebr = new BufferedReader(new InputStreamReader(process.getErrorStream))

  //------------------------------------
  actor { printlines(br ){ line =&gt; println(line) } }
  actor { printlines(ebr){ line =&gt; println(line) } }
  actor { println(&quot;ExitValue=&quot; + process.waitFor) }

  //------------------------------------
  def printlines(br:BufferedReader)(f:String=&gt;Unit):Unit = printlines(br.readLine, br, f)
  def printlines(line:String, br:BufferedReader, f:String=&gt;Unit):Unit = line match {
    case null =&gt; ;
    case _ =&gt; 
      f(line)
      printlines(br.readLine, br, f)
  }
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5612/addtag/" class="addtag" id="addtag_5612">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/scala/">
		Scala
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5612/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5612/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5612"
  >-</span><span
  class="button yellow"
  id="rating_z_5612"
  >0</span><span 
  class="button green"
  id="rating_p_5612"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5612/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5630">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/218/" target="_top">susu</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5630/">#5630</a>(<script language="JavaScript">print_time(new Date("2008/02/02 03:29 GMT"));</script><noscript>2008/02/02 03:29 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/ocaml/">
	  OCaml
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>コマンドを実行するだけならSys.commandで。戻り値も得られます。
出力を利用する場合はopen_processがin,out,fullなどと色々用意されています。
終了値はclose_processの時に返ります。

  あと標準入力を開いたとき、read_lineのような一行入力モノは
'\n'を書き込んでflushするまで終わりません。
output_stringは文字列中に\nがないと改行されないので、少し注意が必要です。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="k">#</span><span class="n">load</span> <span class="s2">&quot;unix.cma&quot;</span><span class="k">;;</span>
<span class="kr">let</span> <span class="n">stdout_iter</span> <span class="n">f</span> <span class="n">cmd</span> <span class="k">=</span>
  <span class="kr">let</span> <span class="n">proc</span> <span class="k">=</span> <span class="n">Unix</span><span class="k">.</span><span class="n">open_process_in</span> <span class="n">cmd</span> <span class="kr">in</span>
  <span class="k">(</span><span class="kr">try</span> <span class="kr">while</span> <span class="kr">true</span> <span class="kr">do</span> <span class="n">f</span> <span class="k">(</span><span class="n">input_line</span> <span class="n">proc</span><span class="k">)</span> <span class="kr">done</span> <span class="kr">with</span> <span class="k">_</span> <span class="k">-&gt;</span> <span class="k">());</span>
  <span class="n">Unix</span><span class="k">.</span><span class="n">close_process_in</span> <span class="n">proc</span><span class="k">;;</span>

<span class="n">stdout_iter</span> <span class="k">(</span><span class="n">Printf</span><span class="k">.</span><span class="n">printf</span> <span class="s2">&quot;  &gt; %s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="k">)</span> <span class="s2">&quot;ps&quot;</span><span class="k">;;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5630/addtag/" class="addtag" id="addtag_5630">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/ocaml/">
		OCaml
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5630/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5630/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5630"
  >-</span><span
  class="button yellow"
  id="rating_z_5630"
  >0</span><span 
  class="button green"
  id="rating_p_5630"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5630/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5655">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/614/" target="_top">SumiTomohiko</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5655/">#5655</a>(<script language="JavaScript">print_time(new Date("2008/02/02 21:39 GMT"));</script><noscript>2008/02/02 21:39 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  標準出力の後に、終了ステータスが表示されます。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="nf">use</span> <span class="nv">gauche</span><span class="o">.</span><span class="nv">process</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">main</span> <span class="nv">argv</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">proc</span> <span class="p">(</span><span class="nf">run-process</span> <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;/bin/ls&quot;</span> <span class="s">&quot;-l&quot;</span><span class="p">)</span> <span class="nv">:output</span> <span class="nv">:pipe</span> <span class="nv">:error</span> <span class="nv">:pipe</span> <span class="nv">:wait</span> <span class="no">#t</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nf">port-&gt;string</span> <span class="p">(</span><span class="nf">process-output</span> <span class="nv">proc</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nf">port-&gt;string</span> <span class="p">(</span><span class="nf">process-error</span> <span class="nv">proc</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">display </span><span class="p">(</span><span class="nf">process-exit-status</span> <span class="nv">proc</span><span class="p">))))</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5655/addtag/" class="addtag" id="addtag_5655">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/gauche/">gauche</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5655/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5655/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5655"
  >-</span><span
  class="button yellow"
  id="rating_z_5655"
  >0</span><span 
  class="button green"
  id="rating_p_5655"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5655/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5898">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/481/" target="_top">mtsuyugu</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5898/">#5898</a>(<script language="JavaScript">print_time(new Date("2008/02/29 15:50 GMT"));</script><noscript>2008/02/29 15:50 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>FreeBSD 6 で作成しました。fork, pipe, dup2 を使って実現しています。実行するコマンドは date です。</p>

	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://www.ncad.co.jp/~komata/c-kouza3.htm">http://www.ncad.co.jp/~komata/c-kouza3.htm</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;sys/types.h&gt;</span>
<span class="cp">#include &lt;sys/wait.h&gt;</span>
<span class="cp">#include &lt;sys/time.h&gt;</span>
<span class="cp">#include &lt;sys/resource.h&gt;</span>
<span class="cp">#include &lt;unistd.h&gt;</span>
<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="cp">#define R (0)</span>
<span class="cp">#define W (1)</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span> <span class="kt">void</span> <span class="p">){</span>
   <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
   <span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
   <span class="n">ssize_t</span> <span class="n">read_size</span><span class="p">;</span>
   <span class="n">pid_t</span> <span class="n">pid</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">command</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;date&quot;</span><span class="p">;</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">pipe</span><span class="p">(</span><span class="n">pipe_c2p</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
      <span class="n">perror</span><span class="p">(</span><span class="s">&quot;pipe&quot;</span><span class="p">);</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">pid</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">){</span> <span class="c">/* fail to fork */</span>
      <span class="n">close</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">W</span><span class="p">]</span> <span class="p">);</span>
      <span class="n">close</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="p">);</span>
      <span class="n">perror</span><span class="p">(</span><span class="s">&quot;fork&quot;</span><span class="p">);</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">){</span> <span class="c">/* child process */</span>
      <span class="n">close</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="p">);</span>
      <span class="n">dup2</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">W</span><span class="p">],</span> <span class="mi">1</span> <span class="p">);</span>
      <span class="n">close</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">W</span><span class="p">]</span> <span class="p">);</span>
      <span class="n">execlp</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span> <span class="s">&quot;sh&quot;</span><span class="p">,</span> <span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">else</span><span class="p">{</span> <span class="c">/* parent process */</span>
      <span class="n">close</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">W</span><span class="p">]</span> <span class="p">);</span>
      <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">read_size</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">R</span><span class="p">],</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">){</span>
         <span class="n">buf</span><span class="p">[</span><span class="n">read_size</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
         <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="n">buf</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">read_size</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
         <span class="n">perror</span><span class="p">(</span><span class="s">&quot;read&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">close</span><span class="p">(</span> <span class="n">pipe_c2p</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="p">);</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">waitpid</span><span class="p">(</span> <span class="n">pid</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">status</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
         <span class="n">perror</span><span class="p">(</span><span class="s">&quot;waitpid&quot;</span><span class="p">);</span>
         <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">WIFEXITED</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">){</span>
         <span class="n">printf</span><span class="p">(</span><span class="s">&quot;child process exit with status %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">WEXITSTATUS</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5898/addtag/" class="addtag" id="addtag_5898">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5898/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5898/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5898"
  >-</span><span
  class="button yellow"
  id="rating_z_5898"
  >0</span><span 
  class="button green"
  id="rating_p_5898"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5898/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5917">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/744/" target="_top">howking</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5917/">#5917</a>(<script language="JavaScript">print_time(new Date("2008/03/01 22:00 GMT"));</script><noscript>2008/03/01 22:00 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/erlang/">
	  Erlang
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>os:cmdではリターンコード取得ができないので、けっこう面倒らしい。Pidをとるのはさらに面倒？

実行結果
$erl -noshell -run ext exec "echo hello" -s init stop
stdout: hello
exit_status: 0
</pre>
	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://easyerl.blogspot.com/2007/07/simple-command-execution.html">Simple command execution</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre>-module(ext).
-export([exec/1]).

exec([Cmd]) -&gt;
    Port = open_port({spawn, Cmd}, [binary,exit_status]),
    wait(Port).

wait(Port) -&gt;
    receive 
        {Port, {data, BinData}} -&gt;
            io:format(&quot;stdout: ~s&quot;, [BinData]),
            wait(Port);
        {Port, {exit_status, Status}} -&gt;
            io:format(&quot;exit_status: ~p~n&quot;, [Status])
    end.
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/5917/addtag/" class="addtag" id="addtag_5917">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/erlang/">
		Erlang
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5917/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/5917/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5917"
  >-</span><span
  class="button yellow"
  id="rating_z_5917"
  >0</span><span 
  class="button green"
  id="rating_p_5917"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/5917/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6045">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/766/" target="_top">syat</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6045/">#6045</a>(<script language="JavaScript">print_time(new Date("2008/03/22 15:32 GMT"));</script><noscript>2008/03/22 15:32 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/bash/">
	  Bash
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  やったー。bashがまだいない。<br/><br/>$./run.sh&nbsp;ps<br/>==実行結果==<br/>&nbsp;&nbsp;PID&nbsp;TTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIME&nbsp;CMD<br/>&nbsp;3102&nbsp;pts/1&nbsp;&nbsp;&nbsp;&nbsp;00:00:01&nbsp;bash<br/>25115&nbsp;pts/1&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;bash<br/>25116&nbsp;pts/1&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;ps<br/>==終了コード==<br/>0<br/>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td class="code"><div class="highlight"><pre><span class="c">#/bin/sh</span>
<span class="nv">$1</span> &gt; __OUT__ ; <span class="nb">echo</span> <span class="nv">$?</span> &gt; __RET__ &amp;

sleep 3
<span class="nb">echo</span> <span class="o">==</span>実行結果<span class="o">==</span>
cat __OUT__
<span class="nb">echo</span> <span class="o">==</span>終了コード<span class="o">==</span>
cat __RET__

rm __OUT__ __RET__
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6045/addtag/" class="addtag" id="addtag_6045">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/bash/">
		Bash
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/6045/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/6045/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6045"
  >-</span><span
  class="button yellow"
  id="rating_z_6045"
  >0</span><span 
  class="button green"
  id="rating_p_6045"
  >+</span></span></span>
  

<p>

  

  <a href="/web/20100617095718/http://ja.doukaku.org/comment/6045/">
    1
    reply
  </a>

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/6045/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6049">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/646/" target="_top">silverwire</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6049/">#6049</a>(<script language="JavaScript">print_time(new Date("2008/03/23 06:45 GMT"));</script><noscript>2008/03/23 06:45 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>カレントディレクトリに一時ファイルを作成しなくても、サブシェルを利用すればワンラ
イナーでいけますね。

  e.g.
    $ (ps); echo $?
       PID    PPID    PGID     WINPID  TTY  UID    STIME COMMAND
      2440       1    2440       2440  con 1004 15:00:47 /usr/bin/bash
      3404    2440    3404       3424  con 1004 15:35:47 /usr/bin/ps

    # 手元にCygwinしかなかったので、純粋なUnix環境で実行したとは言えませんが... 

コマンド文字列に複数のコマンドやパイプが含まれている場合はもう少し考えないといけ
ませんね。

# &gt; bashがまだいない。
# 数多の心優しく慎み深いUnix使い達は、敢えて誰かが解くのを静観していたのかも ;-)</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6049/addtag/" class="addtag" id="addtag_6049">タグ</a>:
	
	タグなし
	&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6049"
  >-</span><span
  class="button yellow"
  id="rating_z_6049"
  >0</span><span 
  class="button green"
  id="rating_p_6049"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6045/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6049/root/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20100617095718/http://ja.doukaku.org/comment/6049/">
    1
    reply
  </a>

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/6049/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6050">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/646/" target="_top">silverwire</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6050/">#6050</a>(<script language="JavaScript">print_time(new Date("2008/03/23 06:55 GMT"));</script><noscript>2008/03/23 06:55 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>子プロセスよりも、 #6045の回答のようにバックグラウンドプロセスの方がいいですね。

  e.g.
    $ (ps &amp;); echo $?
       PID    PPID    PGID     WINPID  TTY  UID    STIME COMMAND
      2440       1    2440       2440  con 1004 15:00:47 /usr/bin/bash
      3580       1    3588       3540  con 1004 15:45:47 /usr/bin/ps</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6050/addtag/" class="addtag" id="addtag_6050">タグ</a>:
	
	タグなし
	&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6050"
  >-</span><span
  class="button yellow"
  id="rating_z_6050"
  >0</span><span 
  class="button green"
  id="rating_p_6050"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6049/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6050/root/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20100617095718/http://ja.doukaku.org/comment/6050/">
    1
    reply
  </a>

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/6050/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6053">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/766/" target="_top">syat</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/">#6053</a>(<script language="JavaScript">print_time(new Date("2008/03/23 11:16 GMT"));</script><noscript>2008/03/23 11:16 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/bash/">
	  Bash
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  ふむふむ。サブシェルは使った経験なかったです。<br/>こんな感じでしょうか。ループで複数コマンドに対応してみました。パイプはご勘弁を。<br/><br/>$&nbsp;./run2.sh&nbsp;date&nbsp;true&nbsp;false<br/>=&nbsp;date&nbsp;=<br/>2008年&nbsp;3月&nbsp;23日&nbsp;日曜日&nbsp;20:14:49&nbsp;JST<br/>==&nbsp;終了コード：0&nbsp;==<br/>=&nbsp;true&nbsp;=<br/><br/>==&nbsp;終了コード：0&nbsp;==<br/>=&nbsp;false&nbsp;=<br/><br/>==&nbsp;終了コード：1&nbsp;==<br/>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre><span class="c">#/bin/sh</span>
<span class="k">for </span>program in <span class="nv">$*</span>
<span class="k">do</span>
<span class="k">    </span><span class="nv">stdout</span><span class="o">=</span><span class="s">`($program)`</span> ; <span class="nv">status</span><span class="o">=</span><span class="nv">$?</span>
    <span class="nb">echo</span> <span class="o">=</span> <span class="nv">$program</span> <span class="o">=</span>
    <span class="nb">echo</span> <span class="nv">$stdout</span>
    <span class="nb">echo</span> <span class="o">==</span> 終了コード：<span class="nv">$status</span> <span class="o">==</span>
<span class="k">done</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/addtag/" class="addtag" id="addtag_6053">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/bash/">
		Bash
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6053"
  >-</span><span
  class="button yellow"
  id="rating_z_6053"
  >0</span><span 
  class="button green"
  id="rating_p_6053"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6050/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/root/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/">
    1
    reply
  </a>

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/6053/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6056">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/646/" target="_top">silverwire</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6056/">#6056</a>(<script language="JavaScript">print_time(new Date("2008/03/23 14:23 GMT"));</script><noscript>2008/03/23 14:23 GMT</noscript>)
	
	
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>bashは環境変数PIPESTATUSがあるので、各コマンドの終了ステータスを参照できますが、
サブシェルと併用するとなると、ちょっとトリッキーな方法になるのかもしれません。

私はBourne Shellを使うので、以下のような関数を利用しています。

  e.g.
    tee_() {
      exec 3&gt;&amp;1
      __=`({ { $1 2&gt;&amp;1 3&gt;&amp;- 4&gt;&amp;-; echo $? 1&gt;&amp;4 3&gt;&amp;- 4&gt;&amp;-; } | tee -a $2 1&gt;&amp;3 2&gt;&amp;1 3&gt;&amp;- 4&gt;&amp;-; } 4&gt;&amp;1)`
      return $__
    }

    f() {
      env | grep -q '^LD_LIBRARY_PATH' &amp;&amp; return 0 || return 1
    }

    $ tee_ 'f' "f.log" || echo '環境変数 LD_LIBRARY_PATH は未定義です。'

第 1引数にコマンドを、第 2引数にファイル名を指定します。標準出力と標準エラー出力
の内容が画面とファイルに出力され、終了ステータスも参照できます。複数のコマンドを
実行する場合は、関数にまとめてから第 1引数に関数名を指定します。内部的にサブシェ
ルで実行しているので、お題の条件も満たしているかなと。

難点はコマンド文字列に引数を含められないこととSQL*Plusと相性が悪いことでしょうか。
特に後者は子プロセスから処理が戻って来ず、親プロセスがパイプ待ちとなってしまいま
す。straceで調べたりもしましたが、原因はわかりませんでした... orz</pre>
	</div>
	
	<p class="link">
	  参考: <a href="/web/20100617095718/http://x68000.q-e-d.net/~68user/unix/pickup?%A5%EA%A5%C0%A5%A4%A5%EC%A5%AF%A5%C8">UNIXの部屋 コマンド検索: リダイレクト</a>
	</p>  
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6056/addtag/" class="addtag" id="addtag_6056">タグ</a>:
	
	タグなし
	&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6056"
  >-</span><span
  class="button yellow"
  id="rating_z_6056"
  >0</span><span 
  class="button green"
  id="rating_p_6056"
  >+</span></span></span>
  

<p>

  
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6053/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20100617095718/http://ja.doukaku.org/comment/6056/root/"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/6056/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6596">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/793/" target="_top">genzou</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6596/">#6596</a>(<script language="JavaScript">print_time(new Date("2008/06/26 09:05 GMT"));</script><noscript>2008/06/26 09:05 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/groovy/">
	  Groovy
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>Stringのexecute()メソッドと
スレッド処理を組み合わせています。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre>def command = &quot;\&quot;C:\\Program Files\\Groovy\\Groovy-1.5.6\\bin\\groovy.exe\&quot; C:\\test4.groovy&quot;

new Thread({
    def process = command.execute()
    println process.text
} as Runnable).start()
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/6596/addtag/" class="addtag" id="addtag_6596">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/groovy/">groovy</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/groovy/">
		Groovy
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/6596/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/6596/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6596"
  >-</span><span
  class="button yellow"
  id="rating_z_6596"
  >0</span><span 
  class="button green"
  id="rating_p_6596"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/6596/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment8752">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/722/" target="_top">yyamasak</a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/8752/">#8752</a>(<script language="JavaScript">print_time(new Date("2009/03/30 10:29 GMT"));</script><noscript>2009/03/30 10:29 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/tcl/">
	  Tcl
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>使い方は
tclsh popen.tcl ipconfig /all</p>
<p>余計な改行が入る理由が分からない。。。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8
9</pre></td><td class="code"><div class="highlight"><pre># popen.tcl
if {[catch {open &quot;|$argv&quot;} ch]} {
    error $ch
} else {
    while {![eof $ch]} {
        gets $ch line
        puts -nonewline $line
    }
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/8752/addtag/" class="addtag" id="addtag_8752">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/popen/">popen</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/tcl/">
		Tcl
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/8752/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/8752/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8752"
  >-</span><span
  class="button yellow"
  id="rating_z_8752"
  >0</span><span 
  class="button green"
  id="rating_p_8752"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/8752/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment8757">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/646/" target="_top">silverwire</a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/star_silver.png" border=0/></a><a href="/web/20100617095718/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/8757/">#8757</a>(<script language="JavaScript">print_time(new Date("2009/03/30 19:45 GMT"));</script><noscript>2009/03/30 19:45 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/bat/">
	  Batchfile
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>バッチで外部コマンドを利用する場合は、自ずと別プロセスで実行
されます。なので、ビルトインコマンドを実行した場合でも別プロ
セスを生成してから実行するようにしました。実行結果と終了ステ
ータスは標準出力に出力します。

# コマンド文字列にリダイレクトやパイプといった特殊な文字が含
# まれる場合は、 ^(ハット)でエスケープする必要があります。

以下は、tasklistコマンドでコマンドを実行する前と実行した後の
差分を並べたものです。

  e.g.
    実行前
      イメージ名                     PID
      ========================= ========
      (中略)
      cmd.exe                       2776
      cmd.exe                       3236
      tasklist.exe                  3308
      wmiprvse.exe                  3336
    
    実行後
      イメージ名                     PID
      ========================= ========
      (中略)
      cmd.exe                       2776
      cmd.exe                       3236
      wmiprvse.exe                  3336
      cmd.exe                       3368 ← 別プロセスで実行
      tasklist.exe                  3376

Windows XPで動作を確認しました。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></td><td class="code"><div class="highlight"><pre>@echo off
setlocal
  set c=%~1
  set f=%~fs0.%RANDOM%
  set ?=0
  
  if &quot;%c%&quot; == &quot;&quot; (echo usage: %~n0 COMMAND) &amp; exit /b 1
  
  cmd /c &quot;%c%&quot; &gt; %f% 2&gt;&amp;1
  set ?=%ERRORLEVEL%
  
  echo.
  echo 実行結果
  type %f%
  echo.
  echo 終了ステータスは %?% です。
  
  del %f%
endlocal &amp; exit /b 0
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/8757/addtag/" class="addtag" id="addtag_8757">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/bat/">
		Batchfile
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/8757/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/8757/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8757"
  >-</span><span
  class="button yellow"
  id="rating_z_8757"
  >0</span><span 
  class="button green"
  id="rating_p_8757"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/8757/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment8800">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/943/" target="_top">pa</a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/8800/">#8800</a>(<script language="JavaScript">print_time(new Date("2009/04/11 10:28 GMT"));</script><noscript>2009/04/11 10:28 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>LimboではC言語(POSIX)と似たパイプの使い方ができるようです。
ただし、closeがないのでパイプのクローズには
工夫がいるようです。

下記コードはパイプのクローズの方法に悩み
試行錯誤した結果ですので誤りがあるかもしれませんがご容赦ください。

コマンドライン引数を指定コマンドとして、
子プロセスに渡しています。
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></td><td class="code"><div class="highlight"><pre>implement d127;

include &quot;sys.m&quot;;
sys: Sys;
include &quot;draw.m&quot;;
include &quot;sh.m&quot;;
sh: Sh;

d127: module{
    init: fn(ctx: ref Draw-&gt;Context, argv: list of string);
};

init (ctx: ref Draw-&gt;Context, argv: list of string)
{
    sys = load Sys Sys-&gt;PATH;
    sh = load Sh Sh-&gt;PATH;
    buf := array[64] of byte;
    fds := array[2] of ref Sys-&gt;FD;

    argv = tl argv;
    if(argv == nil){
           return;
    }
    cmd := hd argv;

    sys-&gt;pipe(fds); # open pipes
    spawn child(ctx, fds[0], cmd);

    # Read results of child process
    n: int;
    fds[0] = nil;
    fdd := sys-&gt;open(&quot;/dev/cons&quot;, sys-&gt;OWRITE);
    for(;;){
        n = sys-&gt;read(fds[1], buf, len buf);
        if(n == 0){
             break;
        }

        # print result
        sys-&gt;fprint(fdd, &quot;%s&quot;, string buf[0:n]);
    }
}

child (ctx: ref Draw-&gt;Context, fd: ref Sys-&gt;FD, cmd: string)
{
    # duplicate stdout to the pipe
    sys-&gt;dup(fd.fd, 1);

    sh-&gt;system(ctx, cmd);

    # pipe close
    fdn := sys-&gt;open(&quot;/dev/null&quot;, sys-&gt;OWRITE);
    sys-&gt;dup(fdn.fd, 1);
    fd = nil;
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/8800/addtag/" class="addtag" id="addtag_8800">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/Limbo/">Limbo</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/8800/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/8800/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8800"
  >-</span><span
  class="button yellow"
  id="rating_z_8800"
  >0</span><span 
  class="button green"
  id="rating_p_8800"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/8800/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment9789">
  <p class="banner"><a href="/web/20100617095718/http://ja.doukaku.org/user/1130/" target="_top">t2ru</a>

	
	&nbsp;
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/9789/">#9789</a>(<script language="JavaScript">print_time(new Date("2010/01/04 08:30 GMT"));</script><noscript>2010/01/04 08:30 GMT</noscript>)
	
	
	
	[<a href="/web/20100617095718/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>clojure-contribパッケージを使うと、1行です。
下記のようなmapが帰って来ます。
{:exit 0, :out ".\n..\ndoukaku.clj\n", :err ""}</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2</pre></td><td class="code"><div class="highlight"><pre>(use &#39;clojure.contrib.shell-out)
(sh &quot;ls&quot; &quot;-a&quot; &quot;src&quot; :return-map true)
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20100617095718/http://ja.doukaku.org/comment/9789/addtag/" class="addtag" id="addtag_9789">タグ</a>:
	
    
    <a href="/web/20100617095718/http://ja.doukaku.org/tag/Clojure/">Clojure</a>
    
	&nbsp;

	
      [<a href="/web/20100617095718/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20100617095718/http://ja.doukaku.org/comment/9789/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20100617095718/http://ja.doukaku.org/comment/9789/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_9789"
  >-</span><span
  class="button yellow"
  id="rating_z_9789"
  >0</span><span 
  class="button green"
  id="rating_p_9789"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20100617095718/http://ja.doukaku.org/127/reply_to/9789/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>







</div>

<div id="side_menu" class="compact">

<iframe src="/web/20100617095718if_/http://ja.doukaku.org/login_info/" frameborder=0 width=100% id="login_info">
iframe required
</iframe>

<h4 class="semi_compact">一覧</h4>

<ul>
<!--<li><a href="/web/20100617095718/http://ja.doukaku.org/user/">ユーザ</a>-->
<li><a href="/web/20100617095718/http://ja.doukaku.org/lang/">言語</a>
<li><a href="/web/20100617095718/http://ja.doukaku.org/challenge/">お題</a>
<li><a href="/web/20100617095718/http://ja.doukaku.org/topic/">トピック</a>
<li><a href="/web/20100617095718/http://ja.doukaku.org/comment/">投稿</a>
<li><a href="/web/20100617095718/http://ja.doukaku.org/good_comments/">評価の高い投稿</a>
<li><a href="/web/20100617095718/http://ja.doukaku.org/tag/">タグ</a>
</ul>

<h4 class="compact">フィード</h4>
<ul>
<li><a href="/web/20100617095718/http://ja.doukaku.org/feeds/challenges/">最新のお題</a><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20100617095718/http://ja.doukaku.org/feeds/topics/">最新のトピック</a><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20100617095718/http://ja.doukaku.org/feeds/comments/">新着投稿</a><img src="/web/20100617095718im_/http://ja.doukaku.org/static/image/feed_icon.png">
</ul>







<h4 class="compact">その他</h4>
<ul>
<li><a href="/web/20100617095718/http://ja.doukaku.org/qa/">Q&A</a>
<li><a href="/web/20100617095718/http://ja.doukaku.org/feedback/">フィードバック</a>
<!--<li><a href="/web/20100617095718/http://ja.doukaku.org/terms">用語集</a>-->
</ul>


<h4 class="compact">リンク</h4>
<ul>
<li><a href="/web/20100617095718/http://www.lingr.com/room/doukaku_ja">チャットルーム(Lingr)</a>
<li><a href="/web/20100617095718/http://labs.cybozu.co.jp/">サイボウズ・ラボ</a>
<li><a href="/web/20100617095718/http://www.djangoproject.com/">Django</a>
</ul>

<h4 id="pathtraq" class="compact"><a href="/web/20100617095718/http://pathtraq.com/analytics?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&m=popular">Pathtraq</a></h4>
<div class="indent">
<span id="pathtraq_sentinel">loading...</span>
</div>


</div>
</div>


<div id="page_foot" class="bordered">

<a rel="license" href="/web/20100617095718/http://creativecommons.org/licenses/by/2.1/jp/">
<img alt="Creative Commons License" style="border-width:0" src="/web/20100617095718im_/http://i.creativecommons.org/l/by/2.1/jp/88x31.png" /></a>
このサイトの内容は、
<a rel="license" href="/web/20100617095718/http://creativecommons.org/licenses/by/2.1/jp/">クリエイティブ・コモンズ・ライセンス</a>の下でライセンスされています。
<a href="/web/20100617095718/http://ja.doukaku.org/qa/#licence">[詳細]</a>

</div>

</body>




<script type="text/javascript">
$(document).ready(function(){$("#doukaku_org").after("<script src='/web/20100617095718/http://api.pathtraq.com/pages?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&api=json&callback=addPathtraq'><" + "/script>")});
</script>

<script src="/web/20100617095718js_/http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2136157-1";
urchinTracker();
</script>




</html>





<!--
     FILE ARCHIVED ON 9:57:18 Jun 17, 2010 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:18:54 Nov 16, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
