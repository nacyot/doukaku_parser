
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> 
  <head>

<script type="text/javascript" src="/static/js/analytics.js" ></script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>




    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
    <title>
ファイル更新の監視
どう書く？org </title>

    <link rel="stylesheet" type="text/css"
	href="/web/20101226213933cs_/http://ja.doukaku.org/static/style/reset-fonts-grids.css" />
    <link rel="stylesheet" type="text/css"
	href="/web/20101226213933cs_/http://ja.doukaku.org/static/style/style.css" />
	
    <link rel="stylesheet" type="text/css"
	href="/web/20101226213933cs_/http://ja.doukaku.org/static/style/pygments.css" />


	
<meta name="robots" content="noindex,nofollow">

    <!--<script src="/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->


<script src="/web/20101226213933js_/http://ja.doukaku.org/static/js/jquery-1.1.3.1.js" type="text/javascript"></script>
<script src="/web/20101226213933js_/http://ja.doukaku.org/static/js/rating.js" type="text/javascript"></script>
<script src="/web/20101226213933js_/http://ja.doukaku.org/static/js/addtag.js" type="text/javascript"></script>

<script type="text/javascript">
is_key_navigation_enable = true;
</script>
<script src="/web/20101226213933js_/http://ja.doukaku.org/static/js/utils.js" type="text/javascript"></script>

</head>


<body id="doukaku_org">
<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script> if (window.archive_analytics) { window.archive_analytics.values['server_name']="wwwb-app10.us.archive.org";}; </script>

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/ja.doukaku.org\/15\/flatten\/";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "26";
var displayMonth = "Dec";
var displayYear = "2010";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" lang="en" class="__wb_banner_div" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px">


<div id="wm-ipp-inside" class="__wb_banner_div" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://ja.doukaku.org/15/flatten/" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20101226213933" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;width: inherit !important" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20100315220721/http://ja.doukaku.org/15/flatten/" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="15 Mar 2010"><strong>MAR</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 21:39:33 Dec 26, 2010">DEC</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Jan
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20100315220721/http://ja.doukaku.org/15/flatten/" title="22:07:21 Mar 15, 2010" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 21:39:33 Dec 26, 2010">26</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20090422062354/http://ja.doukaku.org/15/flatten/" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="22 Apr 2009"><strong>2009</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 21:39:33 Dec 26, 2010">2010</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2011
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20101226213933*/http://ja.doukaku.org/15/flatten/" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>5 captures</strong></a>
           <div class="__wb_banner_div" style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">13 May 07 - 26 Dec 10</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div class="__wb_banner_div" id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000010000000_2008:-1:000000000010_2009:-1:000100000000_2010:11:001000000001_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->


<div id="page_head" class="compact">
  <h1 class="compact">
    <a href="/web/20101226213933/http://ja.doukaku.org/">どう書く？org</a><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/beta.png" alt="beta">
  </h1>
</div>

<div id="page_body" class="compact">
<div id="content" class="compact">




<h2 class="compact">
<img src='/web/20101226213933im_/http://ja.doukaku.org/static/image/star_gold.png' alt=challenge>
<a href="/web/20101226213933/http://ja.doukaku.org/15/">ファイル更新の監視</a>
</h2>

    




<div class="comment" id="comment3371"><!--dj-->
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/1/" target="_top">にしお</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3371/">#3371</a>(<script language="JavaScript">print_time(new Date("2007/07/09 09:21 GMT"));</script><noscript>2007/07/09 09:21 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>

  <div class="comment_content" >
	<div class="comment_body">
	  あるファイル名がfilenameという変数に入っているとします。
このファイルが更新されるたびに"modified!"と表示するプログラムを作ってください。
<p>
もしOSに依存する場合はそのOS名のタグを、
依存しない場合は「OS非依存」というタグをつけてください。
わからなければつけなくても構いません。
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3371/addtag/" class="addtag" id="addtag_3371">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_3371"
  >-</span><span
  class="button yellow"
  id="rating_z_3371"
  >0</span><span 
  class="button green"
  id="rating_p_3371"
  >+</span></span></span>
  
<p>

  

  

  [<a href="/web/20101226213933/http://reply_to/3371/">
  返信
  </a>]
  </div>
</div>
</div>



  



<div class="indent">
<a href="/web/20101226213933/http://ja.doukaku.org/15/post_comment/">
コメントを投稿する
</a>
</div>


<h2>投稿されたコメント - フラット表示</h2>
<a href="/web/20101226213933/http://ja.doukaku.org/15/nested/">ネスト表示</a>
<a href="/web/20101226213933/http://ja.doukaku.org/15/">非表示</a> 


  
  




<div class="comment" id="comment394">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/394/">#394</a>(<script language="JavaScript">print_time(new Date("2007/07/09 12:55 GMT"));</script><noscript>2007/07/09 12:55 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/java/">
	  Java
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  ファイルの存在チェックとタイムスタンプのチェックのみを１秒周期で行っています。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">java.io.File</span><span class="o">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Sample</span> <span class="o">{</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;./check&quot;</span><span class="o">;</span>
    <span class="k">static</span> <span class="k">final</span> <span class="kt">long</span> <span class="n">INTERVAL</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span> <span class="c">// 1 sec</span>
    <span class="k">static</span> <span class="k">final</span> <span class="n">String</span> <span class="n">MESSAGE</span> <span class="o">=</span> <span class="s">&quot;modified!&quot;</span><span class="o">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="k">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
        <span class="n">File</span> <span class="n">checkFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">filename</span><span class="o">);</span>
        <span class="kt">long</span> <span class="n">lastModified</span> <span class="o">=</span> <span class="n">checkFile</span><span class="o">.</span><span class="na">lastModified</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">INTERVAL</span><span class="o">);</span>
            <span class="kt">long</span> <span class="n">lm2</span> <span class="o">=</span> <span class="n">checkFile</span><span class="o">.</span><span class="na">lastModified</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">lastModified</span> <span class="o">!=</span> <span class="n">lm2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">MESSAGE</span><span class="o">);</span>
                <span class="n">lastModified</span> <span class="o">=</span> <span class="n">lm2</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/394/addtag/" class="addtag" id="addtag_394">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/java/">
		Java
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/394/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/394/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_394"
  >-</span><span
  class="button yellow"
  id="rating_z_394"
  >0</span><span 
  class="button green"
  id="rating_p_394"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/394/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6587">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/793/" target="_top">genzou</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6587/">#6587</a>(<script language="JavaScript">print_time(new Date("2008/06/25 06:04 GMT"));</script><noscript>2008/06/25 06:04 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/groovy/">
	  Groovy
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #dfffdf;">2/2=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>一秒ごとにファイルの更新日時をチェックしています。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></td><td class="code"><div class="highlight"><pre>def filename = &quot;c:/test.txt&quot;

def file = new File(filename)
def lastModified = file.lastModified()
while(true){
    if( lastModified != file.lastModified() ){
        println &quot;modified! : OS非依存 : ${file.lastModified()}&quot;
        lastModified = file.lastModified()
    }
    Thread.sleep(1000)
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6587/addtag/" class="addtag" id="addtag_6587">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/groovy/">
		Groovy
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6587/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6587/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #dfffdf;"
  >2/2=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6587"
  >-</span><span
  class="button yellow"
  id="rating_z_6587"
  >0</span><span 
  class="button green"
  id="rating_p_6587"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/6587/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment461">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/177/" target="_top">ocean</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/461/">#461</a>(<script language="JavaScript">print_time(new Date("2007/07/10 09:55 GMT"));</script><noscript>2007/07/10 09:55 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  短い間隔で続けざまに変更すると、modified!が一度しか表示されないことがあるので、題意を満たしてないかも。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;a.txt&quot;</span>

<span class="k">def</span> <span class="nf">get_mtime</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span>

<span class="n">mtime</span> <span class="o">=</span> <span class="n">get_mtime</span><span class="p">()</span>
<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">new_mtime</span> <span class="o">=</span> <span class="n">get_mtime</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">mtime</span> <span class="o">!=</span> <span class="n">new_mtime</span><span class="p">:</span>
        <span class="n">mtime</span> <span class="o">=</span> <span class="n">new_mtime</span>
        <span class="k">print</span> <span class="s">&quot;modified!&quot;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/461/addtag/" class="addtag" id="addtag_461">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/461/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/461/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_461"
  >-</span><span
  class="button yellow"
  id="rating_z_461"
  >0</span><span 
  class="button green"
  id="rating_p_461"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/461/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment1851">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1851/">#1851</a>(<script language="JavaScript">print_time(new Date("2007/08/05 01:28 GMT"));</script><noscript>2007/08/05 01:28 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/java/">
	  Java
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  Timer と TimerTask を使ってみました。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">java.util.TimerTask</span><span class="o">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">FileCheck</span> <span class="k">extends</span> <span class="n">TimerTask</span> <span class="o">{</span>

	<span class="k">private</span> <span class="n">File</span> <span class="n">targetFile</span><span class="o">;</span>
	<span class="k">private</span> <span class="kt">long</span> <span class="n">lastModify</span><span class="o">;</span>

	<span class="k">public</span> <span class="n">FileCheck</span><span class="o">(</span><span class="n">String</span> <span class="n">filename</span><span class="o">){</span>
		<span class="k">if</span><span class="o">(</span><span class="n">filename</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">();</span>
		<span class="n">targetFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">filename</span><span class="o">);</span>
		<span class="n">lastModify</span> <span class="o">=</span> <span class="n">targetFile</span><span class="o">.</span><span class="na">lastModified</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="k">public</span> <span class="kt">void</span> <span class="n">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="kt">long</span> <span class="n">modify</span> <span class="o">=</span> <span class="n">targetFile</span><span class="o">.</span><span class="na">lastModified</span><span class="o">();</span>
		<span class="k">if</span><span class="o">(</span><span class="n">modify</span> <span class="o">!=</span> <span class="n">lastModify</span><span class="o">)</span>
			<span class="n">doModifiedAction</span><span class="o">();</span>
		<span class="n">lastModify</span> <span class="o">=</span> <span class="n">modify</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="k">protected</span> <span class="kt">void</span> <span class="n">doModifiedAction</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;modified!&quot;</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>


<span class="k">import</span> <span class="nn">java.util.Timer</span><span class="o">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">FileChekMain</span> <span class="o">{</span>
	<span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

		<span class="n">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;./bin/aaa.txt&quot;</span><span class="o">;</span>

		<span class="n">Timer</span> <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Timer</span><span class="o">();</span>
		<span class="n">timer</span><span class="o">.</span><span class="na">schedule</span><span class="o">(</span><span class="k">new</span> <span class="n">FileCheck</span><span class="o">(</span><span class="n">filename</span><span class="o">),</span> <span class="mi">1000L</span><span class="o">,</span><span class="mi">1000L</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1851/addtag/" class="addtag" id="addtag_1851">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/java/">
		Java
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1851/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1851/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_1851"
  >-</span><span
  class="button yellow"
  id="rating_z_1851"
  >0</span><span 
  class="button green"
  id="rating_p_1851"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/1851/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6272">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/164/" target="_top">kozima</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6272/">#6272</a>(<script language="JavaScript">print_time(new Date("2008/05/08 14:31 GMT"));</script><noscript>2008/05/08 14:31 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/ocaml/">
	  OCaml
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>処理順に依存しないようにしてみました。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="kr">let</span> <span class="n">monitor</span> <span class="n">path</span> <span class="n">sec</span> <span class="k">=</span>
  <span class="kr">let</span> <span class="kr">rec</span> <span class="n">loop</span> <span class="n">stat</span> <span class="k">=</span>
    <span class="n">Unix</span><span class="k">.</span><span class="n">sleep</span> <span class="n">sec</span><span class="k">;</span>
    <span class="kr">let</span> <span class="n">next_stat</span> <span class="k">=</span> <span class="n">Unix</span><span class="k">.</span><span class="n">stat</span> <span class="n">path</span> <span class="kr">in</span>
      <span class="kr">if</span> <span class="n">stat</span> <span class="k">&lt;&gt;</span> <span class="n">next_stat</span> <span class="kr">then</span> <span class="n">print_endline</span> <span class="s2">&quot;modified!&quot;</span><span class="k">;</span>
      <span class="n">loop</span> <span class="n">next_stat</span>
  <span class="kr">in</span> <span class="n">loop</span> <span class="k">(</span><span class="n">Unix</span><span class="k">.</span><span class="n">stat</span> <span class="n">path</span><span class="k">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6272/addtag/" class="addtag" id="addtag_6272">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/ocaml/">
		OCaml
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6272/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6272/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6272"
  >-</span><span
  class="button yellow"
  id="rating_z_6272"
  >0</span><span 
  class="button green"
  id="rating_p_6272"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/6271/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/6272/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/6272/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6271">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/218/" target="_top">susu</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6271/">#6271</a>(<script language="JavaScript">print_time(new Date("2008/05/08 08:35 GMT"));</script><noscript>2008/05/08 08:35 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/ocaml/">
	  OCaml
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  こちらも処理順依存です。<br/>ocamlが左から評価するようになったら、sleepは右のstat前にいります。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="c">(*ocaml unix.cma doukaku15.ml*)</span>
<span class="kr">let</span> <span class="n">monitor</span> <span class="n">path</span> <span class="n">sec</span> <span class="k">=</span>
  <span class="kr">while</span> <span class="kr">true</span> <span class="kr">do</span>
    <span class="kr">if</span> <span class="k">(</span><span class="n">Unix</span><span class="k">.</span><span class="n">sleep</span> <span class="n">sec</span><span class="k">;</span> <span class="n">Unix</span><span class="k">.</span><span class="n">stat</span> <span class="n">path</span><span class="k">)</span> <span class="k">&lt;&gt;</span> <span class="n">Unix</span><span class="k">.</span><span class="n">stat</span> <span class="n">path</span>
    <span class="kr">then</span> <span class="n">print_endline</span> <span class="s2">&quot;modified!&quot;</span>
  <span class="kr">done</span>
<span class="kr">in</span> <span class="n">monitor</span> <span class="s2">&quot;a.txt&quot;</span> <span class="mi">2</span><span class="k">;;</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6271/addtag/" class="addtag" id="addtag_6271">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/ocaml/">
		OCaml
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6271/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6271/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6271"
  >-</span><span
  class="button yellow"
  id="rating_z_6271"
  >0</span><span 
  class="button green"
  id="rating_p_6271"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/6271/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/6271/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment392">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/64/" target="_top">zigorou</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/392/">#392</a>(<script language="JavaScript">print_time(new Date("2007/07/09 12:11 GMT"));</script><noscript>2007/07/09 12:11 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/perl/">
	  Perl
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  $ perl watch.pl /path/to/file 3

なら3秒おきに監視みたいな感じ。
モジュール使うと反則かな？w
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></td><td class="code"><div class="highlight"><pre><span class="c1">#!/usr/bin/perl</span>

<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">Carp::</span><span class="n">Clan</span> <span class="sx">qw(croak)</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">File::</span><span class="n">Monitor</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="nb">shift</span> <span class="nv">@ARGV</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$duration</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">shift</span> <span class="nv">@ARGV</span> <span class="o">||</span> <span class="mi">5</span><span class="p">);</span>

<span class="n">croak</span> <span class="n">qq</span><span class="o">|</span><span class="n">No</span> <span class="n">such</span> <span class="n">file</span><span class="o">.</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">)</span><span class="o">|</span> <span class="k">unless</span> <span class="p">(</span><span class="o">-</span><span class="n">e</span> <span class="nv">$filename</span><span class="p">);</span>
<span class="n">croak</span> <span class="n">qq</span><span class="o">|</span><span class="n">Invalid</span> <span class="n">duration</span><span class="o">|</span> <span class="k">unless</span> <span class="p">(</span><span class="nv">$duration</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">my</span> <span class="nv">$monitor</span> <span class="o">=</span> <span class="nn">File::</span><span class="n">Monitor</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>
<span class="nv">$monitor</span><span class="o">-&gt;</span><span class="n">watch</span><span class="p">(</span>
    <span class="nv">$filename</span><span class="p">,</span> 
    <span class="k">sub </span><span class="p">{</span>
        <span class="k">my</span> <span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$event</span><span class="p">,</span> <span class="nv">$change</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$change</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">print</span> <span class="s">&quot;modified\n&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">);</span>

<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$monitor</span><span class="o">-&gt;</span><span class="n">scan</span><span class="p">;</span>
    <span class="nb">sleep</span> <span class="nv">$duration</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/392/addtag/" class="addtag" id="addtag_392">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/perl/">
		Perl
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/392/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/392/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_392"
  >-</span><span
  class="button yellow"
  id="rating_z_392"
  >0</span><span 
  class="button green"
  id="rating_p_392"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/392/">
    2
    replies
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/392/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment6284">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/468/" target="_top">だいら</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6284/">#6284</a>(<script language="JavaScript">print_time(new Date("2008/05/14 01:10 GMT"));</script><noscript>2008/05/14 01:10 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/php/">
	  PHP
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'></pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$filename</span> <span class="o">=</span> <span class="s2">&quot;testfile.txt&quot;</span><span class="p">;</span>
<span class="nv">$sleepTime</span> <span class="o">=</span> <span class="m">1</span><span class="p">;</span> <span class="c">//micro seconds</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$modifiedTimeOld</span> <span class="o">=</span> <span class="nx">get_file_modified_time</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">exit</span><span class="p">(</span><span class="s2">&quot;File not found.&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">clearstatcache</span><span class="p">();</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$modifiedTimeNew</span> <span class="o">=</span> <span class="nx">get_file_modified_time</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)))</span> <span class="p">{</span>
        <span class="k">exit</span><span class="p">(</span><span class="s2">&quot;File not found.&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$modifiedTimeOld</span> <span class="o">!=</span> <span class="nv">$modifiedTimeNew</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;modified!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$modifiedTimeOld</span> <span class="o">=</span> <span class="nv">$modifiedTimeNew</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nf">usleep</span><span class="p">(</span><span class="nv">$sleepTime</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">get_file_modified_time</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">check_file_exist</span><span class="p">(</span><span class="nv">$filename</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">filemtime</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">check_file_exist</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nf">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nf">is_file</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/6284/addtag/" class="addtag" id="addtag_6284">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/php/">
		PHP
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6284/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/6284/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_6284"
  >-</span><span
  class="button yellow"
  id="rating_z_6284"
  >0</span><span 
  class="button green"
  id="rating_p_6284"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/6284/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment3685">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3685/">#3685</a>(<script language="JavaScript">print_time(new Date("2007/11/03 02:28 GMT"));</script><noscript>2007/11/03 02:28 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>kansi.txt　は　わざとですよね？</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3685/addtag/" class="addtag" id="addtag_3685">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_3685"
  >-</span><span
  class="button yellow"
  id="rating_z_3685"
  >0</span><span 
  class="button green"
  id="rating_p_3685"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/3685/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/3685/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment390">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/172/" target="_top">cats</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/390/">#390</a>(<script language="JavaScript">print_time(new Date("2007/07/09 11:41 GMT"));</script><noscript>2007/07/09 11:41 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/csharp/">
	  C#
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></td><td class="code"><div class="highlight"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Program</span>
<span class="k">{</span>
  <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
  <span class="k">{</span>
    <span class="kt">string</span> <span class="n">filename</span> <span class="p">=</span> <span class="s">@&quot;c:\test.txt&quot;</span><span class="p">;</span>
    <span class="n">FileSystemWatcher</span> <span class="n">fsw</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileSystemWatcher</span><span class="p">(</span>
      <span class="n">Path</span><span class="p">.</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span>
      <span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">filename</span><span class="p">));</span>
    <span class="n">fsw</span><span class="p">.</span><span class="n">Changed</span> <span class="p">+=</span> <span class="k">delegate</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FileSystemEventArgs</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;modified!&quot;</span><span class="p">);</span>
    <span class="k">}</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
      <span class="n">fsw</span><span class="p">.</span><span class="n">WaitForChanged</span><span class="p">(</span><span class="n">WatcherChangeTypes</span><span class="p">.</span><span class="n">All</span><span class="p">);</span>
  <span class="k">}</span>
<span class="k">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/390/addtag/" class="addtag" id="addtag_390">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/csharp/">
		C#
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/390/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/390/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_390"
  >-</span><span
  class="button yellow"
  id="rating_z_390"
  >0</span><span 
  class="button green"
  id="rating_p_390"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/390/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment419">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/35/" target="_top">ytakenaka</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/419/">#419</a>(<script language="JavaScript">print_time(new Date("2007/07/10 02:48 GMT"));</script><noscript>2007/07/10 02:48 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/commonlisp/">
	  Common Lisp
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  (modify-checher ファイル名) で使えます。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre>(defun modify-checher (filename)
  (let ((last-update nil))
    (labels ((checher (stream)
               (let ((present (file-write-date stream)))
                 (unless (equal last-update present)
                   (print &quot;modified!&quot;)
                   (setf last-update present)))))
      (with-open-file (stream filename :direction :input)
        (setf last-update (file-write-date stream))
        (loop do
             (sleep 5)
             (checher stream))))))
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/419/addtag/" class="addtag" id="addtag_419">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/commonlisp/">
		Common Lisp
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/419/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/419/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_419"
  >-</span><span
  class="button yellow"
  id="rating_z_419"
  >0</span><span 
  class="button green"
  id="rating_p_419"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/419/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/419/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment387">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/170/" target="_top">anekos</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/387/">#387</a>(<script language="JavaScript">print_time(new Date("2007/07/09 11:07 GMT"));</script><noscript>2007/07/09 11:07 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre><span class="n">last_mtime</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">mtime</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="kp">loop</span> <span class="k">do</span>
  <span class="k">unless</span> <span class="p">(</span><span class="n">mtime</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">mtime</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span> <span class="o">==</span> <span class="n">last_mtime</span>
    <span class="nb">puts</span> <span class="s2">&quot;modified!&quot;</span> 
    <span class="n">last_mtime</span> <span class="o">=</span> <span class="n">mtime</span>
  <span class="k">end</span>
  <span class="nb">sleep</span><span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/387/addtag/" class="addtag" id="addtag_387">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/387/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/387/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_387"
  >-</span><span
  class="button yellow"
  id="rating_z_387"
  >0</span><span 
  class="button green"
  id="rating_p_387"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/387/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment3192">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/98/" target="_top">nobsun</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3192/">#3192</a>(<script language="JavaScript">print_time(new Date("2007/09/28 13:45 GMT"));</script><noscript>2007/09/28 13:45 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>OS非依存、GHC依存(threadDelay)
チェックは1秒毎</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></td><td class="code"><div class="highlight"><pre><span class="kr">module</span> <span class="n">Main</span> <span class="p">(</span><span class="nv">main</span><span class="p">)</span> <span class="kr">where</span>

<span class="kr">import</span> <span class="n">Control</span><span class="o">.</span><span class="n">Monad</span> <span class="p">(</span><span class="nv">when</span><span class="p">)</span>
<span class="kr">import</span> <span class="n">Control</span><span class="o">.</span><span class="n">Concurrent</span> <span class="p">(</span><span class="nv">threadDelay</span><span class="p">)</span>
<span class="kr">import</span> <span class="n">Data</span><span class="o">.</span><span class="n">Maybe</span> <span class="p">(</span><span class="nv">maybe</span><span class="p">,</span> <span class="nv">listToMaybe</span><span class="p">)</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Directory</span> <span class="p">(</span><span class="nv">getModificationTime</span><span class="p">)</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Environment</span> <span class="p">(</span><span class="nv">getArgs</span><span class="p">)</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">Error</span> <span class="p">(</span><span class="nv">catch</span><span class="p">)</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Time</span> <span class="p">(</span><span class="n">ClockTime</span><span class="p">,</span> <span class="nv">getClockTime</span><span class="p">)</span>

<span class="nv">main</span> <span class="o">::</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">main</span> <span class="o">=</span> <span class="nv">flip</span> <span class="nv">watchFile</span> <span class="n">Nothing</span> <span class="o">.</span> <span class="nv">maybe</span> <span class="s">&quot;.&quot;</span> <span class="nv">id</span> <span class="o">.</span> <span class="nv">listToMaybe</span> <span class="o">=&lt;&lt;</span> <span class="nv">getArgs</span>

<span class="nv">watchFile</span> <span class="o">::</span> <span class="n">FilePath</span> <span class="o">-&gt;</span> <span class="n">Maybe</span> <span class="n">ClockTime</span> <span class="o">-&gt;</span> <span class="n">IO</span> <span class="p">()</span>
<span class="nv">watchFile</span> <span class="nv">file</span> <span class="nv">prev</span>
 <span class="o">=</span> <span class="nv">catch</span> <span class="p">(</span><span class="nv">threadDelay</span> <span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="mi">1000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="nv">check</span> <span class="nv">prev</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">const</span> <span class="o">$</span> <span class="nv">watchFile</span> <span class="nv">file</span> <span class="o">.</span> <span class="n">Just</span> <span class="o">=&lt;&lt;</span> <span class="nv">getClockTime</span><span class="p">)</span>
   <span class="kr">where</span> 
     <span class="nv">check</span> <span class="n">Nothing</span>      <span class="o">=</span> <span class="nv">watchFile</span> <span class="nv">file</span> <span class="o">.</span> <span class="n">Just</span> <span class="o">=&lt;&lt;</span> <span class="nv">getModificationTime</span> <span class="nv">file</span>
     <span class="nv">check</span> <span class="p">(</span><span class="n">Just</span> <span class="nv">mtime</span><span class="p">)</span> <span class="o">=</span> <span class="kr">do</span> <span class="p">{</span> <span class="nv">mtime&#39;</span> <span class="o">&lt;-</span> <span class="nv">getModificationTime</span> <span class="nv">file</span>
                             <span class="p">;</span> <span class="nv">when</span> <span class="p">(</span><span class="nv">mtime</span> <span class="o">&lt;</span> <span class="nv">mtime&#39;</span><span class="p">)</span> <span class="p">(</span><span class="nv">putStrLn</span> <span class="s">&quot;modified!&quot;</span><span class="p">)</span>
                             <span class="p">;</span> <span class="nv">watchFile</span> <span class="nv">file</span> <span class="p">(</span><span class="n">Just</span> <span class="nv">mtime&#39;</span><span class="p">)</span>
                             <span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3192/addtag/" class="addtag" id="addtag_3192">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/3192/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/3192/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_3192"
  >-</span><span
  class="button yellow"
  id="rating_z_3192"
  >0</span><span 
  class="button green"
  id="rating_p_3192"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/3192/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment1012">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/232/" target="_top">kkobayashi</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1012/">#1012</a>(<script language="JavaScript">print_time(new Date("2007/07/16 13:29 GMT"));</script><noscript>2007/07/16 13:29 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/r/">
	  R
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  Pure Rなので多分OS非依存だと思います。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td class="code"><div class="highlight"><pre>watch.file &lt;- function(file){
   mtime &lt;- file.info(file)$mtime
   repeat{
       if(mtime != (file.info(file)$mtime)){
           mtime &lt;- file.info(file)$mtime
           print(&quot;modified!&quot;)
       }
       Sys.sleep(1)
   }
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1012/addtag/" class="addtag" id="addtag_1012">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/r/">
		R
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1012/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1012/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_1012"
  >-</span><span
  class="button yellow"
  id="rating_z_1012"
  >0</span><span 
  class="button green"
  id="rating_p_1012"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/1012/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment2229">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/391/" target="_top">ソラ</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/2229/">#2229</a>(<script language="JavaScript">print_time(new Date("2007/08/16 09:08 GMT"));</script><noscript>2007/08/16 09:08 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/hsp/">
	  HSP
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>適当です。バイナリは使えないぜ。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td class="code"><div class="highlight"><pre>//HSPでファイル更新確認プログラム

*config
	//監視するファイル名
	filename = kansi.txt
	//確認する間隔（１０００の１分秒　１０００で１秒）
	times = 20
	//以下、プログラム
	puel = &quot;&quot;
	goto *gurdman
*gurdman
	notesel puel
	noteload filename
	if puel != pool {
		gosub *alert
	}
	pool = puel
	await times
*alert
	mes &quot;modified!&quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/2229/addtag/" class="addtag" id="addtag_2229">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/hsp/">
		HSP
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/2229/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/2229/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_2229"
  >-</span><span
  class="button yellow"
  id="rating_z_2229"
  >0</span><span 
  class="button green"
  id="rating_p_2229"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/2229/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/2229/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment399">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/14/" target="_top">kawauchi</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/399/">#399</a>(<script language="JavaScript">print_time(new Date("2007/07/09 15:10 GMT"));</script><noscript>2007/07/09 15:10 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  mtime を見ないで済むよう書き換えました。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;win32/ipc&#39;</span> <span class="c1"># http://rubyforge.org/projects/win32utils</span>
<span class="nb">require</span> <span class="s1">&#39;win32/changenotify&#39;</span> <span class="c1"># http://rubyforge.org/projects/win32utils</span>
<span class="kp">include</span> <span class="no">Win32</span>

<span class="nb">exit</span> <span class="k">if</span> <span class="no">ARGV</span> <span class="o">==</span> <span class="o">[]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span>

<span class="n">flags</span> <span class="o">=</span> <span class="no">ChangeNotify</span><span class="o">::</span><span class="no">FILE_NAME</span> <span class="o">|</span> <span class="no">ChangeNotify</span><span class="o">::</span><span class="no">LAST_WRITE</span> <span class="o">|</span> <span class="no">ChangeNotify</span><span class="o">::</span><span class="no">SIZE</span>
<span class="n">cn</span> <span class="o">=</span> <span class="no">ChangeNotify</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="kp">false</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

<span class="kp">loop</span> <span class="p">{</span>
  <span class="n">cn</span><span class="o">.</span><span class="n">wait</span><span class="p">(){</span><span class="o">|</span><span class="n">sa</span><span class="o">|</span>
    <span class="n">sa</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">st</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">&quot;modified!&quot;</span> <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">file_name</span> <span class="o">==</span> <span class="no">File</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/399/addtag/" class="addtag" id="addtag_399">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/399/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/399/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_399"
  >-</span><span
  class="button yellow"
  id="rating_z_399"
  >0</span><span 
  class="button green"
  id="rating_p_399"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/391/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/399/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/399/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5933">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/744/" target="_top">howking</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5933/">#5933</a>(<script language="JavaScript">print_time(new Date("2008/03/04 15:36 GMT"));</script><noscript>2008/03/04 15:36 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/erlang/">
	  Erlang
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  MD5でチェックさせてみました。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></td><td class="code"><div class="highlight"><pre>-module(checker).
-export([start/0]).

start()-&gt;
    Filename=&quot;test.html&quot;,
    loop(Filename,[]).

loop(F,C)-&gt;
    timer:sleep(1000),
    NC=erlang:md5(element(2,file:read_file(F))),
    if
        C =:= [] -&gt; loop(F,NC);
        C =:= NC -&gt; loop(F,C);
        C =/= NC -&gt;
            io:format(&quot;modified!~n&quot;),
            loop(F,NC)
    end.
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5933/addtag/" class="addtag" id="addtag_5933">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/erlang/">
		Erlang
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5933/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5933/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5933"
  >-</span><span
  class="button yellow"
  id="rating_z_5933"
  >0</span><span 
  class="button green"
  id="rating_p_5933"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/5933/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment896">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/247/" target="_top">ofk</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/896/">#896</a>(<script language="JavaScript">print_time(new Date("2007/07/15 06:07 GMT"));</script><noscript>2007/07/15 06:07 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/javascript/">
	  JavaScript
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>（　＾Ï＾）</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre><span class="k">function</span> <span class="nx">modified</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">setInterval</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="o">;</span>
		<span class="k">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="o">;</span>
		<span class="nx">r</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="o">,</span> <span class="nx">f</span><span class="o">,</span> <span class="kc">true</span><span class="p">);</span>
		<span class="nx">r</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="k">function</span><span class="p">(){</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">b</span> <span class="o">!=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">responseText</span><span class="p">)</span>
				<span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;modified!&quot;</span><span class="p">);</span>
			<span class="nx">s</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">responseText</span><span class="o">;</span>
		<span class="p">};</span>
		<span class="nx">r</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
	<span class="p">}</span><span class="o">,</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">modified</span><span class="p">(</span><span class="nx">filename</span><span class="p">);</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/896/addtag/" class="addtag" id="addtag_896">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/javascript/">
		JavaScript
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/896/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/896/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_896"
  >-</span><span
  class="button yellow"
  id="rating_z_896"
  >0</span><span 
  class="button green"
  id="rating_p_896"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/896/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment2771">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/348/" target="_top">naoya_t</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/2771/">#2771</a>(<script language="JavaScript">print_time(new Date("2007/09/01 17:08 GMT"));</script><noscript>2007/09/01 17:08 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/awk/">
	  awk
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>system() から test, touch, sleep, rm を呼び出しています。ほとんどシェルスクリプトです。これを敢えてawkで書くメリットはないです。
% awk -f kanshi.awk -v filename=foobar
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><div class="highlight"><pre>BEGIN {
	srand ; rand ; rand
	tmpfile = sprintf(&quot;/tmp/kanshi%06d&quot;, rand*1000000)
	# create tmpfile
	system(&quot;touch -r &quot; filename &quot; &quot; tmpfile)

	while (1) {
		r = system(&quot;test &quot; filename &quot; -nt &quot; tmpfile) # if filename is newer than tmpfile
		if (r == 0) {
			# message
			print &quot;modified!&quot;
			# synchronize
			system(&quot;touch -r &quot; filename &quot; &quot; tmpfile)
		}
		if (system(&quot;sleep 1&quot;)) break  # aborted
	}

	# remove tmpfile
	system(&quot;rm -f &quot; tmpfile)
	exit
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/2771/addtag/" class="addtag" id="addtag_2771">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/awk/">
		awk
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/2771/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/2771/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_2771"
  >-</span><span
  class="button yellow"
  id="rating_z_2771"
  >0</span><span 
  class="button green"
  id="rating_p_2771"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/2771/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment595">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/105/" target="_top">rubikitch</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/595/">#595</a>(<script language="JavaScript">print_time(new Date("2007/07/11 19:00 GMT"));</script><noscript>2007/07/11 19:00 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/commonlisp/">
	  Common Lisp
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  posix対応。処理系はsbcl。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre>(defun modify-checker (filename)
  (labels ((mtime () (sb-posix:stat-mtime (sb-posix:stat filename))))
    (let ((last-mtime (mtime)) current-mtime)
      (loop do
           (sleep 3)
           (setf current-mtime (mtime))
           (when (/= current-mtime last-mtime)
             (format t &quot;modified!~%&quot;)
             (setf last-mtime current-mtime))))))

           
         
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/595/addtag/" class="addtag" id="addtag_595">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/commonlisp/">
		Common Lisp
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/595/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/595/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_595"
  >-</span><span
  class="button yellow"
  id="rating_z_595"
  >0</span><span 
  class="button green"
  id="rating_p_595"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/595/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment421">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/35/" target="_top">ytakenaka</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/421/">#421</a>(<script language="JavaScript">print_time(new Date("2007/07/10 02:53 GMT"));</script><noscript>2007/07/10 02:53 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>失敬。冒頭に
(defvar filename "foo.txt")
をくわえてください。^^;
最後に、
(defun file-checher2 ()
    (file-checher filename))
もくわえてください。(file-checher2)でお題への回答になります。</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/421/addtag/" class="addtag" id="addtag_421">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_421"
  >-</span><span
  class="button yellow"
  id="rating_z_421"
  >0</span><span 
  class="button green"
  id="rating_p_421"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/419/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/421/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/421/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment405">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/145/" target="_top">kacchi</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/405/">#405</a>(<script language="JavaScript">print_time(new Date("2007/07/09 20:42 GMT"));</script><noscript>2007/07/09 20:42 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/emacslisp/">
	  Emacs Lisp
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>EmacsLisp です :-)
毎秒、更新時刻を比較します。
(setq filename "hoge") などとして、M-x watch-modification で起動してください。
変数 filename がセットされてないなら、ファイル名を聞いてくるので指定してください。
キャンセルするには、M-x watch-modification-cancel です。
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></td><td class="code"><div class="highlight"><pre>(defvar watch-modification-repeat-sec 1.0)
(defvar watch-modification-timer nil)
(defvar watch-modification-stack nil)
(defvar watch-modification-buffer &quot;*watch*&quot;)

(defun watch-modification ()
  (interactive)
  (let ((file (or (and (boundp &#39;filename) filename)
		  (read-file-name &quot;File: &quot;))))
    (unless (string= file &quot;&quot;)
      (watch-modification-cancel)
      (setq watch-modification-timer
	    (run-with-timer 1 watch-modification-repeat-sec
			    &#39;watch-modification-function file)))))

(defun watch-modification-cancel ()
  (interactive)
  (when watch-modification-timer
    (cancel-timer watch-modification-timer))
  (setq watch-modification-timer nil
	watch-modification-stack nil))

(defun watch-modification-function (file)
  (let ((modified-time (nth 5 (file-attributes file))))
    (if (null watch-modification-stack)
        (push modified-time watch-modification-stack)
      (unless (equal modified-time (car watch-modification-stack))
	(push modified-time watch-modification-stack)
	(save-selected-window
	  (pop-to-buffer
	   (set-buffer (get-buffer-create watch-modification-buffer)))
	  (insert &quot;modified!\n&quot;))))))
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/405/addtag/" class="addtag" id="addtag_405">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/emacslisp/">
		Emacs Lisp
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/405/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/405/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_405"
  >-</span><span
  class="button yellow"
  id="rating_z_405"
  >0</span><span 
  class="button green"
  id="rating_p_405"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/405/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment531">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/94/" target="_top">mjy</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/531/">#531</a>(<script language="JavaScript">print_time(new Date("2007/07/11 05:30 GMT"));</script><noscript>2007/07/11 05:30 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/bash/">
	  Bash
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/bash</span>

<span class="nv">filename</span><span class="o">=</span>~/tmp/check

<span class="nb">read</span> -n <span class="m">0</span> &lt; <span class="nv">$filename</span>
<span class="k">while </span>sleep 3; <span class="k">do</span>
<span class="k">    if</span> <span class="o">[</span> -N <span class="nv">$filename</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">        </span><span class="nb">echo</span> <span class="s1">&#39;modified!&#39;</span>
        sleep 1
        <span class="nb">read</span> -n <span class="m">0</span> &lt; <span class="nv">$filename</span>
    <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/531/addtag/" class="addtag" id="addtag_531">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/bash/">
		Bash
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/531/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/531/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_531"
  >-</span><span
  class="button yellow"
  id="rating_z_531"
  >0</span><span 
  class="button green"
  id="rating_p_531"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/531/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment1365">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/117/" target="_top">katsu</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1365/">#1365</a>(<script language="JavaScript">print_time(new Date("2007/07/23 08:02 GMT"));</script><noscript>2007/07/23 08:02 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/prolog/">
	  Prolog
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  (T,T)が、唇噛んで泣いているように見えるんです。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6</pre></td><td class="code"><div class="highlight"><pre>watch(Filename,MTime):-sleep(0.1),time_file(Filename,MTime0),modified(MTime0,MTime),watch(Filename,MTime0).
modified(_,0).
modified(T,T).
modified(_,_):-writeln(modified).

:-watch(&#39;./watch.pl&#39;,0).
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1365/addtag/" class="addtag" id="addtag_1365">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/prolog/">
		Prolog
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1365/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1365/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_1365"
  >-</span><span
  class="button yellow"
  id="rating_z_1365"
  >0</span><span 
  class="button green"
  id="rating_p_1365"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/1365/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment3676">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3676/">#3676</a>(<script language="JavaScript">print_time(new Date("2007/11/02 17:09 GMT"));</script><noscript>2007/11/02 17:09 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>SchemeというかGaucheですが。
しかも超亀レスですが。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="nf">use</span> <span class="nv">file</span><span class="o">.</span><span class="nv">util</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="nv">filename</span> <span class="s">&quot;hoge.txt&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">make-file-modification-monitor</span> <span class="nv">fname</span> <span class="nv">sleep</span> <span class="nv">on-modified</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">mon</span> <span class="nv">c</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">let1</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">fname</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nb">= </span><span class="nv">c</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">on-modified</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">sleep</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">mon</span> <span class="nv">n</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">cut</span> <span class="nv">mon</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">fname</span><span class="p">)))</span>

<span class="p">((</span><span class="nf">make-file-modification-monitor</span> <span class="nv">filename</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">sys-sleep</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">print</span> <span class="s">&quot;modified!&quot;</span><span class="p">)))</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3676/addtag/" class="addtag" id="addtag_3676">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/3676/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/3676/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_3676"
  >-</span><span
  class="button yellow"
  id="rating_z_3676"
  >0</span><span 
  class="button green"
  id="rating_p_3676"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/3676/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment398">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/111/" target="_top">id:nekoruri</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/398/">#398</a>(<script language="JavaScript">print_time(new Date("2007/07/09 14:19 GMT"));</script><noscript>2007/07/09 14:19 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  POE持ち出してきた自分はもっと反則なので大丈夫だと思います：）
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/398/addtag/" class="addtag" id="addtag_398">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_398"
  >-</span><span
  class="button yellow"
  id="rating_z_398"
  >0</span><span 
  class="button green"
  id="rating_p_398"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/392/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/398/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/398/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5827">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/646/" target="_top">silverwire</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5827/">#5827</a>(<script language="JavaScript">print_time(new Date("2008/02/21 17:42 GMT"));</script><noscript>2008/02/21 17:42 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>誤りが 1つありましたので、訂正します。

20c20
&lt;       ping -n %1 127.0.0.1 &gt;NUL
---
&gt;       ping -n 1 127.0.0.1 &gt;NUL ::  1秒間スリープ</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5827/addtag/" class="addtag" id="addtag_5827">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5827"
  >-</span><span
  class="button yellow"
  id="rating_z_5827"
  >0</span><span 
  class="button green"
  id="rating_p_5827"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/5826/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/5827/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/5827/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment1709">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/323/" target="_top">tomatsu</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1709/">#1709</a>(<script language="JavaScript">print_time(new Date("2007/08/02 12:29 GMT"));</script><noscript>2007/08/02 12:29 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/pnuts/">
	  Pnuts
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'></pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td class="code"><div class="highlight"><pre>function monitor(filename) monitor(filename, 1000, &quot;modified!&quot;)
function monitor(filename, interval, message){
  f = getFile(filename)
  lm = f.lastModified()
  while (true){
    sleep(interval)
    m = f.lastModified()
    if (m != lm){
      println(message)
      lm = m;
    }
  }
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1709/addtag/" class="addtag" id="addtag_1709">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/pnuts/">
		Pnuts
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1709/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1709/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_1709"
  >-</span><span
  class="button yellow"
  id="rating_z_1709"
  >0</span><span 
  class="button green"
  id="rating_p_1709"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/1709/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment397">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/88/" target="_top">sumim</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/397/">#397</a>(<script language="JavaScript">print_time(new Date("2007/07/09 14:05 GMT"));</script><noscript>2007/07/09 14:05 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/smalltalk/">
	  Smalltalk
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>Squeak Smalltalk で。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre>| directory filename lastModTime |
directory := FileDirectory default.
filename := &#39;test.txt&#39;.
lastModTime := (directory entryAt: filename) modificationTime.
[  [  | modificationTime |
      modificationTime := (directory entryAt: filename) modificationTime.
      modificationTime = lastModTime ifFalse: [
         Transcript cr; show: &#39;modified!&#39;.
         lastModTime := modificationTime].
      (Delay forSeconds: 3) wait
   ] repeat
] forkAt: Processor userBackgroundPriority
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/397/addtag/" class="addtag" id="addtag_397">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/smalltalk/">
		Smalltalk
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/397/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/397/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_397"
  >-</span><span
  class="button yellow"
  id="rating_z_397"
  >0</span><span 
  class="button green"
  id="rating_p_397"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/397/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment389">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/111/" target="_top">id:nekoruri</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/389/">#389</a>(<script language="JavaScript">print_time(new Date("2007/07/09 11:24 GMT"));</script><noscript>2007/07/09 11:24 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/perl/">
	  Perl
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  POE::Wheel::FollowTail
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></td><td class="code"><div class="highlight"><pre><span class="c1">#!/usr/local/bin/perl</span>

<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="n">POE</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">POE::Wheel::</span><span class="n">FollowTail</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$target_filename</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">defined</span> <span class="nv">$target_filename</span> <span class="ow">or</span> <span class="nv">$target_filename</span> <span class="ow">eq</span> <span class="s">&#39;&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s">&quot;$0 &lt;filename&gt;\n&quot;</span><span class="p">;</span>
        <span class="nb">exit</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="nn">POE::</span><span class="n">Session</span><span class="o">-&gt;</span><span class="n">create</span><span class="p">(</span>
        <span class="n">inline_states</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">_start</span> <span class="o">=&gt;</span> <span class="o">\&amp;</span><span class="n">setup</span><span class="p">,</span>
                <span class="n">handler_input</span> <span class="o">=&gt;</span> <span class="o">\&amp;</span><span class="n">handler_input</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">args</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="nv">$target_filename</span> <span class="p">],</span>
<span class="p">);</span>

<span class="nn">POE::</span><span class="n">Kernel</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">;</span>
<span class="nb">exit</span><span class="p">;</span>

<span class="k">sub </span><span class="nf">setup</span>
<span class="p">{</span>
        <span class="k">my</span> <span class="p">(</span> <span class="nv">$heap</span><span class="p">,</span> <span class="nv">$target_filename</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">[</span><span class="n">HEAP</span><span class="p">,</span> <span class="n">ARG0</span><span class="p">];</span>
        <span class="nv">$heap</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">tail_wheel</span><span class="p">}</span> <span class="o">=</span> <span class="nn">POE::Wheel::</span><span class="n">FollowTail</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span>
                <span class="n">Filename</span> <span class="o">=&gt;</span> <span class="nv">$target_filename</span><span class="p">,</span>
                <span class="n">InputEvent</span> <span class="o">=&gt;</span> <span class="s">&#39;handler_input&#39;</span><span class="p">,</span>
        <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">sub </span><span class="nf">handler_input</span>
<span class="p">{</span>
        <span class="k">print</span> <span class="s">&quot;modified!\n&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/389/addtag/" class="addtag" id="addtag_389">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/perl/">
		Perl
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/389/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/389/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_389"
  >-</span><span
  class="button yellow"
  id="rating_z_389"
  >0</span><span 
  class="button green"
  id="rating_p_389"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/389/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment4047">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/545/" target="_top">faultier</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4047/">#4047</a>(<script language="JavaScript">print_time(new Date("2007/11/15 06:27 GMT"));</script><noscript>2007/11/15 06:27 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/objectivec/">
	  Objective-C
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>NSRunLoopで回すのはいいのかどうか分かりません。NSTimerを使いたくてこの形に。
一応Leopardタグ付けますがfor ~ in ~のところをNSEnumeratorを使うように書き換えればXcode2.xでもコンパイルできるはず。
あと、Leopardだとそのままずばりファイルの監視をするFSEventというAPIがあります。
TimeMachineが使ってるやつ。これはCなんですが、詳細は参考ページ参照で。</pre>
	</div>
	
	<p class="link">
	  参考: <a href="/web/20101226213933/http://developer.apple.com/samplecode/Watcher/index.html">Watcher(FSEvent APIの使用例)</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>

<span class="cp">#define WATCH_PATH @&quot;target path&quot;</span>
<span class="cp">#define WATCH_FILE_ATTR @&quot;target file atrributes&quot;</span>
<span class="cp">#define WATCH_FILE_MODIFIED @&quot;target file modified&quot;</span>

<span class="k">@interface</span> <span class="nc">Watcher</span> : <span class="nc">NSObject</span>
<span class="p">{</span>
    <span class="n">NSMutableDictionary</span>    <span class="o">*</span><span class="n">targetPathes</span><span class="p">;</span>
    <span class="n">NSFileManager</span>        <span class="o">*</span><span class="n">manager</span><span class="p">;</span>
    <span class="n">NSMutableDictionary</span>    <span class="o">*</span><span class="n">fileAttributes</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nl">initWithTargetPathes:</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="p">)</span><span class="n">pathes</span><span class="p">;</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">checkModified</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Watcher</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nl">initWithTargetPathes:</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="p">)</span><span class="n">pathes</span><span class="p">;</span>
<span class="p">{</span>
    <span class="n">targetPathes</span>    <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableDictionary</span> <span class="n">dictionary</span><span class="p">];</span>
    <span class="n">manager</span>            <span class="o">=</span> <span class="p">[</span><span class="n">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
    <span class="n">fileAttributes</span>    <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableDictionary</span> <span class="n">dictionary</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">path</span> <span class="n">in</span> <span class="n">pathes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="n">targetPathes</span> <span class="nl">setValue:</span><span class="n">path</span> <span class="nl">forKey:</span><span class="n">path</span><span class="p">];</span>
        <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">status</span> <span class="o">=</span> <span class="p">[</span><span class="n">manager</span> <span class="nl">fileAttributesAtPath:</span><span class="n">path</span> <span class="nl">traverseLink:</span><span class="n">YES</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">[</span><span class="n">fileAttributes</span> <span class="nl">setValue:</span><span class="n">status</span> <span class="nl">forKey:</span><span class="n">path</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">self</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">sendNotification:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">aPath</span> <span class="nl">withStatus:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">aStatus</span>
<span class="p">{</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nl">stringWithFormat:</span><span class="s">@&quot;&#39;%@&#39; is modified!&quot;</span><span class="p">,</span> <span class="n">aPath</span><span class="p">];</span>
    <span class="p">[[</span><span class="n">NSNotificationCenter</span> <span class="n">defaultCenter</span><span class="p">]</span> <span class="nl">postNotificationName:</span><span class="n">WATCH_FILE_MODIFIED</span>
                                                        <span class="nl">object:</span><span class="n">message</span>
                                                      <span class="nl">userInfo:</span><span class="n">aStatus</span><span class="p">];</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">checkModified</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">path</span> <span class="n">in</span> <span class="n">targetPathes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">NSAutoreleasePool</span> <span class="o">*</span><span class="n">pool</span>    <span class="o">=</span> <span class="p">[</span><span class="n">NSAutoreleasePool</span> <span class="n">new</span><span class="p">];</span>
        <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">_prev</span>        <span class="o">=</span> <span class="p">[</span><span class="n">fileAttributes</span> <span class="nl">objectForKey:</span><span class="n">path</span><span class="p">];</span>
        <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">_current</span>    <span class="o">=</span> <span class="p">[</span><span class="n">manager</span> <span class="nl">fileAttributesAtPath:</span><span class="n">path</span> <span class="nl">traverseLink:</span><span class="n">YES</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_prev</span> <span class="o">||</span> <span class="n">_current</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">_current</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="p">[</span><span class="n">fileAttributes</span> <span class="nl">removeObjectForKey:</span><span class="n">path</span><span class="p">];</span>
                <span class="p">[</span><span class="n">self</span> <span class="nl">sendNotification:</span><span class="n">path</span> <span class="nl">withStatus:</span><span class="nb">nil</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">_current</span> <span class="nl">isEqual:</span><span class="n">_prev</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="p">[</span><span class="n">fileAttributes</span> <span class="nl">setObject:</span><span class="p">[</span><span class="n">_current</span> <span class="n">copy</span><span class="p">]</span> <span class="nl">forKey:</span><span class="n">path</span><span class="p">];</span>
                <span class="p">[</span><span class="n">self</span> <span class="nl">sendNotification:</span><span class="n">path</span> <span class="nl">withStatus:</span><span class="n">_current</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="p">[</span><span class="n">pool</span> <span class="n">release</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="err">@</span><span class="n">interface</span> <span class="n">FileStatusLogger</span> <span class="o">:</span> <span class="n">NSObject</span>
<span class="p">{</span>
    <span class="n">NSNotificationCenter</span><span class="o">*</span> <span class="n">center</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nl">initWithNotificationCenter:</span><span class="p">(</span><span class="n">NSNotificationCenter</span> <span class="o">*</span><span class="p">)</span><span class="n">aCenter</span><span class="p">;</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">log:</span><span class="p">(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="n">notice</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">FileStatusLogger</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nl">initWithNotificationCenter:</span><span class="p">(</span><span class="n">NSNotificationCenter</span> <span class="o">*</span><span class="p">)</span><span class="n">aCenter</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="n">init</span><span class="p">];</span>
    <span class="p">[</span><span class="n">aCenter</span> <span class="nl">addObserver:</span><span class="n">self</span> <span class="nl">selector:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">log:</span><span class="p">)</span> <span class="nl">name:</span><span class="n">WATCH_FILE_MODIFIED</span> <span class="nl">object:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">self</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">init</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">self</span> <span class="nl">initWithNotificationCenter:</span><span class="p">[</span><span class="n">NSNotificationCenter</span> <span class="n">defaultCenter</span><span class="p">]];</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">log:</span><span class="p">(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="n">notice</span><span class="p">;</span>
<span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">notice</span> <span class="n">object</span><span class="p">]);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="kt">void</span> <span class="n">usage</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Usage: %s &lt;interval&gt; &lt;duration&gt; &lt;path1&gt; [&lt;path2&gt;...]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="n">usage</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    
    <span class="n">NSAutoreleasePool</span> <span class="o">*</span><span class="n">pool</span>    <span class="o">=</span> <span class="p">[</span><span class="n">NSAutoreleasePool</span> <span class="n">new</span><span class="p">];</span>
    <span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">pathes</span>    <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="n">array</span><span class="p">];</span>
    <span class="n">NSTimeInterval</span> <span class="n">interval</span>    <span class="o">=</span> <span class="n">strtod</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">NSTimeInterval</span> <span class="n">duration</span>    <span class="o">=</span> <span class="n">strtod</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">interval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">usage</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="n">pathes</span> <span class="nl">addObject:</span><span class="p">[</span><span class="n">NSString</span> <span class="nl">stringWithCString:</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]]];</span>
    <span class="p">}</span>

    <span class="n">Watcher</span> <span class="o">*</span><span class="n">watcher</span>            <span class="o">=</span> <span class="p">[[</span><span class="n">Watcher</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithTargetPathes:</span><span class="n">pathes</span><span class="p">];</span>
    <span class="n">FileStatusLogger</span> <span class="o">*</span><span class="n">logger</span>    <span class="o">=</span> <span class="p">[</span><span class="n">FileStatusLogger</span> <span class="n">new</span><span class="p">];</span>
    <span class="n">NSTimer</span> <span class="o">*</span><span class="n">timer</span>                <span class="o">=</span> <span class="p">[</span><span class="n">NSTimer</span> <span class="nl">scheduledTimerWithTimeInterval:</span><span class="n">interval</span>
                                                                   <span class="nl">target:</span><span class="n">watcher</span>
                                                                 <span class="nl">selector:</span><span class="k">@selector</span><span class="p">(</span><span class="n">checkModified</span><span class="p">)</span>
                                                                 <span class="nl">userInfo:</span><span class="nb">nil</span>
                                                                  <span class="nl">repeats:</span><span class="n">YES</span><span class="p">];</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;monitoring start&quot;</span><span class="p">);</span>
    <span class="p">[[</span><span class="n">NSRunLoop</span> <span class="n">currentRunLoop</span><span class="p">]</span> <span class="nl">addTimer:</span><span class="n">timer</span> <span class="nl">forMode:</span><span class="n">NSDefaultRunLoopMode</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">[[</span><span class="n">NSRunLoop</span> <span class="n">currentRunLoop</span><span class="p">]</span> <span class="nl">runUntilDate:</span><span class="p">[</span><span class="n">NSDate</span> <span class="nl">dateWithTimeIntervalSinceNow:</span><span class="n">duration</span><span class="p">]];</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="p">[[</span><span class="n">NSRunLoop</span> <span class="n">currentRunLoop</span><span class="p">]</span> <span class="n">run</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;monitoring end&quot;</span><span class="p">);</span>
    
    <span class="p">[</span><span class="n">pool</span> <span class="n">release</span><span class="p">];</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4047/addtag/" class="addtag" id="addtag_4047">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/objectivec/">
		Objective-C
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4047/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4047/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_4047"
  >-</span><span
  class="button yellow"
  id="rating_z_4047"
  >0</span><span 
  class="button green"
  id="rating_p_4047"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/4047/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/4047/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment404">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/41/" target="_top">shiro</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/404/">#404</a>(<script language="JavaScript">print_time(new Date("2007/07/09 20:15 GMT"));</script><noscript>2007/07/09 20:15 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>同じ方針ですが、modifyされているときのアクションは純粋に副作用だけなので(printするだけ)、

(if 条件 (loop) (begin (action) (loop)))

よりは

(unless 条件 (action))
(loop)

のように副作用だけくくり出してしてしまうのが好みですね 
(分岐が増えた場合でもloopは一箇所にまとめられるし)。たとえば：</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">modify-checker</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">previous</span> <span class="no">#f</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">modified</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">filename</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="nv">previous</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">= </span><span class="nv">previous</span> <span class="nv">modified</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">print</span> <span class="s">&quot;modified&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">sys-sleep</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">loop</span> <span class="nv">modified</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">filename</span><span class="p">))))</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/404/addtag/" class="addtag" id="addtag_404">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/404/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/404/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_404"
  >-</span><span
  class="button yellow"
  id="rating_z_404"
  >0</span><span 
  class="button green"
  id="rating_p_404"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/385/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/404/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/404/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/404/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment406">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/145/" target="_top">kacchi</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/406/">#406</a>(<script language="JavaScript">print_time(new Date("2007/07/09 20:47 GMT"));</script><noscript>2007/07/09 20:47 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>自分も良くわかってませんが、とりあえず投稿しときます。:p</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="nf">use</span> <span class="nv">file</span><span class="o">.</span><span class="nv">util</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="nv">filename</span> <span class="s">&quot;hoge.txt&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">watch-modification</span> <span class="nv">file</span> <span class="nv">since</span> <span class="nv">nsec</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">last-mtime</span> <span class="nv">since</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">sys-nanosleep</span> <span class="nv">nsec</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">current</span> <span class="p">(</span><span class="nb">max </span><span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">file</span><span class="p">)</span> <span class="nv">last-mtime</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nb">= </span><span class="nv">current</span> <span class="nv">last-mtime</span><span class="p">)</span> <span class="p">(</span><span class="nf">print</span> <span class="s">&quot;modified!&quot;</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">loop</span> <span class="nv">current</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">watch-modification</span> <span class="nv">filename</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">filename</span><span class="p">)</span> <span class="mi">500000000</span><span class="p">)</span> <span class="c1">;0.5s</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/406/addtag/" class="addtag" id="addtag_406">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/406/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/406/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_406"
  >-</span><span
  class="button yellow"
  id="rating_z_406"
  >0</span><span 
  class="button green"
  id="rating_p_406"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/406/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment4349">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4349/">#4349</a>(<script language="JavaScript">print_time(new Date("2007/11/23 02:33 GMT"));</script><noscript>2007/11/23 02:33 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/nadesico/">
	  なでしこ
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>タイマーでぐるぐる回してるだけです</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td class="code"><div class="highlight"><pre>filename=デスクトップ&amp;&quot;test.txt&quot;
TMP=filenameのファイル更新日時
監視タイマーとはタイマー
これについて
    値=1000
    時満ちた時は～
        もし(TMP&lt;&gt;ファイル更新日時(filename))ならば
            &quot;modified!&quot;を表示
            TMP=filenameのファイル更新日時
    開始
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4349/addtag/" class="addtag" id="addtag_4349">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/nadesico/">
		なでしこ
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4349/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4349/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_4349"
  >-</span><span
  class="button yellow"
  id="rating_z_4349"
  >0</span><span 
  class="button green"
  id="rating_p_4349"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/4349/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment385">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/147/" target="_top">es</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/385/">#385</a>(<script language="JavaScript">print_time(new Date("2007/07/09 10:03 GMT"));</script><noscript>2007/07/09 10:03 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
	  Scheme
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>なんか根本的にわかってないかもですが・・</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="nf">use</span> <span class="nv">file</span><span class="o">.</span><span class="nv">util</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="nv">filename</span> <span class="s">&quot;hoge.txt&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">modify-checker</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">lastmodified</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">filename</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">sys-sleep</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">lastmodified</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">filename</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">loop</span> <span class="nv">lastmodified</span><span class="p">)</span>
        <span class="p">(</span><span class="k">begin </span><span class="p">(</span><span class="nf">print</span> <span class="s">&quot;modified!&quot;</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nf">file-mtime</span> <span class="nv">filename</span><span class="p">))))))</span>

<span class="p">(</span><span class="nf">modify-checker</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/385/addtag/" class="addtag" id="addtag_385">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/scheme/">
		Scheme
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/385/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/385/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_385"
  >-</span><span
  class="button yellow"
  id="rating_z_385"
  >0</span><span 
  class="button green"
  id="rating_p_385"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/385/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/385/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment393">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/1/" target="_top">にしお</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/393/">#393</a>(<script language="JavaScript">print_time(new Date("2007/07/09 12:27 GMT"));</script><noscript>2007/07/09 12:27 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  モジュールの豊富さもPerlのパワーの一つだと思うのでいいんじゃないでしょうか。
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/393/addtag/" class="addtag" id="addtag_393">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_393"
  >-</span><span
  class="button yellow"
  id="rating_z_393"
  >0</span><span 
  class="button green"
  id="rating_p_393"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/392/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/393/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/393/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5826">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/646/" target="_top">silverwire</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5826/">#5826</a>(<script language="JavaScript">print_time(new Date("2008/02/21 17:22 GMT"));</script><noscript>2008/02/21 17:22 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/bat/">
	  Batchfile
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>指定されたファイルのコピーを一時ディレクトリ(%TEMP%)に作成し、バイナリモードで元
のファイルと比較しています。タイムスタンプだけが更新された場合には検出できません。

  e.g.
    C:&gt;monitor monitor.bat
    指定されたファイルを監視しています。
    終了するにはCtrl-Cを押してください。

    02:22:22 指定されたファイルが更新されました。

Windows XPで動作を確認。fcはWindows NTにも存在するので、NTでも動作するかもしれま
せん。

# 为了妈贡献出我自己手里的全部二。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><div class="highlight"><pre>:: monitor.bat
@echo off
  setlocal
    set f=%TEMP%\%~nx1

    if &quot;%1&quot; == &quot;&quot; (echo %~n0 [FILE] &amp; goto :EOF)
    if not exist %1 (echo 指定されたファイルが見つかりません。 &amp; goto :EOF)

    echo 指定されたファイルを監視しています。
    echo 終了するにはCtrl-Cを押してください。
    echo.
    copy %1 %f% &gt;NUL
    :loop
      fc /b %f% %1 &gt;NUL
      if %ERRORLEVEL% equ 1 (
        for /f &quot;tokens=2 delims=. &quot; %%t in (&#39;echo.^|time&#39;) do echo %%t 指定されたファイルが更新されました。
        copy %1 %f% &gt;NUL
      )
      ping -n %1 127.0.0.1 &gt;NUL
    goto loop
  endlocal
goto :EOF
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5826/addtag/" class="addtag" id="addtag_5826">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/bat/">
		Batchfile
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5826/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5826/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5826"
  >-</span><span
  class="button yellow"
  id="rating_z_5826"
  >0</span><span 
  class="button green"
  id="rating_p_5826"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/5826/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/5826/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment445">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/147/" target="_top">es</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/445/">#445</a>(<script language="JavaScript">print_time(new Date("2007/07/10 07:22 GMT"));</script><noscript>2007/07/10 07:22 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>おお、キレイ!
勉強になります。ありがとうございます。

あと自分のでは、8行目と11行目の間に更新されると"modified!"の出力が一回少なくなってしまいますね。</pre>
	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/445/addtag/" class="addtag" id="addtag_445">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_445"
  >-</span><span
  class="button yellow"
  id="rating_z_445"
  >0</span><span 
  class="button green"
  id="rating_p_445"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/404/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/445/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/445/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment2230">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/391/" target="_top">ソラ</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/">#2230</a>(<script language="JavaScript">print_time(new Date("2007/08/16 09:15 GMT"));</script><noscript>2007/08/16 09:15 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/hsp/">
	  HSP
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>すいません、最後の行にreturnいれてください。修正版は</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><div class="highlight"><pre>//HSPでファイル更新確認プログラム

*config
	//監視するファイル名
	filename = kansi.txt
	//確認する間隔（１０００の１分秒　１０００で１秒）
	times = 20
	//以下、プログラム
	puel = &quot;&quot;
	goto *gurdman
*gurdman
	notesel puel
	noteload filename
	if puel != pool {
		gosub *alert
	}
	pool = puel
	await times
*alert
	mes &quot;modified!&quot;
	return
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/addtag/" class="addtag" id="addtag_2230">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/hsp/">
		HSP
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_2230"
  >-</span><span
  class="button yellow"
  id="rating_z_2230"
  >0</span><span 
  class="button green"
  id="rating_p_2230"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/2229/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/2230/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/2230/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment391">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/14/" target="_top">kawauchi</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/391/">#391</a>(<script language="JavaScript">print_time(new Date("2007/07/09 12:04 GMT"));</script><noscript>2007/07/09 12:04 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;event&#39;</span> <span class="c1"># http://yagi.xrea.jp/2006/08/event.rb</span>

<span class="n">filename</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">&quot;touched.txt&quot;</span><span class="p">)</span>

<span class="n">last_mtime</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">mtime</span>
<span class="kp">loop</span> <span class="p">{</span>
  <span class="no">Win32</span><span class="o">::</span><span class="no">Event</span><span class="o">::</span><span class="no">FindChangeNotification</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
  <span class="n">file_mtime</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">mtime</span>
  <span class="k">if</span> <span class="n">last_mtime</span> <span class="o">!=</span> <span class="n">file_mtime</span>
    <span class="nb">puts</span> <span class="s2">&quot;modified!&quot;</span>
    <span class="n">last_mtime</span> <span class="o">=</span> <span class="n">file_mtime</span>
  <span class="k">else</span>
    <span class="nb">sleep</span> <span class="mi">0</span><span class="o">.</span><span class="mi">1</span>
  <span class="k">end</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/391/addtag/" class="addtag" id="addtag_391">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/391/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/391/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_391"
  >-</span><span
  class="button yellow"
  id="rating_z_391"
  >0</span><span 
  class="button green"
  id="rating_p_391"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/391/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/391/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment418">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/153/" target="_top">Mistfeal</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/418/">#418</a>(<script language="JavaScript">print_time(new Date("2007/07/10 02:30 GMT"));</script><noscript>2007/07/10 02:30 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/php/">
	  PHP
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  CLI版。
PHPでローカルファイルを監視することなんて、まず無いと思いますが一応。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><div class="highlight"><pre><span class="x">#!/usr/bin/php</span>
<span class="cp">&lt;?php</span>
<span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$argv</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
<span class="nv">$second</span>   <span class="o">=</span> <span class="m">1</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span> <span class="nf">file_exists</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
	<span class="nv">$fp</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
	<span class="nv">$fbin1</span> <span class="o">=</span> <span class="nf">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nf">filesize</span><span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
	<span class="nf">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span> <span class="p">{</span>
	<span class="k">exit</span><span class="p">(</span><span class="s2">&quot;file not found &lt;</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
	<span class="nv">$fp</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
	<span class="nv">$fbin2</span> <span class="o">=</span> <span class="nf">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nf">filesize</span><span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span> <span class="nv">$fbin1</span> <span class="o">!=</span> <span class="nv">$fbin2</span>  <span class="p">)</span> <span class="p">{</span>
		<span class="k">echo</span> <span class="s2">&quot;modified!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
		<span class="nv">$fbin1</span> <span class="o">=</span> <span class="nv">$fbin2</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nf">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
	<span class="nf">sleep</span><span class="p">(</span><span class="nv">$second</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/418/addtag/" class="addtag" id="addtag_418">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/php/">
		PHP
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/418/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/418/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_418"
  >-</span><span
  class="button yellow"
  id="rating_z_418"
  >0</span><span 
  class="button green"
  id="rating_p_418"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/418/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment929">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/82/" target="_top">yuin</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/929/">#929</a>(<script language="JavaScript">print_time(new Date("2007/07/15 13:40 GMT"));</script><noscript>2007/07/15 13:40 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/scala/">
	  Scala
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  JAVAと一緒。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre>import java.io._
def watchFile(name:String) = {
  val f = new File(name)
  var last = f.lastModified
  while(true){
    Thread.sleep(1000)
    if(f.lastModified != last) {
      println(&quot;modified!&quot;)
      last = f.lastModified
    }
  }
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/929/addtag/" class="addtag" id="addtag_929">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/scala/">
		Scala
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/929/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/929/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_929"
  >-</span><span
  class="button yellow"
  id="rating_z_929"
  >0</span><span 
  class="button green"
  id="rating_p_929"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/929/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment413">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/413/">#413</a>(<script language="JavaScript">print_time(new Date("2007/07/10 00:35 GMT"));</script><noscript>2007/07/10 00:35 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>実は役に立たない基本形(笑
</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;unistd.h&gt;</span>
<span class="cp">#include &lt;time.h&gt;</span>
<span class="cp">#include &lt;sys/stat.h&gt;</span>
<span class="cp">#include &lt;sys/errno.h&gt;</span>

<span class="kt">int</span> <span class="nf">moniter</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">filename</span><span class="p">,</span> <span class="k">const</span> <span class="n">useconds_t</span> <span class="n">interval</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">stat</span> <span class="n">s</span><span class="p">;</span>
    <span class="n">time_t</span>      <span class="n">last_modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span>         <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;monitering file : %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">last_modified</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">st_mtime</span><span class="p">;</span>
        <span class="k">do</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span> <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
            <span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">last_modified</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">.</span><span class="n">st_mtime</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot; modified!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
                <span class="n">last_modified</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">st_mtime</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">usleep</span><span class="p">(</span> <span class="n">interval</span> <span class="p">);</span>
        <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
     <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;error:%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">errno</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">*</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c">// 無限ループ 監視間隔1.5秒</span>
    <span class="n">moniter</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1500</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/413/addtag/" class="addtag" id="addtag_413">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/413/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/413/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_413"
  >-</span><span
  class="button yellow"
  id="rating_z_413"
  >0</span><span 
  class="button green"
  id="rating_p_413"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/413/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment4767">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/374/" target="_top">omoikani</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4767/">#4767</a>(<script language="JavaScript">print_time(new Date("2007/12/11 20:29 GMT"));</script><noscript>2007/12/11 20:29 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/standardml/">
	  StandardML
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>監視は1秒毎。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td class="code"><div class="highlight"><pre>fun check filename =
let
  val t = OS.FileSys.modTime filename
in
  (OS.Process.sleep o Time.fromSeconds) 1;

  if t = OS.FileSys.modTime filename then
    check filename
  else
    (print (&quot;modified!&quot; ^ &quot;\n&quot;); check filename)
end

val _ = check &quot;hoge.txt&quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4767/addtag/" class="addtag" id="addtag_4767">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/standardml/">
		StandardML
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4767/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4767/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_4767"
  >-</span><span
  class="button yellow"
  id="rating_z_4767"
  >0</span><span 
  class="button green"
  id="rating_p_4767"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/4767/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment415">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/127/" target="_top">raynstard</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/415/">#415</a>(<script language="JavaScript">print_time(new Date("2007/07/10 01:34 GMT"));</script><noscript>2007/07/10 01:34 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>つづいて現実的かなと思うもの。
シグナルよりもソケットの方がいいかも。
detachして放置してもよい？</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;unistd.h&gt;</span>
<span class="cp">#include &lt;time.h&gt;</span>
<span class="cp">#include &lt;pthread.h&gt;</span>
<span class="cp">#include &lt;sys/stat.h&gt;</span>
<span class="cp">#include &lt;sys/errno.h&gt;</span>
<span class="cp">#include &lt;sys/signal.h&gt;</span>

<span class="k">static</span> <span class="kt">int</span>       <span class="n">continued</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">static</span> <span class="n">pthread_t</span> <span class="n">threads</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">signal_handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">signum</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">continued</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="o">*</span><span class="nf">moniter</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">stat</span> <span class="n">s</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">filename</span>      <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
    <span class="n">time_t</span>      <span class="n">last_modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span>         <span class="n">result</span>        <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">filename</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;monitering file : %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">last_modified</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">st_mtime</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span> <span class="n">continued</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span> <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
            <span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">last_modified</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">.</span><span class="n">st_mtime</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot; modified! %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
                <span class="n">last_modified</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">st_mtime</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">usleep</span><span class="p">(</span> <span class="mi">8000</span> <span class="p">);</span>
        <span class="p">}</span>
     <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;error:%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">errno</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;monitering end[%s]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">size_t</span> <span class="nf">setup</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">filename</span><span class="p">[],</span> <span class="n">size_t</span> <span class="n">nFiles</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">sigaction</span> <span class="n">act</span><span class="p">;</span>
    <span class="kt">int</span>              <span class="n">signum</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">SIGINT</span><span class="p">};</span>
    <span class="n">size_t</span> <span class="n">n</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c">// シグナルの設定</span>
    <span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">num</span><span class="o">&lt;</span><span class="k">sizeof</span><span class="p">(</span><span class="n">signum</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">signum</span><span class="p">);</span> <span class="n">num</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">sigaction</span><span class="p">(</span><span class="n">signum</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">act</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">act</span><span class="p">.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">int</span><span class="p">))</span><span class="n">signal_handler</span><span class="p">;</span>
            <span class="n">act</span><span class="p">.</span><span class="n">sa_flags</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">SA_SIGINFO</span> <span class="p">;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">sigaction</span><span class="p">(</span><span class="n">signum</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">act</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c">// スレッドの設定</span>
    <span class="n">continued</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">nFiles</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="p">)</span> <span class="k">break</span><span class="p">;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pthread_create</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">threads</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">moniter</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">filename</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">size_t</span> <span class="n">nThreads</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">*</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">nThreads</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">argv</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">argc</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span> <span class="n">nThreads</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">pthread_join</span><span class="p">(</span> <span class="n">threads</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="nb">NULL</span> <span class="p">);</span> <span class="c">// 終了待ち合わせ</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;all threads end</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/415/addtag/" class="addtag" id="addtag_415">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/415/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/415/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_415"
  >-</span><span
  class="button yellow"
  id="rating_z_415"
  >0</span><span 
  class="button green"
  id="rating_p_415"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/415/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment3698">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/481/" target="_top">mtsuyugu</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3698/">#3698</a>(<script language="JavaScript">print_time(new Date("2007/11/04 01:51 GMT"));</script><noscript>2007/11/04 01:51 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  tail&nbsp;-f&nbsp;の動作を調べて、参考にしました。<br/>kevent,&nbsp;kqueue&nbsp;を使っているので&nbsp;BSD&nbsp;限定だと思います。<br/>簡単のためファイル名変更と削除には対応していません。
	</div>
	
	<p class="link">
	  参考: <a href="/web/20101226213933/http://www.google.com/codesearch?hl=en&q=show:Jpr0rMxXFl0:eMe6OJKQfeg:OWgsbPo2mwE">tail.c</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;sys/types.h&gt;</span>
<span class="cp">#include &lt;sys/stat.h&gt;</span>
<span class="cp">#include &lt;sys/event.h&gt;</span>
<span class="cp">#include &lt;fcntl.h&gt;</span>
<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>


<span class="kt">int</span> <span class="n">main</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]</span> <span class="p">){</span>

   <span class="k">struct</span> <span class="n">stat</span> <span class="n">sb</span><span class="p">;</span>
   <span class="k">struct</span> <span class="n">kevent</span> <span class="n">kev</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">kq</span><span class="p">,</span> <span class="n">fd</span><span class="p">;</span>


   <span class="k">if</span><span class="p">(</span> <span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">){</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;Usage: %s filename</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
      <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">stat</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">sb</span> <span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;%s is not acceessible</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
      <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="n">S_ISREG</span><span class="p">(</span> <span class="n">sb</span><span class="p">.</span><span class="n">st_mode</span> <span class="p">)</span> <span class="p">){</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;%s is not regular file</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
      <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDONLY</span> <span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;open(</span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">) failed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
      <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">kq</span> <span class="o">=</span> <span class="n">kqueue</span><span class="p">();</span>

   <span class="n">EV_SET</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">kev</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="n">EVFILT_READ</span><span class="p">,</span> <span class="n">EV_ADD</span> <span class="o">|</span> <span class="n">EV_ENABLE</span> <span class="o">|</span> <span class="n">EV_CLEAR</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>
   <span class="k">if</span><span class="p">(</span> <span class="n">kevent</span><span class="p">(</span><span class="n">kq</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">kev</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">){</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">&quot;kevent failed</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
      <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
      <span class="n">kevent</span><span class="p">(</span><span class="n">kq</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">kev</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;modified!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/3698/addtag/" class="addtag" id="addtag_3698">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/3698/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/3698/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_3698"
  >-</span><span
  class="button yellow"
  id="rating_z_3698"
  >0</span><span 
  class="button green"
  id="rating_p_3698"
  >+</span></span></span>
  


<p>

  

  <a href="/web/20101226213933/http://ja.doukaku.org/comment/3698/">
    1
    reply
  </a>

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/3698/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment597">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/105/" target="_top">rubikitch</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/597/">#597</a>(<script language="JavaScript">print_time(new Date("2007/07/11 21:58 GMT"));</script><noscript>2007/07/11 21:58 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/commonlisp/">
	  Common Lisp
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  再帰。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre>(defun modify-checker (filename)
  (labels ((mtime () (sb-posix:stat-mtime (sb-posix:stat filename)))
           (check (old-t new-t)
             (when (/= old-t new-t)
               (format t &quot;modified!~%&quot;))
             (sleep 3)
             (check new-t (mtime))))
    (check (mtime) (mtime))))
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/597/addtag/" class="addtag" id="addtag_597">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/commonlisp/">
		Common Lisp
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/597/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/597/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_597"
  >-</span><span
  class="button yellow"
  id="rating_z_597"
  >0</span><span 
  class="button green"
  id="rating_p_597"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/597/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5371">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/654/" target="_top">ika</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5371/">#5371</a>(<script language="JavaScript">print_time(new Date("2008/01/17 12:57 GMT"));</script><noscript>2008/01/17 12:57 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/d/">
	  D
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>まだDが出ていなかったので。
標準ライブラリが使いづらくて仕方がありません。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="n">std</span>.<span class="n">stdio</span>, <span class="n">std</span>.<span class="n">file</span>, <span class="n">std</span>.<span class="n">date</span>, <span class="n">std</span>.<span class="n">c</span>.<span class="n">time</span>;

<span class="kt">void</span> <span class="n">main</span>(<span class="n">string</span>[] <span class="n">args</span>) {
    <span class="k">if</span>(<span class="n">args</span>.<span class="n">length</span> &lt;= <span class="mi">1</span>) <span class="k">return</span>;
    <span class="k">auto</span> <span class="n">filename</span> = <span class="n">args</span>[<span class="mi">1</span>];
    
    <span class="n">d_time</span> <span class="n">lastmod</span> = <span class="n">mtime</span>(<span class="n">filename</span>);
    <span class="k">while</span>(<span class="kc">true</span>) {
        <span class="n">d_time</span> <span class="n">lastmod2</span> = <span class="n">mtime</span>(<span class="n">filename</span>);
        <span class="k">if</span>(<span class="n">lastmod</span> != <span class="n">lastmod2</span>) {
            <span class="n">writeln</span>(<span class="s">&quot;modified!&quot;</span>);
            <span class="n">lastmod</span> = <span class="n">lastmod2</span>;
        }
        <span class="n">msleep</span>(<span class="mi">1000</span>);
    }
}

<span class="n">d_time</span> <span class="n">mtime</span>(<span class="n">string</span> <span class="n">file</span>) {
    <span class="n">d_time</span> <span class="n">ftc</span>, <span class="n">fta</span>, <span class="n">ftm</span>;
    <span class="n">getTimes</span>(<span class="n">file</span>, <span class="n">ftc</span>, <span class="n">fta</span>, <span class="n">ftm</span>);
    <span class="k">return</span> <span class="n">ftm</span>;
}
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5371/addtag/" class="addtag" id="addtag_5371">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/d/">
		D
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5371/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5371/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5371"
  >-</span><span
  class="button yellow"
  id="rating_z_5371"
  >0</span><span 
  class="button green"
  id="rating_p_5371"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/5371/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment5841">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/725/" target="_top">takuya_1st</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5841/">#5841</a>(<script language="JavaScript">print_time(new Date("2008/02/25 01:58 GMT"));</script><noscript>2008/02/25 01:58 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  IronPythonで書いてみました。
C#とほぼ同じになりますが、C#よりタイプ量が少ないのがうれしいですね
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">clr</span>
<span class="k">import</span> <span class="nn">System</span>
<span class="k">from</span> <span class="nn">System.IO</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;D:/test.php&quot;</span>
<span class="n">fw</span> <span class="o">=</span> <span class="n">FileSystemWatcher</span><span class="p">(</span> <span class="n">Path</span><span class="o">.</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">Path</span><span class="o">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">handle</span><span class="p">(</span> <span class="n">w</span><span class="p">,</span><span class="n">a</span> <span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;modified&quot;</span>

<span class="n">fw</span><span class="o">.</span><span class="n">Changed</span> <span class="o">+=</span> <span class="n">handle</span>
<span class="n">fw</span><span class="o">.</span><span class="n">EnableRaisingEvents</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/5841/addtag/" class="addtag" id="addtag_5841">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5841/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/5841/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_5841"
  >-</span><span
  class="button yellow"
  id="rating_z_5841"
  >0</span><span 
  class="button green"
  id="rating_p_5841"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/5841/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment429">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/17/" target="_top">ultraist</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/429/">#429</a>(<script language="JavaScript">print_time(new Date("2007/07/10 04:23 GMT"));</script><noscript>2007/07/10 04:23 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
	  C
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #bfffbf;">4/4=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  最近のLinux用。
ファイル更新の定義が謎なのでいろいろ監視します。いろいろには、内容の変更、属性の変更、移動、削除が含まれます。ファイルを移動したりファイル名をリネームしても対象ファイルの監視を続けます。対象ファイルが削除されると監視をやめます。

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></td><td class="code"><div class="highlight"><pre><span class="c">/* $ gcc fnotify.c -o fnotify -Wall */</span>
<span class="cp">#include &lt;sys/inotify.h&gt;</span>
<span class="cp">#include &lt;unistd.h&gt;</span>
<span class="cp">#include &lt;limits.h&gt;</span>
<span class="cp">#include &lt;stddef.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>
<span class="cp">#include &lt;stdio.h&gt;</span>

<span class="cp">#define INOE_HDR_SZ offsetof(struct inotify_event, name)</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ino_error</span><span class="p">(</span><span class="kt">int</span> <span class="n">ino_dev</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">message</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">close</span><span class="p">(</span><span class="n">ino_dev</span><span class="p">);</span>
    <span class="n">perror</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">observe</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">filename</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">ino_dev</span><span class="p">,</span> <span class="n">ino_fd</span><span class="p">,</span> <span class="n">len</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">inotify_event</span> <span class="o">*</span><span class="n">event</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">INOE_HDR_SZ</span> <span class="o">+</span> <span class="n">PATH_MAX</span><span class="p">];</span>
    
    <span class="n">ino_dev</span> <span class="o">=</span> <span class="n">inotify_init</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ino_dev</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">&quot;inotify_init&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ino_fd</span> <span class="o">=</span> <span class="n">inotify_add_watch</span><span class="p">(</span><span class="n">ino_dev</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>
                <span class="n">IN_ATTRIB</span> <span class="o">|</span> <span class="n">IN_MODIFY</span> <span class="o">|</span> <span class="n">IN_MOVE_SELF</span> <span class="o">|</span> <span class="n">IN_DELETE_SELF</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ino_fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">ino_error</span><span class="p">(</span><span class="n">ino_dev</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">inotify_event</span> <span class="o">*</span><span class="p">)</span><span class="n">buffer</span><span class="p">;</span>
    
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">len</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">ino_dev</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">ino_error</span><span class="p">(</span><span class="n">ino_dev</span><span class="p">,</span> <span class="s">&quot;read&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">IN_ATTRIB</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">puts</span><span class="p">(</span><span class="s">&quot;modified! (ATTRIB)&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">IN_MODIFY</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">puts</span><span class="p">(</span><span class="s">&quot;modified! (MODIFY)&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">IN_MOVE_SELF</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">puts</span><span class="p">(</span><span class="s">&quot;modified! (MOVE_SELF)&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">IN_DELETE_SELF</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">puts</span><span class="p">(</span><span class="s">&quot;modified! (DELETE_SELF)&quot;</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">close</span><span class="p">(</span><span class="n">ino_dev</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Usage: %s filename</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">observe</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/429/addtag/" class="addtag" id="addtag_429">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/c/">
		C
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/429/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/429/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #bfffbf;"
  >4/4=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_429"
  >-</span><span
  class="button yellow"
  id="rating_z_429"
  >0</span><span 
  class="button green"
  id="rating_p_429"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/429/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment1368">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/41/" target="_top">shiro</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1368/">#1368</a>(<script language="JavaScript">print_time(new Date("2007/07/23 09:44 GMT"));</script><noscript>2007/07/23 09:44 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/haskell/">
	  Haskell
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>Haskell練習中。
GHCのSystem.Posixモジュール使用。</pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td class="code"><div class="highlight"><pre><span class="kr">import</span> <span class="n">Maybe</span>
<span class="kr">import</span> <span class="n">Directory</span>
<span class="kr">import</span> <span class="n">System</span><span class="o">.</span><span class="n">Posix</span>

<span class="nv">watchFile</span> <span class="nv">filename</span> <span class="o">=</span> <span class="nv">watchIt</span> <span class="n">Nothing</span>
  <span class="kr">where</span> <span class="nv">watchIt</span> <span class="n">Nothing</span> <span class="o">=</span> <span class="kr">do</span> <span class="nv">mtime</span> <span class="o">&lt;-</span> <span class="nv">getModificationTime</span> <span class="nv">filename</span>
                             <span class="nv">watchIt</span> <span class="p">(</span><span class="n">Just</span> <span class="nv">mtime</span><span class="p">)</span>
        <span class="nv">watchIt</span> <span class="p">(</span><span class="n">Just</span> <span class="nv">prev</span><span class="p">)</span> <span class="o">=</span> <span class="kr">do</span> <span class="nv">mtime</span> <span class="o">&lt;-</span> <span class="nv">getModificationTime</span> <span class="nv">filename</span>
                                 <span class="kr">if</span> <span class="p">(</span><span class="nv">prev</span> <span class="o">&lt;</span> <span class="nv">mtime</span><span class="p">)</span> 
                                   <span class="kr">then</span> <span class="nv">putStrLn</span> <span class="s">&quot;modified!&quot;</span>
                                   <span class="kr">else</span> <span class="nv">return</span> <span class="p">()</span>
                                 <span class="nv">sleep</span> <span class="mi">3</span>
                                 <span class="nv">watchIt</span> <span class="p">(</span><span class="n">Just</span> <span class="nv">mtime</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1368/addtag/" class="addtag" id="addtag_1368">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/haskell/">
		Haskell
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1368/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1368/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_1368"
  >-</span><span
  class="button yellow"
  id="rating_z_1368"
  >0</span><span 
  class="button green"
  id="rating_p_1368"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/1368/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment4073">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/481/" target="_top">mtsuyugu</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4073/">#4073</a>(<script language="JavaScript">print_time(new Date("2007/11/15 14:25 GMT"));</script><noscript>2007/11/15 14:25 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/diff/">
	  diff
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #efffef;">1/1=1.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  プラス評価ありがとうございます。<br/>-&nbsp;初回のイベント通知は捨てる。<br/>-&nbsp;close&nbsp;処理を追加。<br/>を追加してみました。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></td><td class="code"><div class="highlight"><pre><span class="gd">--- main.c.org  Thu Nov 15 23:18:57 2007</span>
<span class="gi">+++ main.c      Thu Nov 15 23:23:17 2007</span>
<span class="gu">@@ -4,7 +4,13 @@</span>
 #include &lt;fcntl.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;stdlib.h&gt;
<span class="gi">+#include &lt;signal.h&gt;</span>
<span class="gi">+#include &lt;unistd.h&gt;</span>

<span class="gi">+int received_sigint;</span>
<span class="gi">+void sigint_handler( int sig ){</span>
<span class="gi">+   received_sigint = 1;</span>
<span class="gi">+}</span>

 int main ( int argc, char *argv[] ){

<span class="gu">@@ -33,6 +39,11 @@</span>
       return EXIT_FAILURE;
    }

<span class="gi">+   if( signal(SIGINT, sigint_handler) == SIG_ERR ){</span>
<span class="gi">+      fprintf(stderr,&quot;couldn&#39;t register SIGINT handler\n&quot;);</span>
<span class="gi">+      return EXIT_FAILURE;</span>
<span class="gi">+   }</span>
<span class="gi">+</span>
    kq = kqueue();

    EV_SET( &amp;kev, fd, EVFILT_READ, EV_ADD | EV_ENABLE | EV_CLEAR , 0, 0, 0 );
<span class="gu">@@ -40,9 +51,16 @@</span>
       fprintf(stderr,&quot;kevent failed\n&quot; );
       return EXIT_FAILURE;
    }
<span class="gi">+   kevent(kq, NULL, 0, &amp;kev, 1, NULL);</span>
    while(1){
<span class="gd">-      kevent(kq, NULL, 0, &amp;kev, 1, NULL);</span>
<span class="gi">+      if( kevent(kq, NULL, 0, &amp;kev, 1, NULL) == -1 ){</span>
<span class="gi">+         if( !received_sigint ){</span>
<span class="gi">+            perror(&quot;error&quot;);</span>
<span class="gi">+         }</span>
<span class="gi">+         break;</span>
<span class="gi">+      }</span>
       printf(&quot;modified!\n&quot;);
    }
<span class="gi">+   close(fd);</span>
    return EXIT_SUCCESS;
 }
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/4073/addtag/" class="addtag" id="addtag_4073">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/diff/">
		diff
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4073/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/4073/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #efffef;"
  >1/1=1.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_4073"
  >-</span><span
  class="button yellow"
  id="rating_z_4073"
  >0</span><span 
  class="button green"
  id="rating_p_4073"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/3698/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/4073/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/4073/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment1996">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/334/" target="_top">hirose31</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1996/">#1996</a>(<script language="JavaScript">print_time(new Date("2007/08/07 17:35 GMT"));</script><noscript>2007/08/07 17:35 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/perl/">
	  Perl
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'>$ observe-mtime -c 'echo "modified!"' filename

いつも使っているスクリプトでいけそうなのでまんま投稿します。

・複数ファイルを監視できます
・任意のコマンドを実行できます
・監視間隔を指定できます

</pre>
	</div>
	
	<p class="link">
	  参考: <a href="/web/20101226213933/http://d.hatena.ne.jp/hirose31/20070528/1180326347"></a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></td><td class="code"><div class="highlight"><pre><span class="c1">#!/usr/bin/env perl</span>

<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Pod::</span><span class="n">Usage</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Getopt::</span><span class="n">Long</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">File::</span><span class="n">Modified</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$Interval</span> <span class="o">=</span> <span class="nv">$ENV</span><span class="p">{</span><span class="n">INTERVAL</span><span class="p">}</span> <span class="o">||</span> <span class="mi">3</span><span class="p">;</span> <span class="c1"># sec</span>
<span class="k">my</span> <span class="nv">$command</span><span class="p">;</span>

<span class="nn">Getopt::Long::</span><span class="n">Configure</span><span class="p">(</span><span class="s">&quot;bundling&quot;</span><span class="p">);</span>
<span class="n">GetOptions</span><span class="p">(</span>
    <span class="s">&#39;command|c=s&#39;</span> <span class="o">=&gt;</span> <span class="err">¥</span><span class="nv">$command</span><span class="p">,</span>
    <span class="s">&#39;help|h|?&#39;</span>    <span class="o">=&gt;</span> <span class="k">sub </span><span class="p">{</span> <span class="n">pod2usage</span><span class="p">()</span> <span class="p">},</span>
    <span class="p">)</span> <span class="ow">or</span> <span class="n">pod2usage</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@files</span> <span class="o">=</span> <span class="nv">@ARGV</span><span class="p">;</span>
<span class="n">pod2usage</span> <span class="k">unless</span> <span class="nv">$command</span><span class="p">;</span>

<span class="c1">### @files</span>
<span class="c1">### $command</span>

<span class="k">my</span> <span class="nv">$o</span> <span class="o">=</span> <span class="nn">File::</span><span class="n">Modified</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span><span class="n">files</span><span class="o">=&gt;</span><span class="p">[</span> <span class="nv">@files</span> <span class="p">]);</span>
<span class="k">my</span> <span class="nv">@changes</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">@changes</span> <span class="o">=</span> <span class="nv">$o</span><span class="o">-&gt;</span><span class="n">changed</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">### @changes</span>
        <span class="k">print</span> <span class="sx">qx{ $command }</span><span class="p">;</span>
        <span class="nv">$o</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">### sleep: $Interval</span>
    <span class="nb">sleep</span> <span class="nv">$Interval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">__END__</span>

<span class="cp">=head1 SYNOPSIS</span>

<span class="cp">observe-mtime -c command file [file...]</span>

<span class="cp">=cut</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/1996/addtag/" class="addtag" id="addtag_1996">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/perl/">
		Perl
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1996/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/1996/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_1996"
  >-</span><span
  class="button yellow"
  id="rating_z_1996"
  >0</span><span 
  class="button green"
  id="rating_p_1996"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/1996/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment670">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/177/" target="_top">ocean</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/670/">#670</a>(<script language="JavaScript">print_time(new Date("2007/07/12 15:35 GMT"));</script><noscript>2007/07/12 15:35 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/cpp/">
	  C++
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  カバレッジ稼ぎ。ロジックはPython版とほとんど同じ。
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;stdexcept&gt;</span>
<span class="cp">#include &lt;windows.h&gt;</span>

<span class="n">FILETIME</span> <span class="n">mtime</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">path</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">WIN32_FIND_DATA</span> <span class="n">wfd</span><span class="p">;</span>

    <span class="n">HANDLE</span> <span class="n">h</span> <span class="o">=</span> <span class="o">::</span><span class="n">FindFirstFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wfd</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">h</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;file not found&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="o">::</span><span class="n">FindClose</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">wfd</span><span class="p">.</span><span class="n">ftLastWriteTime</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="kt">char</span> <span class="n">filename</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;a.txt&quot;</span><span class="p">;</span>

        <span class="n">FILETIME</span> <span class="n">old_mtime</span> <span class="o">=</span> <span class="n">mtime</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>

        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="o">::</span><span class="n">Sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>

            <span class="k">const</span> <span class="n">FILETIME</span> <span class="n">new_mtime</span> <span class="o">=</span> <span class="n">mtime</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">::</span><span class="n">CompareFileTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">old_mtime</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">new_mtime</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;modified!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">old_mtime</span> <span class="o">=</span> <span class="n">new_mtime</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/670/addtag/" class="addtag" id="addtag_670">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/cpp/">
		C++
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/670/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/670/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_670"
  >-</span><span
  class="button yellow"
  id="rating_z_670"
  >0</span><span 
  class="button green"
  id="rating_p_670"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/670/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment7915">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/4/" target="_top">匿名</a><a href="/web/20101226213933/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/7915/">#7915</a>(<script language="JavaScript">print_time(new Date("2008/11/01 06:05 GMT"));</script><noscript>2008/11/01 06:05 GMT</noscript>)
	
	
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>116行目のscheduledTimerWithTimeInterval:target:selector:userInfo:repeats:
のメソッドでcurrentRunLoopに登録されますので、
122行目の addTimer:...はいらないんじゃないかなぁ。</p>

	</div>
	
	
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/7915/addtag/" class="addtag" id="addtag_7915">タグ</a>:
	なし&nbsp;

	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_7915"
  >-</span><span
  class="button yellow"
  id="rating_z_7915"
  >0</span><span 
  class="button green"
  id="rating_p_7915"
  >+</span></span></span>
  


<p>

  
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/4047/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoparent.png" alt="parent"></a>
    <a href="/web/20101226213933/http://ja.doukaku.org/comment/7915/root/"><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/gotoroot.png" alt="thread root"></a>
  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/7915/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment395">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/64/" target="_top">zigorou</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/395/">#395</a>(<script language="JavaScript">print_time(new Date("2007/07/09 13:06 GMT"));</script><noscript>2007/07/09 13:06 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/xul/">
	  XUL
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  Cc, Ciはそれぞれ

const Cc = Components.classes;
const Ci = Components.interfaces;

されているとして、

var fw = new FileWatch("/home/zigorou/hoge.txt", 5);
fw.watch();

で5秒おきにErrorConsoleに対して更新されてればmodified表示。

fw.unwatch()で監視止める。

でももっと奇麗に書き方ありそうな気がする。Observerがそもそもあったりして（ぇ
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></td><td class="code"><div class="highlight"><pre>var FileWatch = function(filename, duration) {
  this.file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);
  this.file.initWithPath(filename);
  this.duration = duration;
};

FileWatch.prototype = {
  iid: null,
  lastTime: null,
  watch: function() {
    this.lastTime = (new Date()).getTime();
    var self = this;
    this.iid = setInterval(function() { self.watchFile(); }, this.duration * 1000);
  },
  watchFile: function() {
    if (this.file.lastModifiedTime - this.lastTime &gt; 0) {
      this.log(&quot;modified&quot;);
    }

    this.lastTime = (new Date()).getTime();
  },
  log: function(message) {
    Cc[&quot;@mozilla.org/consoleservice;1&quot;].getService(Ci.nsIConsoleService).logStringMessage(message);
  },
  unwatch: function() {
    clearInterval(this.iid);
  }
};
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/395/addtag/" class="addtag" id="addtag_395">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/xul/">
		XUL
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/395/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/395/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_395"
  >-</span><span
  class="button yellow"
  id="rating_z_395"
  >0</span><span 
  class="button green"
  id="rating_p_395"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/395/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment9835">
  <p class="banner"><a href="/web/20101226213933/http://ja.doukaku.org/user/1132/" target="_top">taka_2</a>

	
	&nbsp;
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/9835/">#9835</a>(<script language="JavaScript">print_time(new Date("2010/01/19 01:24 GMT"));</script><noscript>2010/01/19 01:24 GMT</noscript>)
	
	
	
	[<a href="/web/20101226213933/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;
<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <pre class='compact'></pre>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></td><td class="code"><div class="highlight"><pre>Option Explicit

Dim filename, fs, objFile
Dim lastDateLastModified, nowDateLastModified

filename = WScript.Arguments(0)

Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;)
If fs.FileExists(filename) = False Then
    WScript.Echo(filename &amp; &quot; is not exists.&quot;)
    WScript.Quit(1)
End If

Set objFile = fs.GetFile(filename)
lastDateLastModified = objFile.DateLastModified

Do
    nowDateLastModified = objFile.DateLastModified
    If lastDateLastModified &lt;&gt; nowDateLastModified Then
        WScript.Echo &quot;modified!&quot;
        lastDateLastModified = nowDateLastModified
    End If
    WScript.Sleep(10000)
Loop
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20101226213933/http://ja.doukaku.org/comment/9835/addtag/" class="addtag" id="addtag_9835">タグ</a>:
	なし&nbsp;

	
      [<a href="/web/20101226213933/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20101226213933/http://ja.doukaku.org/comment/9835/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20101226213933/http://ja.doukaku.org/comment/9835/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_9835"
  >-</span><span
  class="button yellow"
  id="rating_z_9835"
  >0</span><span 
  class="button green"
  id="rating_p_9835"
  >+</span></span></span>
  


<p>

  

  

  [<a href="/web/20101226213933/http://ja.doukaku.org/15/reply_to/9835/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>







</div>

<div id="side_menu" class="compact">

<iframe src="/web/20101226213933if_/http://ja.doukaku.org/login_info/" frameborder=0 width=100% id="login_info">
iframe required
</iframe>

<h4 class="semi_compact">一覧</h4>

<ul>
<li><a href="/web/20101226213933/http://ja.doukaku.org/lang/">言語</a>
<li><a href="/web/20101226213933/http://ja.doukaku.org/challenge/">お題</a>
<li><a href="/web/20101226213933/http://ja.doukaku.org/topic/">トピック</a>
<li><a href="/web/20101226213933/http://ja.doukaku.org/comment/">投稿</a>
<li><a href="/web/20101226213933/http://ja.doukaku.org/good_comments/">評価の高い投稿</a>
<li><a href="/web/20101226213933/http://ja.doukaku.org/tag/">タグ</a>
</ul>

<h4 class="compact">フィード</h4>
<ul>
<li><a href="/web/20101226213933/http://ja.doukaku.org/feeds/topics/">最新のトピック</a><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20101226213933/http://ja.doukaku.org/feeds/comments/">新着投稿</a><img src="/web/20101226213933im_/http://ja.doukaku.org/static/image/feed_icon.png">
</ul>

<h4 class="compact">その他</h4>
<ul>
<li><a href="/web/20101226213933/http://ja.doukaku.org/qa/">Q&amp;A</a>
<li><a href="/web/20101226213933/http://ja.doukaku.org/feedback/">フィードバック</a>
<!--<li><a href="/terms">用語集</a>-->
</ul>


<h4 class="compact">リンク</h4>
<ul>
<li><a href="/web/20101226213933/http://labs.cybozu.co.jp/">サイボウズ・ラボ</a>
<li><a href="/web/20101226213933/http://www.djangoproject.com/">Django</a>
</ul>


</div>
</div>


<div id="page_foot" class="bordered">
<a rel="license" href="/web/20101226213933/http://creativecommons.org/licenses/by/2.1/jp/">
<img alt="Creative Commons License" style="border-width:0" src="/web/20101226213933im_/http://i.creativecommons.org/l/by/2.1/jp/88x31.png" /></a>
このサイトの内容は、
<a rel="license" href="/web/20101226213933/http://creativecommons.org/licenses/by/2.1/jp/">クリエイティブ・コモンズ・ライセンス</a>の下でライセンスされています。
<a href="/web/20101226213933/http://ja.doukaku.org/qa/#licence">[詳細]</a>
</div>

</body>



<script type="text/javascript">
$(document).ready(function(){$("#doukaku_org").after("<script src='/web/20101226213933/http://api.pathtraq.com/pages?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&api=json&callback=addPathtraq'><" + "/script>")});
</script>

<script src="/web/20101226213933js_/http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2136157-1";
urchinTracker();
</script>



</html>





<!--
     FILE ARCHIVED ON 21:39:33 Dec 26, 2010 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 14:00:34 Nov 16, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
