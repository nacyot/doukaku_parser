
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> 
  <head>

<script type="text/javascript" src="/static/js/analytics.js" ></script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>




    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
    <title>
麻雀の和了判定
どう書く？org </title>

    <link rel="stylesheet" type="text/css"
	href="/web/20091219030926cs_/http://ja.doukaku.org/static/style/reset-fonts-grids.css" />
    <link rel="stylesheet" type="text/css"
	href="/web/20091219030926cs_/http://ja.doukaku.org/static/style/style.css?20071211?20071207" />
	
    <link rel="stylesheet" type="text/css"
	href="/web/20091219030926cs_/http://ja.doukaku.org/static/style/pygments.css" />


	
<meta name="robots" content="noindex,nofollow">

    <!--<script src="/web/20091219030926/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->


<!--<script src="/web/20091219030926/http://ja.doukaku.org/static/js/ieerbug/ieerbug.js" type="text/javascript"></script>-->
<script src="/web/20091219030926js_/http://ja.doukaku.org/static/js/jquery-1.1.3.1.js" type="text/javascript"></script>
<script src="/web/20091219030926js_/http://ja.doukaku.org/static/js/rating.js" type="text/javascript"></script>
<script src="/web/20091219030926js_/http://ja.doukaku.org/static/js/addtag.js?20071129" type="text/javascript"></script>

<script type="text/javascript">
is_key_navigation_enable = true;
</script>
<script src="/web/20091219030926js_/http://ja.doukaku.org/static/js/utils.js?~~~" type="text/javascript"></script>

</head>


<body id="doukaku_org">
<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script> if (window.archive_analytics) { window.archive_analytics.values['server_name']="wwwb-app13.us.archive.org";}; </script>

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/ja.doukaku.org\/237\/flatten\/";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "19";
var displayMonth = "Dec";
var displayYear = "2009";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" lang="en" class="__wb_banner_div" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px">


<div id="wm-ipp-inside" class="__wb_banner_div" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://ja.doukaku.org/237/flatten/" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20091219030926" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;width: inherit !important" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20090522071003/http://ja.doukaku.org/237/flatten/" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="22 May 2009"><strong>MAY</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 3:09:26 Dec 19, 2009">DEC</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Jan
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20091215153513/http://ja.doukaku.org/237/flatten/" title="15:35:13 Dec 15, 2009" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 3:09:26 Dec 19, 2009">19</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"/>
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2008
                       
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 3:09:26 Dec 19, 2009">2009</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2010
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20091219030926*/http://ja.doukaku.org/237/flatten/" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>4 captures</strong></a>
           <div class="__wb_banner_div" style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">17 Mar 09 - 19 Dec 09</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div class="__wb_banner_div" id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:-1:000000000000_2009:11:001010000002_2010:-1:000000000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->


<div id="page_head" class="compact">
  <h1 class="compact">
    <a href="/web/20091219030926/http://ja.doukaku.org/">どう書く？org</a><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/beta.png" alt="beta">
  </h1>
</div>

<div id="page_body" class="compact">
<div id="content" class="compact">




<h2 class="compact">
<img src='/web/20091219030926im_/http://ja.doukaku.org/static/image/star_gold.png' alt=お題(出題済み)>
<a href="/web/20091219030926/http://ja.doukaku.org/237/">麻雀の和了判定</a>
</h2>

    





<div class="comment" id="comment8532">
  <p class="banner"><a href="/web/20091219030926/http://ja.doukaku.org/user/1015/" target="_top">wm</a>

	
	&nbsp;
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8532/">#8532</a>(<script language="JavaScript">print_time(new Date("2009/02/18 13:10 GMT"));</script><noscript>2009/02/18 13:10 GMT</noscript>)
	
	
	
	[<a href="/web/20091219030926/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffaf6f;">-5/9=-0.56</span></span>
  </p>
  <div class="comment_content" >
	<div class="comment_body">
	  麻雀の手牌が和了形か否かを判定するコードを書いてください。<br/><br/>手牌を表すのは、mn+h&nbsp;枚を表す配列です。フォーマットは&nbsp;A,&nbsp;B&nbsp;の2つから任意に選んだものを受け取ってください。以下の2つは同じものです:<br/>handA&nbsp;=&nbsp;[2,1,1,1,1,2,2,1,3]&nbsp;#&nbsp;牌1が2個、牌2が1個、牌3が1個、牌4が1個、牌5が1個、牌6が2個、牌7が2個、牌8が1個、牌9が3個<br/>handB&nbsp;=&nbsp;[1,1,2,3,4,5,6,6,7,7,8,9,9,9]&nbsp;#&nbsp;牌1、牌1、牌2、牌3、牌4、牌5、牌6、牌7、牌7、牌8、牌9、牌9、牌9<br/><br/>ある配列が和了形であるとは、手牌が「刻子」「順子」を合計&nbsp;n&nbsp;個と「対子」1&nbsp;個との和であることをいうものとします。<br/>「刻子」とは1種の牌が&nbsp;m&nbsp;個あることをいいます。<br/>「順子」とは連続したインデクスを持つ牌が&nbsp;m&nbsp;種各1個あることをいいます。<br/>「対子」とは1種の牌が&nbsp;h&nbsp;個あることをいいます。<br/><br/>上の例は、和了形です。なぜなら、当該配列が<br/>Bタイプで表記すると、刻子&nbsp;[9,9,9],&nbsp;順子&nbsp;[2,3,4],&nbsp;[5,6,7],&nbsp;[6,7,8],&nbsp;対子&nbsp;[1,1]&nbsp;の、<br/>Aタイプで表記すると、刻子&nbsp;[0,0,0,0,0,0,0,0,3],&nbsp;順子&nbsp;[0,1,1,1,0,0,0,0,0],&nbsp;[0,0,0,0,1,1,1,0,0],&nbsp;[0,0,0,0,0,1,1,1,0],&nbsp;対子&nbsp;[2,0,0,0,0,0,0,0,0]&nbsp;の、<br/>和だからです。<br/><br/>・&nbsp;n&nbsp;は任意のものを受け取れるようにしてください。<br/>・&nbsp;牌のインデクスの数&nbsp;(Aタイプの長さ、Bタイプの要素の最大値)&nbsp;M&nbsp;も任意としてください。<br/>・&nbsp;1種の牌の最大個数&nbsp;(Aタイプの要素の最大値、Bタイプの1種の要素の最大重複度)&nbsp;L&nbsp;も任意としてください。<br/>・&nbsp;一般の麻雀の場合は、m=3,&nbsp;n=4,&nbsp;h=2,&nbsp;M=9,&nbsp;L=4&nbsp;です。この条件に特化した高速化が可能なら行ってもかまいません。<br/><br/>擬似コードで、ごく短い例を示します。<br/>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>1
2
3
4
5
6
7
8</pre></td><td class="code"><div class="highlight"><pre>for 考えられる対子:
    対子を手牌から抜く
    for 考えられる刻子のパターン:
        刻子を手牌から抜く
        手牌が順子の和となっていれば、和了形として抜ける
        刻子を手牌へ戻す
    対子を手牌へ戻す
ここに到達していれば、和了形ではない
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8532/addtag/" class="addtag" id="addtag_8532">タグ</a>:
	
    
    <a href="/web/20091219030926/http://ja.doukaku.org/tag/%E6%93%AC%E4%BC%BC%E3%82%B3%E3%83%BC%E3%83%89/">擬似コード</a>
    
	&nbsp;

	
      [<a href="/web/20091219030926/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8532/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8532/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffaf6f;"
  >-5/9=-0.56</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8532"
  >-</span><span
  class="button yellow"
  id="rating_z_8532"
  >0</span><span 
  class="button green"
  id="rating_p_8532"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20091219030926/http://ja.doukaku.org/237/reply_to/8532/">
  返信
  </a>]
  </div>
</div>
</div>




  



<div class="indent">
<a href="/web/20091219030926/http://ja.doukaku.org/237/post_comment/">
投稿する
</a>
</div>


<h2>投稿されたコメント - フラット表示</h2>
<a href="/web/20091219030926/http://ja.doukaku.org/237/nested/">ネスト表示</a>
<a href="/web/20091219030926/http://ja.doukaku.org/237/">非表示</a> 


  
  <br/>

  
  




<div class="comment" id="comment8568">
  <p class="banner"><a href="/web/20091219030926/http://ja.doukaku.org/user/679/" target="_top">muscovyduck</a>

	
	&nbsp;
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8568/">#8568</a>(<script language="JavaScript">print_time(new Date("2009/02/28 22:39 GMT"));</script><noscript>2009/02/28 22:39 GMT</noscript>)
	
	
	
	[<a href="/web/20091219030926/http://ja.doukaku.org/lang/python/">
	  Python
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>書いていたら頭がこんがらがって来ました。実行結果は下記です:</p>
<pre class="literal-block">
[1, 1, 2, 3, 4, 5, 6, 6, 7, 7, 8, 9, 9, 9] True
[1, 2, 4, 4, 5, 6, 7, 8, 9, 7, 8, 9, 4, 4] False
[1, 1, 1, 3, 3, 3, 5, 5, 5, 7, 7, 7, 9, 9] True
[1, 1, 1, 3, 3, 3, 5, 5, 5, 7, 7, 7, 9, 7] False
[1, 1, 1, 3, 3, 3, 5, 5, 5, 7, 7, 7, 9, 8] True
</pre>
<p>参考: <a class="reference" href="/web/20091219030926/http://hp.vector.co.jp/authors/VA046927/mjscore/mjalgorism.html">麻雀 和了判定（役の判定） アルゴリズム</a></p>

	</div>
	
	<p class="link">
	  参考: <a href="/web/20091219030926/http://blog.gijutsuya.jp/harajune/2008/08/10/ruby-array%E3%81%A7%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95/">ruby Arrayで組み合わせを出力する方法 - 進・日進月歩</a>
	</p>  
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></td><td class="code"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>

<span class="k">def</span> <span class="nf">get_set_candidate</span><span class="p">(</span><span class="n">hand</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">hand</span> <span class="o">=</span> <span class="n">hand</span><span class="p">[:]</span>
  <span class="n">hand</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">hand</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">num</span><span class="p">:</span>
      <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">clear_set</span><span class="p">(</span><span class="n">hand</span><span class="p">,</span> <span class="n">clear_tile</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
  <span class="n">hand</span> <span class="o">=</span> <span class="n">hand</span><span class="p">[:]</span>
  <span class="n">hand</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">hand</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">clear_tile</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">hand</span>

<span class="k">def</span> <span class="nf">make_comb</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="p">[[]]</span>
  <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">clonecker</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">:</span> <span class="nb">map</span><span class="p">((</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">list1</span> <span class="o">+</span> <span class="n">i</span><span class="p">),</span> <span class="n">list2</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="n">clonecker</span><span class="p">([</span><span class="nb">list</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">make_comb</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span> <span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">all_comb</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="n">make_comb</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">check_sequence</span><span class="p">(</span><span class="n">hand</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">hand</span> <span class="o">=</span> <span class="n">hand</span><span class="p">[:]</span>
  <span class="n">hand</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">):</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">hand</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">hand</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">hand</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span>
  <span class="k">return</span> <span class="bp">True</span>

<span class="k">def</span> <span class="nf">check_winning</span><span class="p">(</span><span class="n">hand</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">get_set_candidate</span><span class="p">(</span><span class="n">hand</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="n">hand2</span> <span class="o">=</span> <span class="n">clear_set</span><span class="p">(</span><span class="n">hand</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">all_comb</span><span class="p">(</span><span class="n">get_set_candidate</span><span class="p">(</span><span class="n">hand2</span><span class="p">,</span> <span class="n">m</span><span class="p">)):</span>
      <span class="n">hand3</span> <span class="o">=</span> <span class="n">hand2</span><span class="p">[:]</span>
      <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">j</span><span class="p">:</span>
        <span class="n">hand3</span> <span class="o">=</span> <span class="n">clear_set</span><span class="p">(</span><span class="n">hand3</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">check_sequence</span><span class="p">(</span><span class="n">hand3</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span> <span class="k">return</span> <span class="bp">True</span>
  <span class="k">return</span> <span class="bp">False</span>

<span class="n">hand1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">hand2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">hand3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">hand4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">hand5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>

<span class="k">print</span> <span class="n">hand1</span><span class="p">,</span> <span class="n">check_winning</span><span class="p">(</span><span class="n">hand1</span><span class="p">)</span>
<span class="k">print</span> <span class="n">hand2</span><span class="p">,</span> <span class="n">check_winning</span><span class="p">(</span><span class="n">hand2</span><span class="p">)</span>
<span class="k">print</span> <span class="n">hand3</span><span class="p">,</span> <span class="n">check_winning</span><span class="p">(</span><span class="n">hand3</span><span class="p">)</span>
<span class="k">print</span> <span class="n">hand4</span><span class="p">,</span> <span class="n">check_winning</span><span class="p">(</span><span class="n">hand4</span><span class="p">)</span>
<span class="k">print</span> <span class="n">hand5</span><span class="p">,</span> <span class="n">check_winning</span><span class="p">(</span><span class="n">hand5</span><span class="p">)</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8568/addtag/" class="addtag" id="addtag_8568">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20091219030926/http://ja.doukaku.org/lang/python/">
		Python
      </a>]
	  
      [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8568/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8568/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8568"
  >-</span><span
  class="button yellow"
  id="rating_z_8568"
  >0</span><span 
  class="button green"
  id="rating_p_8568"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20091219030926/http://ja.doukaku.org/237/reply_to/8568/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment8569">
  <p class="banner"><a href="/web/20091219030926/http://ja.doukaku.org/user/88/" target="_top">sumim</a><a href="/web/20091219030926/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a><a href="/web/20091219030926/http://ja.doukaku.org/qa/#anomark" target="_top"><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/anomark.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8569/">#8569</a>(<script language="JavaScript">print_time(new Date("2009/03/01 00:18 GMT"));</script><noscript>2009/03/01 00:18 GMT</noscript>)
	
	
	
	[<a href="/web/20091219030926/http://ja.doukaku.org/lang/smalltalk/">
	  Smalltalk
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>Squeak Smalltalk で。</p>
<p>幅優先で探索して和了パターンが１つでも見つかれば true を返します。牌は１文字の種類とインデックス文字列の組み合わせで与えます。なお、インデックス文字列の文字数が最大値（M）の文字列の文字数に満たない場合、あらかじめ左側を「0」で埋めて文字数を合わせて与える必要があります。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></td><td class="code"><div class="highlight"><pre>| m n h M L 対子群 手牌 刻子群 同種牌群 和了パターン 残り 待ち行列 刻順子群 |
m := 3. n := 4. h := 2. M := 9. L := 4.
手牌 := #(a1 a1 a2 a3 a4 a5 a6 a6 a7 a7 a8 a9 a9 a9).

self assert: (手牌 allSatisfy: [:each | each size = (M printString size + 1)]).
self assert: 手牌 size = (m * n + h).
self assert: 手牌 asBag sortedCounts first key &lt;= L.
対子群 := (手牌 groupBy: [:each | each] having: [:group | group size &gt;=  h]) values 
    collect: [:group | (group first: h) asArray].
刻子群 := (手牌 groupBy: [:each | each] having: [:group | group size &gt;=  m]) values 
    collect: [:group | (group first: m) asArray].
同種牌群 := (手牌 groupBy: [:each | each first] having: [:group | group size &gt;= m]) values.
刻順子群 := OrderedCollection withAll: 刻子群.
同種牌群 do: [:group | 
    | 牌種 インデックス列 |
    牌種 := group anyOne first.
    インデックス列 := (group collect: [:each | each allButFirst asInteger]) asSet asSortedArray.
    ((1 to: M - m + 1) 
            collect: [:start | start to: start + m - 1] 
            thenSelect: [:range | インデックス列 includesAllOf: range]) 
        do: [:range | 
            刻順子群 add: (range collect: [:each | 
                ((each printPaddedWith: $0 to: M printString size) 
                    copyWithFirst: 牌種) asSymbol])]].
和了パターン := Set new.
対子群 do: [:対子 |
    残り := 手牌 asOrderedCollection.
    対子 do: [:各々 | 残り remove: 各々].
    待ち行列 := OrderedCollection with: {対子. 残り}.
    [待ち行列 notEmpty] whileTrue: [
        | 状態 |
        状態 := 待ち行列 removeFirst.
        状態 last ifEmpty: [和了パターン add: 状態 allButLast asBag] ifNotEmpty: [
            刻順子群 do: [:刻順子 |
                (刻順子 inject: 1 into: [:prev :牌 | 
                        (状態 last indexOf: 牌 startingAt: prev ifAbsent: [状態 last size + 1]) + 1]) 
                    &lt;= (状態 last size + 1) ifTrue: [
                        | 次 | 
                        次 := 状態 last copy.
                        刻順子 do: [:各々 | 次 remove: 各々].
                        待ち行列 add: (状態 allButLast, {刻順子 asArray. 次})]]]]].
和了パターン notEmpty

&quot;=&gt; true &quot;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8569/addtag/" class="addtag" id="addtag_8569">タグ</a>:
	
    
    <a href="/web/20091219030926/http://ja.doukaku.org/tag/Squeak_Smalltalk/">Squeak_Smalltalk</a>
    
	&nbsp;

	
      [<a href="/web/20091219030926/http://ja.doukaku.org/lang/smalltalk/">
		Smalltalk
      </a>]
	  
      [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8569/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8569/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8569"
  >-</span><span
  class="button yellow"
  id="rating_z_8569"
  >0</span><span 
  class="button green"
  id="rating_p_8569"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20091219030926/http://ja.doukaku.org/237/reply_to/8569/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment8575">
  <p class="banner"><a href="/web/20091219030926/http://ja.doukaku.org/user/760/" target="_top">turugina</a><a href="/web/20091219030926/http://ja.doukaku.org/qa/#medal" target="_top"><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/star_gold.png" border=0/></a>

	
	&nbsp;
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8575/">#8575</a>(<script language="JavaScript">print_time(new Date("2009/03/03 03:20 GMT"));</script><noscript>2009/03/03 03:20 GMT</noscript>)
	
	
	
	[<a href="/web/20091219030926/http://ja.doukaku.org/lang/xslt/">
	  XSLT
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>受け付けるフォーマットはBタイプです。
以下のようなxml文書を入力として与えると、hand要素に&quot;和了形&quot;属性(true/false)を追加して出力します。:</p>
<pre class="literal-block">
&lt;hands&gt;
  &lt;hand&gt;1,1,2,3,4,5,6,6,7,7,8,9,9,9&lt;/hand&gt;
  &lt;hand&gt;1,1,2,2,2,3,3,3,3,4,4,5,6,6&lt;/hand&gt;
  &lt;hand&gt;1,1,2,2,4,4,5,5,6,6,7,7,9,9&lt;/hand&gt;
  &lt;hand&gt;1,1,2,2,4,4,5,5,6,7,8,7,8,9&lt;/hand&gt;
&lt;/hands&gt;
</pre>
<p>後、お題にはなかったのですが、七対子にも対応してみました。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197</pre></td><td class="code"><div class="highlight"><pre>&lt;xsl:stylesheet version=&quot;2.0&quot;
  xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
  xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;
  xmlns:fn=&quot;http://www.w3.org/2005/xpath-functions&quot;
  xmlns:my=&quot;uri:ja.doukaku.org:my-functions&quot;
  exclude-result-prefixes=&quot;my&quot;
  &gt;

  &lt;xsl:output method=&quot;xml&quot; /&gt;

  &lt;xsl:variable name=&quot;debug&quot; as=&quot;xs:boolean&quot; select=&quot;false()&quot; /&gt;
  &lt;xsl:variable name=&quot;can七対子&quot; as=&quot;xs:boolean&quot; select=&quot;true()&quot; /&gt;

  &lt;xsl:variable name=&quot;m&quot; as=&quot;xs:integer&quot; select=&quot;3&quot; /&gt;
  &lt;xsl:variable name=&quot;n&quot; as=&quot;xs:integer&quot; select=&quot;4&quot; /&gt;
  &lt;xsl:variable name=&quot;h&quot; as=&quot;xs:integer&quot; select=&quot;2&quot; /&gt;
  &lt;xsl:variable name=&quot;M&quot; as=&quot;xs:integer&quot; select=&quot;9&quot; /&gt;
  &lt;xsl:variable name=&quot;L&quot; as=&quot;xs:integer&quot; select=&quot;4&quot; /&gt;

  &lt;xsl:template match=&quot;/hands&quot;&gt;
    &lt;hands&gt;
      &lt;xsl:apply-templates select=&quot;./hand&quot; /&gt;
    &lt;/hands&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match=&quot;hand&quot;&gt;
    &lt;xsl:variable name=&quot;pai&quot; as=&quot;xs:integer*&quot;&gt;
      &lt;xsl:variable name=&quot;pai-unordered&quot; as=&quot;xs:integer*&quot;&gt;
        &lt;xsl:for-each select=&quot;fn:tokenize(text(), &#39;,&#39;)&quot;&gt;
          &lt;xsl:sequence select=&quot;xs:integer(.)&quot; /&gt;
        &lt;/xsl:for-each&gt;
      &lt;/xsl:variable&gt;
      &lt;xsl:for-each select=&quot;$pai-unordered&quot;&gt;
        &lt;xsl:sort /&gt;
        &lt;xsl:sequence select=&quot;.&quot; /&gt;
      &lt;/xsl:for-each&gt;
    &lt;/xsl:variable&gt;
    &lt;xsl:if test=&quot;fn:max($pai) &amp;gt; $M&quot;&gt;
      &lt;xsl:message terminate=&quot;yes&quot;&gt;
        &lt;xsl:text&gt;invalid max value of pai. expected &lt;/xsl:text&gt;
        &lt;xsl:value-of select=&quot;$M&quot; /&gt;
        &lt;xsl:text&gt; but &lt;/xsl:text&gt;
        &lt;xsl:value-of select=&quot;fn:max($pai)&quot; /&gt;
      &lt;/xsl:message&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:for-each select=&quot;fn:distinct-values($pai)&quot;&gt;
      &lt;xsl:if test=&quot;fn:count(fn:index-of($pai, .)) &amp;gt; $L&quot;&gt;
        &lt;xsl:message terminate=&quot;yes&quot;&gt;
          &lt;xsl:text&gt;invalid count per a kind, expected &lt;/xsl:text&gt;
          &lt;xsl:value-of select=&quot;$L&quot; /&gt;
          &lt;xsl:text&gt; but &lt;/xsl:text&gt;
          &lt;xsl:value-of select=&quot;fn:count(fn:index-of($pai, .))&quot; /&gt;
          &lt;xsl:text&gt; for &lt;/xsl:text&gt;
          &lt;xsl:value-of select=&quot;.&quot; /&gt;
        &lt;/xsl:message&gt;
      &lt;/xsl:if&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:element name=&quot;hand&quot;&gt;
      &lt;xsl:attribute name=&quot;和了形&quot;&gt;
        &lt;xsl:value-of select=&quot;my:check-和了形($pai)&quot; /&gt;
      &lt;/xsl:attribute&gt;
      &lt;xsl:value-of select=&quot;text()&quot; /&gt;
    &lt;/xsl:element&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:function name=&quot;my:check-和了形&quot; as=&quot;xs:boolean&quot;&gt;
    &lt;xsl:param name=&quot;pai&quot; as=&quot;xs:integer*&quot; /&gt;

    &lt;xsl:variable name=&quot;result&quot; as=&quot;xs:boolean*&quot;&gt;
      &lt;xsl:sequence select=&quot;my:check-対子($pai,0)&quot; /&gt;
    &lt;/xsl:variable&gt;

    &lt;xsl:value-of select=&quot;fn:count($result)&amp;gt;0&quot; /&gt;
  &lt;/xsl:function&gt;

  &lt;xsl:function name=&quot;my:check-対子&quot; as=&quot;xs:boolean*&quot;&gt;
    &lt;xsl:param name=&quot;pai&quot; as=&quot;xs:integer*&quot; /&gt;
    &lt;xsl:param name=&quot;depth&quot; as=&quot;xs:integer&quot; /&gt;

    &lt;xsl:if test=&quot;$debug&quot;&gt;
      &lt;xsl:message&gt;
        &lt;xsl:text&gt;check1: &lt;/xsl:text&gt;
        &lt;xsl:value-of select=&quot;$pai&quot; /&gt;
      &lt;/xsl:message&gt;
    &lt;/xsl:if&gt;

    &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;fn:empty($pai)&quot;&gt;
        &lt;xsl:sequence select=&quot;true()&quot; /&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:if test=&quot;$depth=0 or $can七対子&quot;&gt;
          &lt;xsl:for-each select=&quot;1 to (fn:count($pai) - ($h - 1))&quot;&gt;
            &lt;xsl:variable name=&quot;i&quot; as=&quot;xs:integer&quot; select=&quot;.&quot; /&gt;
            &lt;xsl:if test=&quot;fn:count(fn:distinct-values(fn:subsequence($pai,$i, $h)))=1&quot;&gt;
              &lt;xsl:variable name=&quot;next-pai&quot; as=&quot;xs:integer*&quot;
                select=&quot;$pai[position() &amp;lt; $i or $i + ($h - 1) &amp;lt; position()]&quot; /&gt;
              &lt;xsl:sequence select=&quot;my:check-対子($next-pai, $depth+1)&quot; /&gt;
            &lt;/xsl:if&gt;
          &lt;/xsl:for-each&gt;
        &lt;/xsl:if&gt;
        &lt;xsl:if test=&quot;$depth=1&quot;&gt;
          &lt;xsl:sequence select=&quot;my:check-刻子($pai, $depth)&quot; /&gt;
        &lt;/xsl:if&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:function&gt;

  &lt;xsl:function name=&quot;my:check-刻子&quot; as=&quot;xs:boolean*&quot;&gt;
    &lt;xsl:param name=&quot;pai&quot; as=&quot;xs:integer*&quot; /&gt;
    &lt;xsl:param name=&quot;depth&quot; as=&quot;xs:integer&quot; /&gt;

    &lt;xsl:if test=&quot;$debug&quot;&gt;
      &lt;xsl:message&gt;
        &lt;xsl:text&gt;check2: &lt;/xsl:text&gt;
        &lt;xsl:value-of select=&quot;$pai&quot; /&gt;
      &lt;/xsl:message&gt;
    &lt;/xsl:if&gt;

    &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;fn:count($pai)=0&quot;&gt;
        &lt;xsl:if test=&quot;$depth - 1!=$n&quot;&gt;
          &lt;xsl:message terminate=&quot;yes&quot;&gt;
            &lt;xsl:text&gt; invalid count of 刻子/順子. expected &lt;/xsl:text&gt;
            &lt;xsl:value-of select=&quot;$n&quot; /&gt;
            &lt;xsl:text&gt; but &lt;/xsl:text&gt;
            &lt;xsl:value-of select=&quot;$depth - 1&quot; /&gt;
          &lt;/xsl:message&gt;
        &lt;/xsl:if&gt;
        &lt;xsl:sequence select=&quot;true()&quot; /&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:for-each select=&quot;1 to (fn:count($pai) - ($m - 1))&quot;&gt;
          &lt;xsl:variable name=&quot;i&quot; as=&quot;xs:integer&quot; select=&quot;.&quot; /&gt;
          &lt;xsl:if test=&quot;fn:count(fn:distinct-values(fn:subsequence($pai,$i, $m)))=1&quot;&gt;
            &lt;xsl:variable name=&quot;next-pai&quot; as=&quot;xs:integer*&quot;
              select=&quot;$pai[position() &amp;lt; $i or $i + ($m - 1) &amp;lt; position()]&quot; /&gt;
            &lt;xsl:sequence select=&quot;my:check-刻子($next-pai, $depth+1)&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/xsl:for-each&gt;
        &lt;xsl:sequence select=&quot;my:check-順子($pai, $depth)&quot; /&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:function&gt;

  &lt;xsl:function name=&quot;my:check-順子&quot; as=&quot;xs:boolean*&quot;&gt;
    &lt;xsl:param name=&quot;pai&quot; as=&quot;xs:integer*&quot; /&gt;
    &lt;xsl:param name=&quot;depth&quot; as=&quot;xs:integer&quot; /&gt;

    &lt;xsl:if test=&quot;$debug&quot;&gt;
      &lt;xsl:message&gt;
        &lt;xsl:text&gt;check3: &lt;/xsl:text&gt;
        &lt;xsl:value-of select=&quot;$pai&quot; /&gt;
      &lt;/xsl:message&gt;
    &lt;/xsl:if&gt;

    &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;fn:count($pai)=0&quot;&gt;
        &lt;xsl:if test=&quot;$depth - 1 != $n&quot;&gt;
          &lt;xsl:message terminate=&quot;yes&quot;&gt;
            &lt;xsl:text&gt; invalid count of 刻子/順子. expected &lt;/xsl:text&gt;
            &lt;xsl:value-of select=&quot;$n&quot; /&gt;
            &lt;xsl:text&gt; but &lt;/xsl:text&gt;
            &lt;xsl:value-of select=&quot;$depth - 1&quot; /&gt;
          &lt;/xsl:message&gt;
        &lt;/xsl:if&gt;
        &lt;xsl:sequence select=&quot;true()&quot; /&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:for-each select=&quot;1 to (fn:count($pai) - ($m - 1))&quot;&gt;
          &lt;xsl:variable name=&quot;i&quot; as=&quot;xs:integer&quot; select=&quot;.&quot; /&gt;
          &lt;xsl:variable name=&quot;indexes&quot; as=&quot;xs:integer*&quot;&gt;
            &lt;xsl:variable name=&quot;values&quot; as=&quot;xs:integer*&quot;&gt;
              &lt;xsl:sequence select=&quot;$pai[$i]&quot; /&gt;
              &lt;xsl:for-each select=&quot;1 to ($m - 1)&quot;&gt;
                &lt;xsl:sequence select=&quot;$pai[$i] + .&quot; /&gt;
              &lt;/xsl:for-each&gt;
            &lt;/xsl:variable&gt;
            &lt;xsl:for-each select=&quot;$values&quot;&gt;
              &lt;xsl:variable name=&quot;idx&quot; as=&quot;xs:integer*&quot;
                select=&quot;fn:index-of($pai, .)&quot; /&gt;
              &lt;xsl:if test=&quot;fn:exists($idx)&quot;&gt;
                &lt;xsl:sequence select=&quot;$idx[1]&quot; /&gt;
              &lt;/xsl:if&gt;
            &lt;/xsl:for-each&gt;
          &lt;/xsl:variable&gt;
          &lt;xsl:if test=&quot;fn:count($indexes)=$m&quot;&gt;
            &lt;xsl:variable name=&quot;next-pai&quot; as=&quot;xs:integer*&quot;
              select=&quot;$pai[fn:empty(fn:index-of($indexes, position()))]&quot; /&gt;
            &lt;xsl:sequence select=&quot;my:check-順子($next-pai, $depth+1)&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/xsl:for-each&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:function&gt;
&lt;/xsl:stylesheet&gt;
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8575/addtag/" class="addtag" id="addtag_8575">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20091219030926/http://ja.doukaku.org/lang/xslt/">
		XSLT
      </a>]
	  
      [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8575/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8575/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8575"
  >-</span><span
  class="button yellow"
  id="rating_z_8575"
  >0</span><span 
  class="button green"
  id="rating_p_8575"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20091219030926/http://ja.doukaku.org/237/reply_to/8575/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment8784">
  <p class="banner"><a href="/web/20091219030926/http://ja.doukaku.org/user/813/" target="_top">lunlumo</a>

	
	&nbsp;
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8784/">#8784</a>(<script language="JavaScript">print_time(new Date("2009/04/05 09:26 GMT"));</script><noscript>2009/04/05 09:26 GMT</noscript>)
	
	
	
	[<a href="/web/20091219030926/http://ja.doukaku.org/lang/ruby/">
	  Ruby
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <p>　Aタイプ向けに書いてみました。</p>

	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre></td><td class="code"><div class="highlight"><pre><span class="c1">#! /usr/bin/ruby -Ks</span>

<span class="k">class</span> <span class="nc">CheckFinished</span>
    <span class="no">PAIR</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="no">SET</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="no">ORDER</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">check_finished</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
        <span class="n">check_pair</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">check_pair</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
        <span class="n">pieces</span><span class="o">.</span><span class="n">each_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
            <span class="k">if</span> <span class="n">pieces</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&gt;=</span> <span class="no">PAIR</span>
                <span class="p">(</span><span class="n">s</span> <span class="o">=</span> <span class="n">pieces</span><span class="o">.</span><span class="n">clone</span><span class="p">)</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="no">PAIR</span>
                <span class="k">if</span> <span class="n">check_set</span><span class="p">((</span><span class="mi">0</span><span class="o">.</span><span class="n">.s</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">j</span><span class="o">|</span> <span class="n">s</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">&gt;=</span> <span class="no">SET</span> <span class="p">},</span> <span class="n">s</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kp">true</span>
                <span class="k">end</span>
            <span class="k">end</span>
        <span class="k">end</span>
        <span class="kp">false</span>
    <span class="k">end</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">check_set</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">pieces</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">indexes</span><span class="o">.</span><span class="n">empty?</span>
            <span class="n">check_order</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
        <span class="k">else</span>
            <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">clone</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span>
            <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.pieces</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">/</span> <span class="no">SET</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">w</span><span class="o">|</span>
                <span class="p">(</span><span class="n">s</span> <span class="o">=</span> <span class="n">pieces</span><span class="o">.</span><span class="n">clone</span><span class="p">)</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">-</span> <span class="no">SET</span> <span class="o">*</span> <span class="n">w</span>
                <span class="k">if</span> <span class="n">check_order</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">||</span> <span class="n">check_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kp">true</span>
                <span class="k">end</span>
            <span class="k">end</span>
            <span class="kp">false</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">check_order</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pieces</span><span class="o">.</span><span class="n">reject</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="nb">p</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">}</span><span class="o">.</span><span class="n">empty?</span>
            <span class="kp">true</span>
        <span class="k">else</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.pieces</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="no">ORDER</span><span class="p">)</span><span class="o">.</span><span class="n">find</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">pieces</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">}</span>
            <span class="k">unless</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">.c</span> <span class="o">+</span> <span class="no">ORDER</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">j</span><span class="o">|</span> <span class="n">pieces</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">}</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="no">ORDER</span>
                <span class="kp">false</span>
            <span class="k">else</span>
                <span class="n">check_order</span><span class="p">(</span><span class="n">pieces</span><span class="o">.</span><span class="n">clone</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="no">ORDER</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">j</span><span class="o">|</span> <span class="n">pieces</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">})</span>
            <span class="k">end</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="nb">private_class_method</span> <span class="ss">:check_pair</span><span class="p">,</span> <span class="ss">:check_set</span><span class="p">,</span> <span class="ss">:check_order</span>
<span class="k">end</span>

<span class="n">pieces</span> <span class="o">=</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span>
<span class="nb">puts</span> <span class="s2">&quot;[</span><span class="si">#{</span><span class="n">pieces</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">] =&gt; &quot;</span> <span class="o">+</span> <span class="no">CheckFinished</span><span class="o">.</span><span class="n">check_finished</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/8784/addtag/" class="addtag" id="addtag_8784">タグ</a>:
	
	タグなし
	&nbsp;

	
      [<a href="/web/20091219030926/http://ja.doukaku.org/lang/ruby/">
		Ruby
      </a>]
	  
      [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8784/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20091219030926/http://ja.doukaku.org/comment/8784/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_8784"
  >-</span><span
  class="button yellow"
  id="rating_z_8784"
  >0</span><span 
  class="button green"
  id="rating_p_8784"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20091219030926/http://ja.doukaku.org/237/reply_to/8784/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>

  
  




<div class="comment" id="comment9627">
  <p class="banner"><a href="/web/20091219030926/http://ja.doukaku.org/user/1107/" target="_top">T_GYOUTEN</a>

	
	&nbsp;
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/9627/">#9627</a>(<script language="JavaScript">print_time(new Date("2009/10/11 05:51 GMT"));</script><noscript>2009/10/11 05:51 GMT</noscript>)
	
	
	
	[<a href="/web/20091219030926/http://ja.doukaku.org/lang/other/">
	  Other
	</a>]
	
	
	
	&nbsp;

<span class="rating">評価<span style="background-color: #ffffff;">0/0=0.00</span></span>
  </p>
  <div class="comment_content">
	<div class="comment_body">
	  <div class="section">
<p>フォーマットＡで、m,hも指定可能にしてみました。使用言語はF#です。</p>
<p>m=3でh=2の場合</p>
<p>&gt; isFinished 3 2 [|2;1;1;1;1;2;2;1;3|];;</p>
<p>val it : bool = true</p>
</div>
	</div>
	
	
	
    <div class="compact">
      <table><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></td><td class="code"><div class="highlight"><pre>let isMoreEqM m  (arr : int []) (index : int) =
    arr.[index] &gt;= m

//配列arrにおいてindexから始まる連続したm個の要素が全部１以上か
let isConsecMoreEq1 m  (arr : int []) (index : int) =
    let mutable res = true
    for i in 0 .. (m - 1) do
        if arr.[index + i] = 0 then
            res &lt;- false
    res

//後ろにk個の0を付け加えた配列を返す
let addEle k (arr : int []) =
    let t = Array.zeroCreate (arr.Length + k)
    for i in 0 .. (arr.Length - 1) do
        t.[i] &lt;- arr.[i]
    t

let isFinished mIn hIn (arrIn : int []) =
    let targetArr = addEle (mIn - 1) arrIn
    let isRemoveAll m (arr : int []) =
        let searchIndexEnd = arr.Length - m
        let result = ref false
        let rec reMoveM (arr : int []) index =
            if index = searchIndexEnd + 1 then
                    result := true
            elif arr.[index] = 0 then
                    reMoveM arr (index + 1) 
            elif  (isMoreEqM m arr index = true) &amp;&amp; (isConsecMoreEq1 m arr index = true) then
                    reMoveKousi m arr index
                    reMoveJyunsi m arr index  
            elif  isMoreEqM m arr index = true then
                    reMoveKousi m arr index
            elif  isConsecMoreEq1 m arr index = true then
                    reMoveJyunsi m arr index
            else
                    ()     
        and reMoveKousi mA (arrA :int []) indexA =
             arrA.[indexA] &lt;- arrA.[indexA] - mA; 
             reMoveM arrA indexA 
             arrA.[indexA] &lt;- arrA.[indexA] + mA; 
        
        and reMoveJyunsi mB (arrB :int []) index =
             for i in 0 .. (mB-1) do
                 arrB.[index+i] &lt;- arrB.[index+i] - 1
             reMoveM arrB index 
             for i in 0 .. (mB-1) do
                 arrB.[index+i] &lt;- arrB.[index+i] + 1
  
        reMoveM arr 0
        !result                  
   
    let rec reMoveH m h (arr : int []) index =
        let searchIndexEnd = arr.Length - m
        if index = searchIndexEnd + 1 then
            false
        else
            if arr.[index] &gt;= h then
                arr.[index] &lt;- arr.[index] - h
                if isRemoveAll m arr = true then
                    true
                else
                    arr.[index] &lt;- arr.[index] + h
                    reMoveH m h arr (index + 1)
            else
              reMoveH m h arr (index + 1)  
    
    reMoveH mIn hIn targetArr 0
</pre></div>
</td></tr></table>
    </div>
	

  
  <div align = "right" class="banner">
	
	<a href="/web/20091219030926/http://ja.doukaku.org/comment/9627/addtag/" class="addtag" id="addtag_9627">タグ</a>:
	
    
    <a href="/web/20091219030926/http://ja.doukaku.org/tag/F%23/">F#</a>
    
	&nbsp;

	
      [<a href="/web/20091219030926/http://ja.doukaku.org/lang/other/">
		Other
      </a>]
	  
      [<a href="/web/20091219030926/http://ja.doukaku.org/comment/9627/download/">
		ダウンロード
      </a>]
	  [<a href="/web/20091219030926/http://ja.doukaku.org/comment/9627/download_html/">
		HTML
      </a>]<p>
	

  
  <span class="rating">
  評価<span style="background-color: #ffffff;"
  >0/0=0.00</span
  ><span class="buttons"><span 
  class="button red"
  id="rating_n_9627"
  >-</span><span
  class="button yellow"
  id="rating_z_9627"
  >0</span><span 
  class="button green"
  id="rating_p_9627"
  >+</span></span></span>
  

<p>

  

  

  [<a href="/web/20091219030926/http://ja.doukaku.org/237/reply_to/9627/">
  返信
  </a>]
  </div>
</div>
</div>

  
  <br/>







</div>

<div id="side_menu" class="compact">

<iframe src="/web/20091219030926if_/http://ja.doukaku.org/login_info/" frameborder=0 width=100% id="login_info">
iframe required
</iframe>

<h4 class="semi_compact">一覧</h4>

<ul>
<!--<li><a href="/web/20091219030926/http://ja.doukaku.org/user/">ユーザ</a>-->
<li><a href="/web/20091219030926/http://ja.doukaku.org/lang/">言語</a>
<li><a href="/web/20091219030926/http://ja.doukaku.org/challenge/">お題</a>
<li><a href="/web/20091219030926/http://ja.doukaku.org/topic/">トピック</a>
<li><a href="/web/20091219030926/http://ja.doukaku.org/comment/">投稿</a>
<li><a href="/web/20091219030926/http://ja.doukaku.org/good_comments/">評価の高い投稿</a>
<li><a href="/web/20091219030926/http://ja.doukaku.org/tag/">タグ</a>
</ul>

<h4 class="compact">フィード</h4>
<ul>
<li><a href="/web/20091219030926/http://ja.doukaku.org/feeds/challenges/">最新のお題</a><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20091219030926/http://ja.doukaku.org/feeds/topics/">最新のトピック</a><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/feed_icon.png">
<li><a href="/web/20091219030926/http://ja.doukaku.org/feeds/comments/">新着投稿</a><img src="/web/20091219030926im_/http://ja.doukaku.org/static/image/feed_icon.png">
</ul>







<h4 class="compact">その他</h4>
<ul>
<li><a href="/web/20091219030926/http://ja.doukaku.org/qa/">Q&A</a>
<li><a href="/web/20091219030926/http://ja.doukaku.org/feedback/">フィードバック</a>
<!--<li><a href="/web/20091219030926/http://ja.doukaku.org/terms">用語集</a>-->
</ul>


<h4 class="compact">リンク</h4>
<ul>
<li><a href="/web/20091219030926/http://www.lingr.com/room/doukaku_ja">チャットルーム(Lingr)</a>
<li><a href="/web/20091219030926/http://labs.cybozu.co.jp/">サイボウズ・ラボ</a>
<li><a href="/web/20091219030926/http://www.djangoproject.com/">Django</a>
</ul>

<h4 id="pathtraq" class="compact"><a href="/web/20091219030926/http://pathtraq.com/analytics?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&m=popular">Pathtraq</a></h4>
<div class="indent">
<span id="pathtraq_sentinel">loading...</span>
</div>


</div>
</div>


<div id="page_foot" class="bordered">

<a rel="license" href="/web/20091219030926/http://creativecommons.org/licenses/by/2.1/jp/">
<img alt="Creative Commons License" style="border-width:0" src="/web/20091219030926im_/http://i.creativecommons.org/l/by/2.1/jp/88x31.png" /></a>
このサイトの内容は、
<a rel="license" href="/web/20091219030926/http://creativecommons.org/licenses/by/2.1/jp/">クリエイティブ・コモンズ・ライセンス</a>の下でライセンスされています。
<a href="/web/20091219030926/http://ja.doukaku.org/qa/#licence">[詳細]</a>

</div>

</body>




<script type="text/javascript">
$(document).ready(function(){$("#doukaku_org").after("<script src='/web/20091219030926/http://api.pathtraq.com/pages?url=http%3A%2F%2Fja.doukaku.org%2Fcomment%2F*%2F%20desc%3A%E3%81%A9%E3%81%86%E6%9B%B8%E3%81%8Forg&api=json&callback=addPathtraq'><" + "/script>")});
</script>

<script src="/web/20091219030926js_/http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2136157-1";
urchinTracker();
</script>




</html>





<!--
     FILE ARCHIVED ON 3:09:26 Dec 19, 2009 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:48:10 Nov 16, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
